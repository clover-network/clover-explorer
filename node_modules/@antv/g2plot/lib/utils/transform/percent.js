"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.percent = void 0;
var tslib_1 = require("tslib");
var util_1 = require("@antv/util");
function sumBy(data, func) {
    return util_1.reduce(data, function (r, d) {
        return (r += func(d));
    }, 0);
}
/**
 * 对数据进行百分比化
 * @param data
 * @param measure
 * @param groupField
 * @param as
 */
function percent(data, measure, groupField, as) {
    // 1. 首先根据 dimension 分组
    var groupedData = util_1.groupBy(data, groupField);
    var result = [];
    util_1.each(groupedData, function (v) {
        var total = sumBy(v, function (o) { return o[measure]; });
        var percentage = util_1.map(v, function (o) {
            var _a;
            return (tslib_1.__assign(tslib_1.__assign({}, o), (_a = {}, _a[as] = o[measure] / total, _a)));
        });
        result.push.apply(result, percentage);
    });
    return result;
}
exports.percent = percent;
//# sourceMappingURL=percent.js.map