{"ast":null,"code":"import { createElement } from './core';\nimport * as util from '../core/util';\nimport Path from '../graphic/Path';\nimport ZRImage from '../graphic/Image';\nimport TSpan from '../graphic/TSpan';\nimport arrayDiff from '../core/arrayDiff';\nimport GradientManager from './helper/GradientManager';\nimport PatternManager from './helper/PatternManager';\nimport ClippathManager, { hasClipPath } from './helper/ClippathManager';\nimport ShadowManager from './helper/ShadowManager';\nimport { path as svgPath, image as svgImage, text as svgText } from './graphic';\n\nfunction parseInt10(val) {\n  return parseInt(val, 10);\n}\n\nfunction getSvgProxy(el) {\n  if (el instanceof Path) {\n    return svgPath;\n  } else if (el instanceof ZRImage) {\n    return svgImage;\n  } else if (el instanceof TSpan) {\n    return svgText;\n  } else {\n    return svgPath;\n  }\n}\n\nfunction checkParentAvailable(parent, child) {\n  return child && parent && child.parentNode !== parent;\n}\n\nfunction insertAfter(parent, child, prevSibling) {\n  if (checkParentAvailable(parent, child) && prevSibling) {\n    var nextSibling = prevSibling.nextSibling;\n    nextSibling ? parent.insertBefore(child, nextSibling) : parent.appendChild(child);\n  }\n}\n\nfunction prepend(parent, child) {\n  if (checkParentAvailable(parent, child)) {\n    var firstChild = parent.firstChild;\n    firstChild ? parent.insertBefore(child, firstChild) : parent.appendChild(child);\n  }\n}\n\nfunction remove(parent, child) {\n  if (child && parent && child.parentNode === parent) {\n    parent.removeChild(child);\n  }\n}\n\nfunction removeFromMyParent(child) {\n  if (child && child.parentNode) {\n    child.parentNode.removeChild(child);\n  }\n}\n\nfunction getSvgElement(displayable) {\n  return displayable.__svgEl;\n}\n\nvar SVGPainter = function () {\n  function SVGPainter(root, storage, opts, zrId) {\n    this.type = 'svg';\n    this.refreshHover = createMethodNotSupport('refreshHover');\n    this.pathToImage = createMethodNotSupport('pathToImage');\n    this.configLayer = createMethodNotSupport('configLayer');\n    this.root = root;\n    this.storage = storage;\n    this._opts = opts = util.extend({}, opts || {});\n    var svgDom = createElement('svg');\n    svgDom.setAttribute('xmlns', 'http://www.w3.org/2000/svg');\n    svgDom.setAttribute('version', '1.1');\n    svgDom.setAttribute('baseProfile', 'full');\n    svgDom.style.cssText = 'user-select:none;position:absolute;left:0;top:0;';\n    var bgRoot = createElement('g');\n    svgDom.appendChild(bgRoot);\n    var svgRoot = createElement('g');\n    svgDom.appendChild(svgRoot);\n    this._gradientManager = new GradientManager(zrId, svgRoot);\n    this._patternManager = new PatternManager(zrId, svgRoot);\n    this._clipPathManager = new ClippathManager(zrId, svgRoot);\n    this._shadowManager = new ShadowManager(zrId, svgRoot);\n    var viewport = document.createElement('div');\n    viewport.style.cssText = 'overflow:hidden;position:relative';\n    this._svgDom = svgDom;\n    this._svgRoot = svgRoot;\n    this._backgroundRoot = bgRoot;\n    this._viewport = viewport;\n    root.appendChild(viewport);\n    viewport.appendChild(svgDom);\n    this.resize(opts.width, opts.height);\n    this._visibleList = [];\n  }\n\n  SVGPainter.prototype.getType = function () {\n    return 'svg';\n  };\n\n  SVGPainter.prototype.getViewportRoot = function () {\n    return this._viewport;\n  };\n\n  SVGPainter.prototype.getSvgDom = function () {\n    return this._svgDom;\n  };\n\n  SVGPainter.prototype.getSvgRoot = function () {\n    return this._svgRoot;\n  };\n\n  SVGPainter.prototype.getViewportRootOffset = function () {\n    var viewportRoot = this.getViewportRoot();\n\n    if (viewportRoot) {\n      return {\n        offsetLeft: viewportRoot.offsetLeft || 0,\n        offsetTop: viewportRoot.offsetTop || 0\n      };\n    }\n  };\n\n  SVGPainter.prototype.refresh = function () {\n    var list = this.storage.getDisplayList(true);\n\n    this._paintList(list);\n  };\n\n  SVGPainter.prototype.setBackgroundColor = function (backgroundColor) {\n    if (this._backgroundRoot && this._backgroundNode) {\n      this._backgroundRoot.removeChild(this._backgroundNode);\n    }\n\n    var bgNode = createElement('rect');\n    bgNode.setAttribute('width', this.getWidth());\n    bgNode.setAttribute('height', this.getHeight());\n    bgNode.setAttribute('x', 0);\n    bgNode.setAttribute('y', 0);\n    bgNode.setAttribute('id', 0);\n    bgNode.style.fill = backgroundColor;\n\n    this._backgroundRoot.appendChild(bgNode);\n\n    this._backgroundNode = bgNode;\n  };\n\n  SVGPainter.prototype.createSVGElement = function (tag) {\n    return createElement(tag);\n  };\n\n  SVGPainter.prototype.paintOne = function (el) {\n    var svgProxy = getSvgProxy(el);\n    svgProxy && svgProxy.brush(el);\n    return getSvgElement(el);\n  };\n\n  SVGPainter.prototype._paintList = function (list) {\n    var gradientManager = this._gradientManager;\n    var patternManager = this._patternManager;\n    var clipPathManager = this._clipPathManager;\n    var shadowManager = this._shadowManager;\n    gradientManager.markAllUnused();\n    patternManager.markAllUnused();\n    clipPathManager.markAllUnused();\n    shadowManager.markAllUnused();\n    var svgRoot = this._svgRoot;\n    var visibleList = this._visibleList;\n    var listLen = list.length;\n    var newVisibleList = [];\n\n    for (var i = 0; i < listLen; i++) {\n      var displayable = list[i];\n      var svgProxy = getSvgProxy(displayable);\n      var svgElement = getSvgElement(displayable);\n\n      if (!displayable.invisible) {\n        if (displayable.__dirty || !svgElement) {\n          svgProxy && svgProxy.brush(displayable);\n          svgElement = getSvgElement(displayable);\n\n          if (svgElement && displayable.style) {\n            gradientManager.update(displayable.style.fill);\n            gradientManager.update(displayable.style.stroke);\n            patternManager.update(displayable.style.fill);\n            patternManager.update(displayable.style.stroke);\n            shadowManager.update(svgElement, displayable);\n          }\n\n          displayable.__dirty = 0;\n        }\n\n        if (svgElement) {\n          newVisibleList.push(displayable);\n        }\n      }\n    }\n\n    var diff = arrayDiff(visibleList, newVisibleList);\n    var prevSvgElement;\n    var topPrevSvgElement;\n\n    for (var i = 0; i < diff.length; i++) {\n      var item = diff[i];\n\n      if (item.removed) {\n        for (var k = 0; k < item.count; k++) {\n          var displayable = visibleList[item.indices[k]];\n          var svgElement = getSvgElement(displayable);\n          hasClipPath(displayable) ? removeFromMyParent(svgElement) : remove(svgRoot, svgElement);\n        }\n      }\n    }\n\n    var prevDisplayable;\n    var currentClipGroup;\n\n    for (var i = 0; i < diff.length; i++) {\n      var item = diff[i];\n      var isAdd = item.added;\n\n      if (item.removed) {\n        continue;\n      }\n\n      for (var k = 0; k < item.count; k++) {\n        var displayable = newVisibleList[item.indices[k]];\n        var clipGroup = clipPathManager.update(displayable, prevDisplayable);\n\n        if (clipGroup !== currentClipGroup) {\n          prevSvgElement = topPrevSvgElement;\n\n          if (clipGroup) {\n            prevSvgElement ? insertAfter(svgRoot, clipGroup, prevSvgElement) : prepend(svgRoot, clipGroup);\n            topPrevSvgElement = clipGroup;\n            prevSvgElement = null;\n          }\n\n          currentClipGroup = clipGroup;\n        }\n\n        var svgElement = getSvgElement(displayable);\n        prevSvgElement ? insertAfter(currentClipGroup || svgRoot, svgElement, prevSvgElement) : prepend(currentClipGroup || svgRoot, svgElement);\n        prevSvgElement = svgElement || prevSvgElement;\n\n        if (!currentClipGroup) {\n          topPrevSvgElement = prevSvgElement;\n        }\n\n        gradientManager.markUsed(displayable);\n        gradientManager.addWithoutUpdate(svgElement, displayable);\n        patternManager.markUsed(displayable);\n        patternManager.addWithoutUpdate(svgElement, displayable);\n        clipPathManager.markUsed(displayable);\n        prevDisplayable = displayable;\n      }\n    }\n\n    gradientManager.removeUnused();\n    patternManager.removeUnused();\n    clipPathManager.removeUnused();\n    shadowManager.removeUnused();\n    this._visibleList = newVisibleList;\n  };\n\n  SVGPainter.prototype._getDefs = function (isForceCreating) {\n    var svgRoot = this._svgDom;\n    var defs = svgRoot.getElementsByTagName('defs');\n\n    if (defs.length === 0) {\n      if (isForceCreating) {\n        var defs_1 = svgRoot.insertBefore(createElement('defs'), svgRoot.firstChild);\n\n        if (!defs_1.contains) {\n          defs_1.contains = function (el) {\n            var children = defs_1.children;\n\n            if (!children) {\n              return false;\n            }\n\n            for (var i = children.length - 1; i >= 0; --i) {\n              if (children[i] === el) {\n                return true;\n              }\n            }\n\n            return false;\n          };\n        }\n\n        return defs_1;\n      } else {\n        return null;\n      }\n    } else {\n      return defs[0];\n    }\n  };\n\n  SVGPainter.prototype.resize = function (width, height) {\n    var viewport = this._viewport;\n    viewport.style.display = 'none';\n    var opts = this._opts;\n    width != null && (opts.width = width);\n    height != null && (opts.height = height);\n    width = this._getSize(0);\n    height = this._getSize(1);\n    viewport.style.display = '';\n\n    if (this._width !== width || this._height !== height) {\n      this._width = width;\n      this._height = height;\n      var viewportStyle = viewport.style;\n      viewportStyle.width = width + 'px';\n      viewportStyle.height = height + 'px';\n      var svgRoot = this._svgDom;\n      svgRoot.setAttribute('width', width + '');\n      svgRoot.setAttribute('height', height + '');\n    }\n\n    if (this._backgroundNode) {\n      this._backgroundNode.setAttribute('width', width);\n\n      this._backgroundNode.setAttribute('height', height);\n    }\n  };\n\n  SVGPainter.prototype.getWidth = function () {\n    return this._width;\n  };\n\n  SVGPainter.prototype.getHeight = function () {\n    return this._height;\n  };\n\n  SVGPainter.prototype._getSize = function (whIdx) {\n    var opts = this._opts;\n    var wh = ['width', 'height'][whIdx];\n    var cwh = ['clientWidth', 'clientHeight'][whIdx];\n    var plt = ['paddingLeft', 'paddingTop'][whIdx];\n    var prb = ['paddingRight', 'paddingBottom'][whIdx];\n\n    if (opts[wh] != null && opts[wh] !== 'auto') {\n      return parseFloat(opts[wh]);\n    }\n\n    var root = this.root;\n    var stl = document.defaultView.getComputedStyle(root);\n    return (root[cwh] || parseInt10(stl[wh]) || parseInt10(root.style[wh])) - (parseInt10(stl[plt]) || 0) - (parseInt10(stl[prb]) || 0) | 0;\n  };\n\n  SVGPainter.prototype.dispose = function () {\n    this.root.innerHTML = '';\n    this._svgRoot = this._backgroundRoot = this._svgDom = this._backgroundNode = this._viewport = this.storage = null;\n  };\n\n  SVGPainter.prototype.clear = function () {\n    var viewportNode = this._viewport;\n\n    if (viewportNode && viewportNode.parentNode) {\n      viewportNode.parentNode.removeChild(viewportNode);\n    }\n  };\n\n  SVGPainter.prototype.toDataURL = function () {\n    this.refresh();\n    var html = encodeURIComponent(this._svgDom.outerHTML.replace(/></g, '>\\n\\r<'));\n    return 'data:image/svg+xml;charset=UTF-8,' + html;\n  };\n\n  return SVGPainter;\n}();\n\nfunction createMethodNotSupport(method) {\n  return function () {\n    util.logError('In SVG mode painter not support method \"' + method + '\"');\n  };\n}\n\nexport default SVGPainter;","map":{"version":3,"sources":["/Users/wanglijie/wanglijie/clover-defi-wallet/node_modules/zrender/esm/svg/Painter.js"],"names":["createElement","util","Path","ZRImage","TSpan","arrayDiff","GradientManager","PatternManager","ClippathManager","hasClipPath","ShadowManager","path","svgPath","image","svgImage","text","svgText","parseInt10","val","parseInt","getSvgProxy","el","checkParentAvailable","parent","child","parentNode","insertAfter","prevSibling","nextSibling","insertBefore","appendChild","prepend","firstChild","remove","removeChild","removeFromMyParent","getSvgElement","displayable","__svgEl","SVGPainter","root","storage","opts","zrId","type","refreshHover","createMethodNotSupport","pathToImage","configLayer","_opts","extend","svgDom","setAttribute","style","cssText","bgRoot","svgRoot","_gradientManager","_patternManager","_clipPathManager","_shadowManager","viewport","document","_svgDom","_svgRoot","_backgroundRoot","_viewport","resize","width","height","_visibleList","prototype","getType","getViewportRoot","getSvgDom","getSvgRoot","getViewportRootOffset","viewportRoot","offsetLeft","offsetTop","refresh","list","getDisplayList","_paintList","setBackgroundColor","backgroundColor","_backgroundNode","bgNode","getWidth","getHeight","fill","createSVGElement","tag","paintOne","svgProxy","brush","gradientManager","patternManager","clipPathManager","shadowManager","markAllUnused","visibleList","listLen","length","newVisibleList","i","svgElement","invisible","__dirty","update","stroke","push","diff","prevSvgElement","topPrevSvgElement","item","removed","k","count","indices","prevDisplayable","currentClipGroup","isAdd","added","clipGroup","markUsed","addWithoutUpdate","removeUnused","_getDefs","isForceCreating","defs","getElementsByTagName","defs_1","contains","children","display","_getSize","_width","_height","viewportStyle","whIdx","wh","cwh","plt","prb","parseFloat","stl","defaultView","getComputedStyle","dispose","innerHTML","clear","viewportNode","toDataURL","html","encodeURIComponent","outerHTML","replace","method","logError"],"mappings":"AAAA,SAASA,aAAT,QAA8B,QAA9B;AACA,OAAO,KAAKC,IAAZ,MAAsB,cAAtB;AACA,OAAOC,IAAP,MAAiB,iBAAjB;AACA,OAAOC,OAAP,MAAoB,kBAApB;AACA,OAAOC,KAAP,MAAkB,kBAAlB;AACA,OAAOC,SAAP,MAAsB,mBAAtB;AACA,OAAOC,eAAP,MAA4B,0BAA5B;AACA,OAAOC,cAAP,MAA2B,yBAA3B;AACA,OAAOC,eAAP,IAA0BC,WAA1B,QAA6C,0BAA7C;AACA,OAAOC,aAAP,MAA0B,wBAA1B;AACA,SAASC,IAAI,IAAIC,OAAjB,EAA0BC,KAAK,IAAIC,QAAnC,EAA6CC,IAAI,IAAIC,OAArD,QAAoE,WAApE;;AACA,SAASC,UAAT,CAAoBC,GAApB,EAAyB;AACrB,SAAOC,QAAQ,CAACD,GAAD,EAAM,EAAN,CAAf;AACH;;AACD,SAASE,WAAT,CAAqBC,EAArB,EAAyB;AACrB,MAAIA,EAAE,YAAYnB,IAAlB,EAAwB;AACpB,WAAOU,OAAP;AACH,GAFD,MAGK,IAAIS,EAAE,YAAYlB,OAAlB,EAA2B;AAC5B,WAAOW,QAAP;AACH,GAFI,MAGA,IAAIO,EAAE,YAAYjB,KAAlB,EAAyB;AAC1B,WAAOY,OAAP;AACH,GAFI,MAGA;AACD,WAAOJ,OAAP;AACH;AACJ;;AACD,SAASU,oBAAT,CAA8BC,MAA9B,EAAsCC,KAAtC,EAA6C;AACzC,SAAOA,KAAK,IAAID,MAAT,IAAmBC,KAAK,CAACC,UAAN,KAAqBF,MAA/C;AACH;;AACD,SAASG,WAAT,CAAqBH,MAArB,EAA6BC,KAA7B,EAAoCG,WAApC,EAAiD;AAC7C,MAAIL,oBAAoB,CAACC,MAAD,EAASC,KAAT,CAApB,IAAuCG,WAA3C,EAAwD;AACpD,QAAIC,WAAW,GAAGD,WAAW,CAACC,WAA9B;AACAA,IAAAA,WAAW,GAAGL,MAAM,CAACM,YAAP,CAAoBL,KAApB,EAA2BI,WAA3B,CAAH,GACLL,MAAM,CAACO,WAAP,CAAmBN,KAAnB,CADN;AAEH;AACJ;;AACD,SAASO,OAAT,CAAiBR,MAAjB,EAAyBC,KAAzB,EAAgC;AAC5B,MAAIF,oBAAoB,CAACC,MAAD,EAASC,KAAT,CAAxB,EAAyC;AACrC,QAAIQ,UAAU,GAAGT,MAAM,CAACS,UAAxB;AACAA,IAAAA,UAAU,GAAGT,MAAM,CAACM,YAAP,CAAoBL,KAApB,EAA2BQ,UAA3B,CAAH,GACJT,MAAM,CAACO,WAAP,CAAmBN,KAAnB,CADN;AAEH;AACJ;;AACD,SAASS,MAAT,CAAgBV,MAAhB,EAAwBC,KAAxB,EAA+B;AAC3B,MAAIA,KAAK,IAAID,MAAT,IAAmBC,KAAK,CAACC,UAAN,KAAqBF,MAA5C,EAAoD;AAChDA,IAAAA,MAAM,CAACW,WAAP,CAAmBV,KAAnB;AACH;AACJ;;AACD,SAASW,kBAAT,CAA4BX,KAA5B,EAAmC;AAC/B,MAAIA,KAAK,IAAIA,KAAK,CAACC,UAAnB,EAA+B;AAC3BD,IAAAA,KAAK,CAACC,UAAN,CAAiBS,WAAjB,CAA6BV,KAA7B;AACH;AACJ;;AACD,SAASY,aAAT,CAAuBC,WAAvB,EAAoC;AAChC,SAAOA,WAAW,CAACC,OAAnB;AACH;;AACD,IAAIC,UAAU,GAAI,YAAY;AAC1B,WAASA,UAAT,CAAoBC,IAApB,EAA0BC,OAA1B,EAAmCC,IAAnC,EAAyCC,IAAzC,EAA+C;AAC3C,SAAKC,IAAL,GAAY,KAAZ;AACA,SAAKC,YAAL,GAAoBC,sBAAsB,CAAC,cAAD,CAA1C;AACA,SAAKC,WAAL,GAAmBD,sBAAsB,CAAC,aAAD,CAAzC;AACA,SAAKE,WAAL,GAAmBF,sBAAsB,CAAC,aAAD,CAAzC;AACA,SAAKN,IAAL,GAAYA,IAAZ;AACA,SAAKC,OAAL,GAAeA,OAAf;AACA,SAAKQ,KAAL,GAAaP,IAAI,GAAGzC,IAAI,CAACiD,MAAL,CAAY,EAAZ,EAAgBR,IAAI,IAAI,EAAxB,CAApB;AACA,QAAIS,MAAM,GAAGnD,aAAa,CAAC,KAAD,CAA1B;AACAmD,IAAAA,MAAM,CAACC,YAAP,CAAoB,OAApB,EAA6B,4BAA7B;AACAD,IAAAA,MAAM,CAACC,YAAP,CAAoB,SAApB,EAA+B,KAA/B;AACAD,IAAAA,MAAM,CAACC,YAAP,CAAoB,aAApB,EAAmC,MAAnC;AACAD,IAAAA,MAAM,CAACE,KAAP,CAAaC,OAAb,GAAuB,kDAAvB;AACA,QAAIC,MAAM,GAAGvD,aAAa,CAAC,GAAD,CAA1B;AACAmD,IAAAA,MAAM,CAACrB,WAAP,CAAmByB,MAAnB;AACA,QAAIC,OAAO,GAAGxD,aAAa,CAAC,GAAD,CAA3B;AACAmD,IAAAA,MAAM,CAACrB,WAAP,CAAmB0B,OAAnB;AACA,SAAKC,gBAAL,GAAwB,IAAInD,eAAJ,CAAoBqC,IAApB,EAA0Ba,OAA1B,CAAxB;AACA,SAAKE,eAAL,GAAuB,IAAInD,cAAJ,CAAmBoC,IAAnB,EAAyBa,OAAzB,CAAvB;AACA,SAAKG,gBAAL,GAAwB,IAAInD,eAAJ,CAAoBmC,IAApB,EAA0Ba,OAA1B,CAAxB;AACA,SAAKI,cAAL,GAAsB,IAAIlD,aAAJ,CAAkBiC,IAAlB,EAAwBa,OAAxB,CAAtB;AACA,QAAIK,QAAQ,GAAGC,QAAQ,CAAC9D,aAAT,CAAuB,KAAvB,CAAf;AACA6D,IAAAA,QAAQ,CAACR,KAAT,CAAeC,OAAf,GAAyB,mCAAzB;AACA,SAAKS,OAAL,GAAeZ,MAAf;AACA,SAAKa,QAAL,GAAgBR,OAAhB;AACA,SAAKS,eAAL,GAAuBV,MAAvB;AACA,SAAKW,SAAL,GAAiBL,QAAjB;AACArB,IAAAA,IAAI,CAACV,WAAL,CAAiB+B,QAAjB;AACAA,IAAAA,QAAQ,CAAC/B,WAAT,CAAqBqB,MAArB;AACA,SAAKgB,MAAL,CAAYzB,IAAI,CAAC0B,KAAjB,EAAwB1B,IAAI,CAAC2B,MAA7B;AACA,SAAKC,YAAL,GAAoB,EAApB;AACH;;AACD/B,EAAAA,UAAU,CAACgC,SAAX,CAAqBC,OAArB,GAA+B,YAAY;AACvC,WAAO,KAAP;AACH,GAFD;;AAGAjC,EAAAA,UAAU,CAACgC,SAAX,CAAqBE,eAArB,GAAuC,YAAY;AAC/C,WAAO,KAAKP,SAAZ;AACH,GAFD;;AAGA3B,EAAAA,UAAU,CAACgC,SAAX,CAAqBG,SAArB,GAAiC,YAAY;AACzC,WAAO,KAAKX,OAAZ;AACH,GAFD;;AAGAxB,EAAAA,UAAU,CAACgC,SAAX,CAAqBI,UAArB,GAAkC,YAAY;AAC1C,WAAO,KAAKX,QAAZ;AACH,GAFD;;AAGAzB,EAAAA,UAAU,CAACgC,SAAX,CAAqBK,qBAArB,GAA6C,YAAY;AACrD,QAAIC,YAAY,GAAG,KAAKJ,eAAL,EAAnB;;AACA,QAAII,YAAJ,EAAkB;AACd,aAAO;AACHC,QAAAA,UAAU,EAAED,YAAY,CAACC,UAAb,IAA2B,CADpC;AAEHC,QAAAA,SAAS,EAAEF,YAAY,CAACE,SAAb,IAA0B;AAFlC,OAAP;AAIH;AACJ,GARD;;AASAxC,EAAAA,UAAU,CAACgC,SAAX,CAAqBS,OAArB,GAA+B,YAAY;AACvC,QAAIC,IAAI,GAAG,KAAKxC,OAAL,CAAayC,cAAb,CAA4B,IAA5B,CAAX;;AACA,SAAKC,UAAL,CAAgBF,IAAhB;AACH,GAHD;;AAIA1C,EAAAA,UAAU,CAACgC,SAAX,CAAqBa,kBAArB,GAA0C,UAAUC,eAAV,EAA2B;AACjE,QAAI,KAAKpB,eAAL,IAAwB,KAAKqB,eAAjC,EAAkD;AAC9C,WAAKrB,eAAL,CAAqB/B,WAArB,CAAiC,KAAKoD,eAAtC;AACH;;AACD,QAAIC,MAAM,GAAGvF,aAAa,CAAC,MAAD,CAA1B;AACAuF,IAAAA,MAAM,CAACnC,YAAP,CAAoB,OAApB,EAA6B,KAAKoC,QAAL,EAA7B;AACAD,IAAAA,MAAM,CAACnC,YAAP,CAAoB,QAApB,EAA8B,KAAKqC,SAAL,EAA9B;AACAF,IAAAA,MAAM,CAACnC,YAAP,CAAoB,GAApB,EAAyB,CAAzB;AACAmC,IAAAA,MAAM,CAACnC,YAAP,CAAoB,GAApB,EAAyB,CAAzB;AACAmC,IAAAA,MAAM,CAACnC,YAAP,CAAoB,IAApB,EAA0B,CAA1B;AACAmC,IAAAA,MAAM,CAAClC,KAAP,CAAaqC,IAAb,GAAoBL,eAApB;;AACA,SAAKpB,eAAL,CAAqBnC,WAArB,CAAiCyD,MAAjC;;AACA,SAAKD,eAAL,GAAuBC,MAAvB;AACH,GAbD;;AAcAhD,EAAAA,UAAU,CAACgC,SAAX,CAAqBoB,gBAArB,GAAwC,UAAUC,GAAV,EAAe;AACnD,WAAO5F,aAAa,CAAC4F,GAAD,CAApB;AACH,GAFD;;AAGArD,EAAAA,UAAU,CAACgC,SAAX,CAAqBsB,QAArB,GAAgC,UAAUxE,EAAV,EAAc;AAC1C,QAAIyE,QAAQ,GAAG1E,WAAW,CAACC,EAAD,CAA1B;AACAyE,IAAAA,QAAQ,IAAIA,QAAQ,CAACC,KAAT,CAAe1E,EAAf,CAAZ;AACA,WAAOe,aAAa,CAACf,EAAD,CAApB;AACH,GAJD;;AAKAkB,EAAAA,UAAU,CAACgC,SAAX,CAAqBY,UAArB,GAAkC,UAAUF,IAAV,EAAgB;AAC9C,QAAIe,eAAe,GAAG,KAAKvC,gBAA3B;AACA,QAAIwC,cAAc,GAAG,KAAKvC,eAA1B;AACA,QAAIwC,eAAe,GAAG,KAAKvC,gBAA3B;AACA,QAAIwC,aAAa,GAAG,KAAKvC,cAAzB;AACAoC,IAAAA,eAAe,CAACI,aAAhB;AACAH,IAAAA,cAAc,CAACG,aAAf;AACAF,IAAAA,eAAe,CAACE,aAAhB;AACAD,IAAAA,aAAa,CAACC,aAAd;AACA,QAAI5C,OAAO,GAAG,KAAKQ,QAAnB;AACA,QAAIqC,WAAW,GAAG,KAAK/B,YAAvB;AACA,QAAIgC,OAAO,GAAGrB,IAAI,CAACsB,MAAnB;AACA,QAAIC,cAAc,GAAG,EAArB;;AACA,SAAK,IAAIC,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGH,OAApB,EAA6BG,CAAC,EAA9B,EAAkC;AAC9B,UAAIpE,WAAW,GAAG4C,IAAI,CAACwB,CAAD,CAAtB;AACA,UAAIX,QAAQ,GAAG1E,WAAW,CAACiB,WAAD,CAA1B;AACA,UAAIqE,UAAU,GAAGtE,aAAa,CAACC,WAAD,CAA9B;;AACA,UAAI,CAACA,WAAW,CAACsE,SAAjB,EAA4B;AACxB,YAAItE,WAAW,CAACuE,OAAZ,IAAuB,CAACF,UAA5B,EAAwC;AACpCZ,UAAAA,QAAQ,IAAIA,QAAQ,CAACC,KAAT,CAAe1D,WAAf,CAAZ;AACAqE,UAAAA,UAAU,GAAGtE,aAAa,CAACC,WAAD,CAA1B;;AACA,cAAIqE,UAAU,IAAIrE,WAAW,CAACgB,KAA9B,EAAqC;AACjC2C,YAAAA,eAAe,CAACa,MAAhB,CAAuBxE,WAAW,CAACgB,KAAZ,CAAkBqC,IAAzC;AACAM,YAAAA,eAAe,CAACa,MAAhB,CAAuBxE,WAAW,CAACgB,KAAZ,CAAkByD,MAAzC;AACAb,YAAAA,cAAc,CAACY,MAAf,CAAsBxE,WAAW,CAACgB,KAAZ,CAAkBqC,IAAxC;AACAO,YAAAA,cAAc,CAACY,MAAf,CAAsBxE,WAAW,CAACgB,KAAZ,CAAkByD,MAAxC;AACAX,YAAAA,aAAa,CAACU,MAAd,CAAqBH,UAArB,EAAiCrE,WAAjC;AACH;;AACDA,UAAAA,WAAW,CAACuE,OAAZ,GAAsB,CAAtB;AACH;;AACD,YAAIF,UAAJ,EAAgB;AACZF,UAAAA,cAAc,CAACO,IAAf,CAAoB1E,WAApB;AACH;AACJ;AACJ;;AACD,QAAI2E,IAAI,GAAG3G,SAAS,CAACgG,WAAD,EAAcG,cAAd,CAApB;AACA,QAAIS,cAAJ;AACA,QAAIC,iBAAJ;;AACA,SAAK,IAAIT,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGO,IAAI,CAACT,MAAzB,EAAiCE,CAAC,EAAlC,EAAsC;AAClC,UAAIU,IAAI,GAAGH,IAAI,CAACP,CAAD,CAAf;;AACA,UAAIU,IAAI,CAACC,OAAT,EAAkB;AACd,aAAK,IAAIC,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGF,IAAI,CAACG,KAAzB,EAAgCD,CAAC,EAAjC,EAAqC;AACjC,cAAIhF,WAAW,GAAGgE,WAAW,CAACc,IAAI,CAACI,OAAL,CAAaF,CAAb,CAAD,CAA7B;AACA,cAAIX,UAAU,GAAGtE,aAAa,CAACC,WAAD,CAA9B;AACA5B,UAAAA,WAAW,CAAC4B,WAAD,CAAX,GAA2BF,kBAAkB,CAACuE,UAAD,CAA7C,GACMzE,MAAM,CAACuB,OAAD,EAAUkD,UAAV,CADZ;AAEH;AACJ;AACJ;;AACD,QAAIc,eAAJ;AACA,QAAIC,gBAAJ;;AACA,SAAK,IAAIhB,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGO,IAAI,CAACT,MAAzB,EAAiCE,CAAC,EAAlC,EAAsC;AAClC,UAAIU,IAAI,GAAGH,IAAI,CAACP,CAAD,CAAf;AACA,UAAIiB,KAAK,GAAGP,IAAI,CAACQ,KAAjB;;AACA,UAAIR,IAAI,CAACC,OAAT,EAAkB;AACd;AACH;;AACD,WAAK,IAAIC,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGF,IAAI,CAACG,KAAzB,EAAgCD,CAAC,EAAjC,EAAqC;AACjC,YAAIhF,WAAW,GAAGmE,cAAc,CAACW,IAAI,CAACI,OAAL,CAAaF,CAAb,CAAD,CAAhC;AACA,YAAIO,SAAS,GAAG1B,eAAe,CAACW,MAAhB,CAAuBxE,WAAvB,EAAoCmF,eAApC,CAAhB;;AACA,YAAII,SAAS,KAAKH,gBAAlB,EAAoC;AAChCR,UAAAA,cAAc,GAAGC,iBAAjB;;AACA,cAAIU,SAAJ,EAAe;AACXX,YAAAA,cAAc,GAAGvF,WAAW,CAAC8B,OAAD,EAAUoE,SAAV,EAAqBX,cAArB,CAAd,GACRlF,OAAO,CAACyB,OAAD,EAAUoE,SAAV,CADb;AAEAV,YAAAA,iBAAiB,GAAGU,SAApB;AACAX,YAAAA,cAAc,GAAG,IAAjB;AACH;;AACDQ,UAAAA,gBAAgB,GAAGG,SAAnB;AACH;;AACD,YAAIlB,UAAU,GAAGtE,aAAa,CAACC,WAAD,CAA9B;AACA4E,QAAAA,cAAc,GACRvF,WAAW,CAAC+F,gBAAgB,IAAIjE,OAArB,EAA8BkD,UAA9B,EAA0CO,cAA1C,CADH,GAERlF,OAAO,CAAC0F,gBAAgB,IAAIjE,OAArB,EAA8BkD,UAA9B,CAFb;AAGAO,QAAAA,cAAc,GAAGP,UAAU,IAAIO,cAA/B;;AACA,YAAI,CAACQ,gBAAL,EAAuB;AACnBP,UAAAA,iBAAiB,GAAGD,cAApB;AACH;;AACDjB,QAAAA,eAAe,CAAC6B,QAAhB,CAAyBxF,WAAzB;AACA2D,QAAAA,eAAe,CAAC8B,gBAAhB,CAAiCpB,UAAjC,EAA6CrE,WAA7C;AACA4D,QAAAA,cAAc,CAAC4B,QAAf,CAAwBxF,WAAxB;AACA4D,QAAAA,cAAc,CAAC6B,gBAAf,CAAgCpB,UAAhC,EAA4CrE,WAA5C;AACA6D,QAAAA,eAAe,CAAC2B,QAAhB,CAAyBxF,WAAzB;AACAmF,QAAAA,eAAe,GAAGnF,WAAlB;AACH;AACJ;;AACD2D,IAAAA,eAAe,CAAC+B,YAAhB;AACA9B,IAAAA,cAAc,CAAC8B,YAAf;AACA7B,IAAAA,eAAe,CAAC6B,YAAhB;AACA5B,IAAAA,aAAa,CAAC4B,YAAd;AACA,SAAKzD,YAAL,GAAoBkC,cAApB;AACH,GA3FD;;AA4FAjE,EAAAA,UAAU,CAACgC,SAAX,CAAqByD,QAArB,GAAgC,UAAUC,eAAV,EAA2B;AACvD,QAAIzE,OAAO,GAAG,KAAKO,OAAnB;AACA,QAAImE,IAAI,GAAG1E,OAAO,CAAC2E,oBAAR,CAA6B,MAA7B,CAAX;;AACA,QAAID,IAAI,CAAC3B,MAAL,KAAgB,CAApB,EAAuB;AACnB,UAAI0B,eAAJ,EAAqB;AACjB,YAAIG,MAAM,GAAG5E,OAAO,CAAC3B,YAAR,CAAqB7B,aAAa,CAAC,MAAD,CAAlC,EAA4CwD,OAAO,CAACxB,UAApD,CAAb;;AACA,YAAI,CAACoG,MAAM,CAACC,QAAZ,EAAsB;AAClBD,UAAAA,MAAM,CAACC,QAAP,GAAkB,UAAUhH,EAAV,EAAc;AAC5B,gBAAIiH,QAAQ,GAAGF,MAAM,CAACE,QAAtB;;AACA,gBAAI,CAACA,QAAL,EAAe;AACX,qBAAO,KAAP;AACH;;AACD,iBAAK,IAAI7B,CAAC,GAAG6B,QAAQ,CAAC/B,MAAT,GAAkB,CAA/B,EAAkCE,CAAC,IAAI,CAAvC,EAA0C,EAAEA,CAA5C,EAA+C;AAC3C,kBAAI6B,QAAQ,CAAC7B,CAAD,CAAR,KAAgBpF,EAApB,EAAwB;AACpB,uBAAO,IAAP;AACH;AACJ;;AACD,mBAAO,KAAP;AACH,WAXD;AAYH;;AACD,eAAO+G,MAAP;AACH,OAjBD,MAkBK;AACD,eAAO,IAAP;AACH;AACJ,KAtBD,MAuBK;AACD,aAAOF,IAAI,CAAC,CAAD,CAAX;AACH;AACJ,GA7BD;;AA8BA3F,EAAAA,UAAU,CAACgC,SAAX,CAAqBJ,MAArB,GAA8B,UAAUC,KAAV,EAAiBC,MAAjB,EAAyB;AACnD,QAAIR,QAAQ,GAAG,KAAKK,SAApB;AACAL,IAAAA,QAAQ,CAACR,KAAT,CAAekF,OAAf,GAAyB,MAAzB;AACA,QAAI7F,IAAI,GAAG,KAAKO,KAAhB;AACAmB,IAAAA,KAAK,IAAI,IAAT,KAAkB1B,IAAI,CAAC0B,KAAL,GAAaA,KAA/B;AACAC,IAAAA,MAAM,IAAI,IAAV,KAAmB3B,IAAI,CAAC2B,MAAL,GAAcA,MAAjC;AACAD,IAAAA,KAAK,GAAG,KAAKoE,QAAL,CAAc,CAAd,CAAR;AACAnE,IAAAA,MAAM,GAAG,KAAKmE,QAAL,CAAc,CAAd,CAAT;AACA3E,IAAAA,QAAQ,CAACR,KAAT,CAAekF,OAAf,GAAyB,EAAzB;;AACA,QAAI,KAAKE,MAAL,KAAgBrE,KAAhB,IAAyB,KAAKsE,OAAL,KAAiBrE,MAA9C,EAAsD;AAClD,WAAKoE,MAAL,GAAcrE,KAAd;AACA,WAAKsE,OAAL,GAAerE,MAAf;AACA,UAAIsE,aAAa,GAAG9E,QAAQ,CAACR,KAA7B;AACAsF,MAAAA,aAAa,CAACvE,KAAd,GAAsBA,KAAK,GAAG,IAA9B;AACAuE,MAAAA,aAAa,CAACtE,MAAd,GAAuBA,MAAM,GAAG,IAAhC;AACA,UAAIb,OAAO,GAAG,KAAKO,OAAnB;AACAP,MAAAA,OAAO,CAACJ,YAAR,CAAqB,OAArB,EAA8BgB,KAAK,GAAG,EAAtC;AACAZ,MAAAA,OAAO,CAACJ,YAAR,CAAqB,QAArB,EAA+BiB,MAAM,GAAG,EAAxC;AACH;;AACD,QAAI,KAAKiB,eAAT,EAA0B;AACtB,WAAKA,eAAL,CAAqBlC,YAArB,CAAkC,OAAlC,EAA2CgB,KAA3C;;AACA,WAAKkB,eAAL,CAAqBlC,YAArB,CAAkC,QAAlC,EAA4CiB,MAA5C;AACH;AACJ,GAvBD;;AAwBA9B,EAAAA,UAAU,CAACgC,SAAX,CAAqBiB,QAArB,GAAgC,YAAY;AACxC,WAAO,KAAKiD,MAAZ;AACH,GAFD;;AAGAlG,EAAAA,UAAU,CAACgC,SAAX,CAAqBkB,SAArB,GAAiC,YAAY;AACzC,WAAO,KAAKiD,OAAZ;AACH,GAFD;;AAGAnG,EAAAA,UAAU,CAACgC,SAAX,CAAqBiE,QAArB,GAAgC,UAAUI,KAAV,EAAiB;AAC7C,QAAIlG,IAAI,GAAG,KAAKO,KAAhB;AACA,QAAI4F,EAAE,GAAG,CAAC,OAAD,EAAU,QAAV,EAAoBD,KAApB,CAAT;AACA,QAAIE,GAAG,GAAG,CAAC,aAAD,EAAgB,cAAhB,EAAgCF,KAAhC,CAAV;AACA,QAAIG,GAAG,GAAG,CAAC,aAAD,EAAgB,YAAhB,EAA8BH,KAA9B,CAAV;AACA,QAAII,GAAG,GAAG,CAAC,cAAD,EAAiB,eAAjB,EAAkCJ,KAAlC,CAAV;;AACA,QAAIlG,IAAI,CAACmG,EAAD,CAAJ,IAAY,IAAZ,IAAoBnG,IAAI,CAACmG,EAAD,CAAJ,KAAa,MAArC,EAA6C;AACzC,aAAOI,UAAU,CAACvG,IAAI,CAACmG,EAAD,CAAL,CAAjB;AACH;;AACD,QAAIrG,IAAI,GAAG,KAAKA,IAAhB;AACA,QAAI0G,GAAG,GAAGpF,QAAQ,CAACqF,WAAT,CAAqBC,gBAArB,CAAsC5G,IAAtC,CAAV;AACA,WAAQ,CAACA,IAAI,CAACsG,GAAD,CAAJ,IAAa7H,UAAU,CAACiI,GAAG,CAACL,EAAD,CAAJ,CAAvB,IAAoC5H,UAAU,CAACuB,IAAI,CAACa,KAAL,CAAWwF,EAAX,CAAD,CAA/C,KACD5H,UAAU,CAACiI,GAAG,CAACH,GAAD,CAAJ,CAAV,IAAwB,CADvB,KAED9H,UAAU,CAACiI,GAAG,CAACF,GAAD,CAAJ,CAAV,IAAwB,CAFvB,CAAD,GAE8B,CAFrC;AAGH,GAdD;;AAeAzG,EAAAA,UAAU,CAACgC,SAAX,CAAqB8E,OAArB,GAA+B,YAAY;AACvC,SAAK7G,IAAL,CAAU8G,SAAV,GAAsB,EAAtB;AACA,SAAKtF,QAAL,GACM,KAAKC,eAAL,GACI,KAAKF,OAAL,GACI,KAAKuB,eAAL,GACI,KAAKpB,SAAL,GACI,KAAKzB,OAAL,GACI,IAN1B;AAOH,GATD;;AAUAF,EAAAA,UAAU,CAACgC,SAAX,CAAqBgF,KAArB,GAA6B,YAAY;AACrC,QAAIC,YAAY,GAAG,KAAKtF,SAAxB;;AACA,QAAIsF,YAAY,IAAIA,YAAY,CAAC/H,UAAjC,EAA6C;AACzC+H,MAAAA,YAAY,CAAC/H,UAAb,CAAwBS,WAAxB,CAAoCsH,YAApC;AACH;AACJ,GALD;;AAMAjH,EAAAA,UAAU,CAACgC,SAAX,CAAqBkF,SAArB,GAAiC,YAAY;AACzC,SAAKzE,OAAL;AACA,QAAI0E,IAAI,GAAGC,kBAAkB,CAAC,KAAK5F,OAAL,CAAa6F,SAAb,CAAuBC,OAAvB,CAA+B,KAA/B,EAAsC,QAAtC,CAAD,CAA7B;AACA,WAAO,sCAAsCH,IAA7C;AACH,GAJD;;AAKA,SAAOnH,UAAP;AACH,CA7QiB,EAAlB;;AA8QA,SAASO,sBAAT,CAAgCgH,MAAhC,EAAwC;AACpC,SAAO,YAAY;AACf7J,IAAAA,IAAI,CAAC8J,QAAL,CAAc,6CAA6CD,MAA7C,GAAsD,GAApE;AACH,GAFD;AAGH;;AACD,eAAevH,UAAf","sourcesContent":["import { createElement } from './core';\nimport * as util from '../core/util';\nimport Path from '../graphic/Path';\nimport ZRImage from '../graphic/Image';\nimport TSpan from '../graphic/TSpan';\nimport arrayDiff from '../core/arrayDiff';\nimport GradientManager from './helper/GradientManager';\nimport PatternManager from './helper/PatternManager';\nimport ClippathManager, { hasClipPath } from './helper/ClippathManager';\nimport ShadowManager from './helper/ShadowManager';\nimport { path as svgPath, image as svgImage, text as svgText } from './graphic';\nfunction parseInt10(val) {\n    return parseInt(val, 10);\n}\nfunction getSvgProxy(el) {\n    if (el instanceof Path) {\n        return svgPath;\n    }\n    else if (el instanceof ZRImage) {\n        return svgImage;\n    }\n    else if (el instanceof TSpan) {\n        return svgText;\n    }\n    else {\n        return svgPath;\n    }\n}\nfunction checkParentAvailable(parent, child) {\n    return child && parent && child.parentNode !== parent;\n}\nfunction insertAfter(parent, child, prevSibling) {\n    if (checkParentAvailable(parent, child) && prevSibling) {\n        var nextSibling = prevSibling.nextSibling;\n        nextSibling ? parent.insertBefore(child, nextSibling)\n            : parent.appendChild(child);\n    }\n}\nfunction prepend(parent, child) {\n    if (checkParentAvailable(parent, child)) {\n        var firstChild = parent.firstChild;\n        firstChild ? parent.insertBefore(child, firstChild)\n            : parent.appendChild(child);\n    }\n}\nfunction remove(parent, child) {\n    if (child && parent && child.parentNode === parent) {\n        parent.removeChild(child);\n    }\n}\nfunction removeFromMyParent(child) {\n    if (child && child.parentNode) {\n        child.parentNode.removeChild(child);\n    }\n}\nfunction getSvgElement(displayable) {\n    return displayable.__svgEl;\n}\nvar SVGPainter = (function () {\n    function SVGPainter(root, storage, opts, zrId) {\n        this.type = 'svg';\n        this.refreshHover = createMethodNotSupport('refreshHover');\n        this.pathToImage = createMethodNotSupport('pathToImage');\n        this.configLayer = createMethodNotSupport('configLayer');\n        this.root = root;\n        this.storage = storage;\n        this._opts = opts = util.extend({}, opts || {});\n        var svgDom = createElement('svg');\n        svgDom.setAttribute('xmlns', 'http://www.w3.org/2000/svg');\n        svgDom.setAttribute('version', '1.1');\n        svgDom.setAttribute('baseProfile', 'full');\n        svgDom.style.cssText = 'user-select:none;position:absolute;left:0;top:0;';\n        var bgRoot = createElement('g');\n        svgDom.appendChild(bgRoot);\n        var svgRoot = createElement('g');\n        svgDom.appendChild(svgRoot);\n        this._gradientManager = new GradientManager(zrId, svgRoot);\n        this._patternManager = new PatternManager(zrId, svgRoot);\n        this._clipPathManager = new ClippathManager(zrId, svgRoot);\n        this._shadowManager = new ShadowManager(zrId, svgRoot);\n        var viewport = document.createElement('div');\n        viewport.style.cssText = 'overflow:hidden;position:relative';\n        this._svgDom = svgDom;\n        this._svgRoot = svgRoot;\n        this._backgroundRoot = bgRoot;\n        this._viewport = viewport;\n        root.appendChild(viewport);\n        viewport.appendChild(svgDom);\n        this.resize(opts.width, opts.height);\n        this._visibleList = [];\n    }\n    SVGPainter.prototype.getType = function () {\n        return 'svg';\n    };\n    SVGPainter.prototype.getViewportRoot = function () {\n        return this._viewport;\n    };\n    SVGPainter.prototype.getSvgDom = function () {\n        return this._svgDom;\n    };\n    SVGPainter.prototype.getSvgRoot = function () {\n        return this._svgRoot;\n    };\n    SVGPainter.prototype.getViewportRootOffset = function () {\n        var viewportRoot = this.getViewportRoot();\n        if (viewportRoot) {\n            return {\n                offsetLeft: viewportRoot.offsetLeft || 0,\n                offsetTop: viewportRoot.offsetTop || 0\n            };\n        }\n    };\n    SVGPainter.prototype.refresh = function () {\n        var list = this.storage.getDisplayList(true);\n        this._paintList(list);\n    };\n    SVGPainter.prototype.setBackgroundColor = function (backgroundColor) {\n        if (this._backgroundRoot && this._backgroundNode) {\n            this._backgroundRoot.removeChild(this._backgroundNode);\n        }\n        var bgNode = createElement('rect');\n        bgNode.setAttribute('width', this.getWidth());\n        bgNode.setAttribute('height', this.getHeight());\n        bgNode.setAttribute('x', 0);\n        bgNode.setAttribute('y', 0);\n        bgNode.setAttribute('id', 0);\n        bgNode.style.fill = backgroundColor;\n        this._backgroundRoot.appendChild(bgNode);\n        this._backgroundNode = bgNode;\n    };\n    SVGPainter.prototype.createSVGElement = function (tag) {\n        return createElement(tag);\n    };\n    SVGPainter.prototype.paintOne = function (el) {\n        var svgProxy = getSvgProxy(el);\n        svgProxy && svgProxy.brush(el);\n        return getSvgElement(el);\n    };\n    SVGPainter.prototype._paintList = function (list) {\n        var gradientManager = this._gradientManager;\n        var patternManager = this._patternManager;\n        var clipPathManager = this._clipPathManager;\n        var shadowManager = this._shadowManager;\n        gradientManager.markAllUnused();\n        patternManager.markAllUnused();\n        clipPathManager.markAllUnused();\n        shadowManager.markAllUnused();\n        var svgRoot = this._svgRoot;\n        var visibleList = this._visibleList;\n        var listLen = list.length;\n        var newVisibleList = [];\n        for (var i = 0; i < listLen; i++) {\n            var displayable = list[i];\n            var svgProxy = getSvgProxy(displayable);\n            var svgElement = getSvgElement(displayable);\n            if (!displayable.invisible) {\n                if (displayable.__dirty || !svgElement) {\n                    svgProxy && svgProxy.brush(displayable);\n                    svgElement = getSvgElement(displayable);\n                    if (svgElement && displayable.style) {\n                        gradientManager.update(displayable.style.fill);\n                        gradientManager.update(displayable.style.stroke);\n                        patternManager.update(displayable.style.fill);\n                        patternManager.update(displayable.style.stroke);\n                        shadowManager.update(svgElement, displayable);\n                    }\n                    displayable.__dirty = 0;\n                }\n                if (svgElement) {\n                    newVisibleList.push(displayable);\n                }\n            }\n        }\n        var diff = arrayDiff(visibleList, newVisibleList);\n        var prevSvgElement;\n        var topPrevSvgElement;\n        for (var i = 0; i < diff.length; i++) {\n            var item = diff[i];\n            if (item.removed) {\n                for (var k = 0; k < item.count; k++) {\n                    var displayable = visibleList[item.indices[k]];\n                    var svgElement = getSvgElement(displayable);\n                    hasClipPath(displayable) ? removeFromMyParent(svgElement)\n                        : remove(svgRoot, svgElement);\n                }\n            }\n        }\n        var prevDisplayable;\n        var currentClipGroup;\n        for (var i = 0; i < diff.length; i++) {\n            var item = diff[i];\n            var isAdd = item.added;\n            if (item.removed) {\n                continue;\n            }\n            for (var k = 0; k < item.count; k++) {\n                var displayable = newVisibleList[item.indices[k]];\n                var clipGroup = clipPathManager.update(displayable, prevDisplayable);\n                if (clipGroup !== currentClipGroup) {\n                    prevSvgElement = topPrevSvgElement;\n                    if (clipGroup) {\n                        prevSvgElement ? insertAfter(svgRoot, clipGroup, prevSvgElement)\n                            : prepend(svgRoot, clipGroup);\n                        topPrevSvgElement = clipGroup;\n                        prevSvgElement = null;\n                    }\n                    currentClipGroup = clipGroup;\n                }\n                var svgElement = getSvgElement(displayable);\n                prevSvgElement\n                    ? insertAfter(currentClipGroup || svgRoot, svgElement, prevSvgElement)\n                    : prepend(currentClipGroup || svgRoot, svgElement);\n                prevSvgElement = svgElement || prevSvgElement;\n                if (!currentClipGroup) {\n                    topPrevSvgElement = prevSvgElement;\n                }\n                gradientManager.markUsed(displayable);\n                gradientManager.addWithoutUpdate(svgElement, displayable);\n                patternManager.markUsed(displayable);\n                patternManager.addWithoutUpdate(svgElement, displayable);\n                clipPathManager.markUsed(displayable);\n                prevDisplayable = displayable;\n            }\n        }\n        gradientManager.removeUnused();\n        patternManager.removeUnused();\n        clipPathManager.removeUnused();\n        shadowManager.removeUnused();\n        this._visibleList = newVisibleList;\n    };\n    SVGPainter.prototype._getDefs = function (isForceCreating) {\n        var svgRoot = this._svgDom;\n        var defs = svgRoot.getElementsByTagName('defs');\n        if (defs.length === 0) {\n            if (isForceCreating) {\n                var defs_1 = svgRoot.insertBefore(createElement('defs'), svgRoot.firstChild);\n                if (!defs_1.contains) {\n                    defs_1.contains = function (el) {\n                        var children = defs_1.children;\n                        if (!children) {\n                            return false;\n                        }\n                        for (var i = children.length - 1; i >= 0; --i) {\n                            if (children[i] === el) {\n                                return true;\n                            }\n                        }\n                        return false;\n                    };\n                }\n                return defs_1;\n            }\n            else {\n                return null;\n            }\n        }\n        else {\n            return defs[0];\n        }\n    };\n    SVGPainter.prototype.resize = function (width, height) {\n        var viewport = this._viewport;\n        viewport.style.display = 'none';\n        var opts = this._opts;\n        width != null && (opts.width = width);\n        height != null && (opts.height = height);\n        width = this._getSize(0);\n        height = this._getSize(1);\n        viewport.style.display = '';\n        if (this._width !== width || this._height !== height) {\n            this._width = width;\n            this._height = height;\n            var viewportStyle = viewport.style;\n            viewportStyle.width = width + 'px';\n            viewportStyle.height = height + 'px';\n            var svgRoot = this._svgDom;\n            svgRoot.setAttribute('width', width + '');\n            svgRoot.setAttribute('height', height + '');\n        }\n        if (this._backgroundNode) {\n            this._backgroundNode.setAttribute('width', width);\n            this._backgroundNode.setAttribute('height', height);\n        }\n    };\n    SVGPainter.prototype.getWidth = function () {\n        return this._width;\n    };\n    SVGPainter.prototype.getHeight = function () {\n        return this._height;\n    };\n    SVGPainter.prototype._getSize = function (whIdx) {\n        var opts = this._opts;\n        var wh = ['width', 'height'][whIdx];\n        var cwh = ['clientWidth', 'clientHeight'][whIdx];\n        var plt = ['paddingLeft', 'paddingTop'][whIdx];\n        var prb = ['paddingRight', 'paddingBottom'][whIdx];\n        if (opts[wh] != null && opts[wh] !== 'auto') {\n            return parseFloat(opts[wh]);\n        }\n        var root = this.root;\n        var stl = document.defaultView.getComputedStyle(root);\n        return ((root[cwh] || parseInt10(stl[wh]) || parseInt10(root.style[wh]))\n            - (parseInt10(stl[plt]) || 0)\n            - (parseInt10(stl[prb]) || 0)) | 0;\n    };\n    SVGPainter.prototype.dispose = function () {\n        this.root.innerHTML = '';\n        this._svgRoot\n            = this._backgroundRoot\n                = this._svgDom\n                    = this._backgroundNode\n                        = this._viewport\n                            = this.storage\n                                = null;\n    };\n    SVGPainter.prototype.clear = function () {\n        var viewportNode = this._viewport;\n        if (viewportNode && viewportNode.parentNode) {\n            viewportNode.parentNode.removeChild(viewportNode);\n        }\n    };\n    SVGPainter.prototype.toDataURL = function () {\n        this.refresh();\n        var html = encodeURIComponent(this._svgDom.outerHTML.replace(/></g, '>\\n\\r<'));\n        return 'data:image/svg+xml;charset=UTF-8,' + html;\n    };\n    return SVGPainter;\n}());\nfunction createMethodNotSupport(method) {\n    return function () {\n        util.logError('In SVG mode painter not support method \"' + method + '\"');\n    };\n}\nexport default SVGPainter;\n"]},"metadata":{},"sourceType":"module"}