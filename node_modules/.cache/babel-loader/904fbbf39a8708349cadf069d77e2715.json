{"ast":null,"code":"import React, { useEffect } from 'react';\nimport G6 from '@antv/g6/es';\nimport { ErrorBoundary } from '../base';\nimport { customIconNode } from './customItems';\nimport { getGraphSize, processMinimap } from './util';\nimport useGraph from '../hooks/useGraph';\nvar defaultStateStyles = {\n  hover: {\n    stroke: '#1890ff',\n    lineWidth: 2\n  }\n};\nvar defaultNodeStyle = {\n  fill: '#91d5ff',\n  stroke: '#40a9ff',\n  radius: 5\n};\nvar defaultEdgeStyle = {\n  stroke: '#91d5ff',\n  endArrow: {\n    path: 'M 0,0 L 12, 6 L 9,0 L 12, -6 Z',\n    fill: '#91d5ff',\n    d: -20\n  }\n};\nvar defaultLayout = {\n  type: 'compactBox',\n  direction: 'TB',\n  getId: function getId(d) {\n    return d.id;\n  },\n  getHeight: function getHeight() {\n    return 16;\n  },\n  getWidth: function getWidth() {\n    return 16;\n  },\n  getVGap: function getVGap() {\n    return 40;\n  },\n  getHGap: function getHGap() {\n    return 70;\n  }\n};\nvar defaultLabelCfg = {\n  style: {\n    fill: '#000',\n    fontSize: 12\n  }\n};\nvar graph;\n\nvar OrganizationTreeGraphComponent = function (_a) {\n  var data = _a.data,\n      className = _a.className,\n      style = _a.style,\n      width = _a.width,\n      height = _a.height,\n      _b = _a.nodeType,\n      nodeType = _b === void 0 ? 'rect' : _b,\n      _c = _a.edgeType,\n      edgeType = _c === void 0 ? 'flow-line' : _c,\n      _d = _a.collapseExpand,\n      collapseExpand = _d === void 0 ? false : _d,\n      _e = _a.nodeSize,\n      nodeSize = _e === void 0 ? [120, 40] : _e,\n      _f = _a.nodeLabelCfg,\n      nodeLabelCfg = _f === void 0 ? defaultLabelCfg : _f,\n      _g = _a.edgeLabelCfg,\n      edgeLabelCfg = _g === void 0 ? defaultLabelCfg : _g,\n      _h = _a.layout,\n      layout = _h === void 0 ? defaultLayout : _h,\n      _j = _a.enableEdit,\n      enableEdit = _j === void 0 ? false : _j,\n      minimapCfg = _a.minimapCfg,\n      _k = _a.nodeStyle,\n      nodeStyle = _k === void 0 ? defaultNodeStyle : _k,\n      _l = _a.edgeStyle,\n      edgeStyle = _l === void 0 ? defaultEdgeStyle : _l,\n      _m = _a.nodeStateStyles,\n      nodeStateStyles = _m === void 0 ? defaultStateStyles : _m,\n      _o = _a.edgeStateStyles,\n      edgeStateStyles = _o === void 0 ? defaultStateStyles : _o,\n      handleNodeClick = _a.handleNodeClick,\n      handleEdgeClick = _a.handleEdgeClick,\n      handleNodeHover = _a.handleNodeHover,\n      handleNodeUnHover = _a.handleNodeUnHover,\n      handleEdgeHover = _a.handleEdgeHover,\n      handleEdgeUnHover = _a.handleEdgeUnHover,\n      handleCanvasClick = _a.handleCanvasClick,\n      graphRef = _a.graphRef;\n  var props = {\n    data: data,\n    className: className,\n    style: style,\n    width: width,\n    height: height,\n    nodeType: nodeType,\n    edgeType: edgeType,\n    collapseExpand: collapseExpand,\n    nodeSize: nodeSize,\n    nodeLabelCfg: nodeLabelCfg,\n    edgeLabelCfg: edgeLabelCfg,\n    layout: layout,\n    enableEdit: enableEdit,\n    minimapCfg: minimapCfg,\n    nodeStyle: nodeStyle,\n    edgeStyle: edgeStyle,\n    nodeStateStyles: nodeStateStyles,\n    edgeStateStyles: edgeStateStyles,\n    handleNodeClick: handleNodeClick,\n    handleEdgeClick: handleEdgeClick,\n    handleNodeHover: handleNodeHover,\n    handleNodeUnHover: handleNodeUnHover,\n    handleEdgeHover: handleEdgeHover,\n    handleEdgeUnHover: handleEdgeUnHover,\n    handleCanvasClick: handleCanvasClick,\n    graphRef: graphRef\n  };\n  var container = React.useRef(null);\n  useGraph(graph, props, container);\n  useEffect(function () {\n    var graphSize = getGraphSize(width, height, container);\n\n    if (!graph || graph.destroyed) {\n      if (nodeType === 'icon-node') {\n        customIconNode({\n          enableEdit: enableEdit\n        });\n      }\n\n      graph = new G6.TreeGraph({\n        container: container.current,\n        width: graphSize[0],\n        height: graphSize[1],\n        linkCenter: true,\n        modes: {\n          default: ['drag-canvas', 'zoom-canvas']\n        },\n        defaultNode: {\n          type: nodeType,\n          size: nodeSize,\n          style: nodeStyle,\n          labelCfg: nodeLabelCfg\n        },\n        defaultEdge: {\n          type: edgeType,\n          style: edgeStyle,\n          labelCfg: edgeLabelCfg\n        },\n        nodeStateStyles: nodeStateStyles,\n        edgeStateStyles: edgeStateStyles,\n        layout: layout\n      });\n\n      if (graphRef) {\n        graphRef.current = graph;\n      }\n    }\n\n    processMinimap(minimapCfg, graph);\n    graph.data(data);\n    graph.render();\n    graph.fitView();\n\n    if (collapseExpand) {\n      graph.addBehaviors({\n        type: 'collapse-expand',\n        onChange: function onChange(item, collapsed) {\n          if (!item) {\n            return false;\n          }\n\n          var data = item.get('model').data;\n          data.collapsed = collapsed;\n          return true;\n        }\n      }, 'default');\n    }\n\n    graph.on('node:mouseenter', function (evt) {\n      var item = evt.item;\n      graph.setItemState(item, 'hover', true);\n\n      if (handleNodeHover) {\n        handleNodeHover(item, graph);\n      }\n    });\n    graph.on('node:mouseleave', function (evt) {\n      var item = evt.item;\n      graph.setItemState(item, 'hover', false);\n\n      if (handleNodeUnHover) {\n        handleNodeUnHover(item, graph);\n      }\n    });\n    graph.on('node:click', function (evt) {\n      var item = evt.item,\n          target = evt.target;\n      var targetType = target.get('type');\n      var name = target.get('name'); // 增加元素\n\n      if (targetType === 'marker') {\n        var model = item.getModel();\n\n        if (name === 'add-item') {\n          if (!model.children) {\n            model.children = [];\n          }\n\n          var tmpId = Math.random().toString(36).slice(-8);\n          model.children.push({\n            id: tmpId,\n            label: tmpId\n          });\n          graph.updateChild(model, model.id);\n        } else if (name === 'remove-item') {\n          graph.removeChild(model.id);\n        }\n      } else {\n        if (handleNodeClick) {\n          handleNodeClick(item, graph);\n        }\n      }\n    });\n    graph.on('edge:mouseenter', function (evt) {\n      var item = evt.item;\n      graph.setItemState(item, 'hover', true);\n\n      if (handleEdgeHover) {\n        handleEdgeHover(item, graph);\n      }\n    });\n    graph.on('edge:mouseleave', function (evt) {\n      var item = evt.item;\n      graph.setItemState(item, 'hover', false);\n\n      if (handleEdgeUnHover) {\n        handleEdgeUnHover(item, graph);\n      }\n    });\n    graph.on('edge:click', function (evt) {\n      var item = evt.item;\n\n      if (handleEdgeClick) {\n        handleEdgeClick(item, graph);\n      }\n    });\n    graph.on('canvas:click', function (evt) {\n      handleCanvasClick && handleCanvasClick(graph);\n    });\n    return function () {\n      return graph.destroy();\n    };\n  }, []);\n  return React.createElement(ErrorBoundary, null, React.createElement(\"div\", {\n    className: className,\n    style: style,\n    ref: container\n  }));\n};\n\nexport default OrganizationTreeGraphComponent;","map":{"version":3,"sources":["/Users/wanglijie/wanglijie/clover-defi-wallet/node_modules/@ant-design/charts/es/graph/organizationTreeGraph.js"],"names":["React","useEffect","G6","ErrorBoundary","customIconNode","getGraphSize","processMinimap","useGraph","defaultStateStyles","hover","stroke","lineWidth","defaultNodeStyle","fill","radius","defaultEdgeStyle","endArrow","path","d","defaultLayout","type","direction","getId","id","getHeight","getWidth","getVGap","getHGap","defaultLabelCfg","style","fontSize","graph","OrganizationTreeGraphComponent","_a","data","className","width","height","_b","nodeType","_c","edgeType","_d","collapseExpand","_e","nodeSize","_f","nodeLabelCfg","_g","edgeLabelCfg","_h","layout","_j","enableEdit","minimapCfg","_k","nodeStyle","_l","edgeStyle","_m","nodeStateStyles","_o","edgeStateStyles","handleNodeClick","handleEdgeClick","handleNodeHover","handleNodeUnHover","handleEdgeHover","handleEdgeUnHover","handleCanvasClick","graphRef","props","container","useRef","graphSize","destroyed","TreeGraph","current","linkCenter","modes","default","defaultNode","size","labelCfg","defaultEdge","render","fitView","addBehaviors","onChange","item","collapsed","get","on","evt","setItemState","target","targetType","name","model","getModel","children","tmpId","Math","random","toString","slice","push","label","updateChild","removeChild","destroy","createElement","ref"],"mappings":"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","sourcesContent":["import React, { useEffect } from 'react';\nimport G6 from '@antv/g6/es';\nimport { ErrorBoundary } from '../base';\nimport { customIconNode } from './customItems';\nimport { getGraphSize, processMinimap } from './util';\nimport useGraph from '../hooks/useGraph';\nvar defaultStateStyles = {\n    hover: {\n        stroke: '#1890ff',\n        lineWidth: 2\n    }\n};\nvar defaultNodeStyle = {\n    fill: '#91d5ff',\n    stroke: '#40a9ff',\n    radius: 5\n};\nvar defaultEdgeStyle = {\n    stroke: '#91d5ff',\n    endArrow: {\n        path: 'M 0,0 L 12, 6 L 9,0 L 12, -6 Z',\n        fill: '#91d5ff',\n        d: -20\n    }\n};\nvar defaultLayout = {\n    type: 'compactBox',\n    direction: 'TB',\n    getId: function getId(d) {\n        return d.id;\n    },\n    getHeight: function getHeight() {\n        return 16;\n    },\n    getWidth: function getWidth() {\n        return 16;\n    },\n    getVGap: function getVGap() {\n        return 40;\n    },\n    getHGap: function getHGap() {\n        return 70;\n    },\n};\nvar defaultLabelCfg = {\n    style: {\n        fill: '#000',\n        fontSize: 12\n    }\n};\nvar graph;\nvar OrganizationTreeGraphComponent = function (_a) {\n    var data = _a.data, className = _a.className, style = _a.style, width = _a.width, height = _a.height, _b = _a.nodeType, nodeType = _b === void 0 ? 'rect' : _b, _c = _a.edgeType, edgeType = _c === void 0 ? 'flow-line' : _c, _d = _a.collapseExpand, collapseExpand = _d === void 0 ? false : _d, _e = _a.nodeSize, nodeSize = _e === void 0 ? [120, 40] : _e, _f = _a.nodeLabelCfg, nodeLabelCfg = _f === void 0 ? defaultLabelCfg : _f, _g = _a.edgeLabelCfg, edgeLabelCfg = _g === void 0 ? defaultLabelCfg : _g, _h = _a.layout, layout = _h === void 0 ? defaultLayout : _h, _j = _a.enableEdit, enableEdit = _j === void 0 ? false : _j, minimapCfg = _a.minimapCfg, _k = _a.nodeStyle, nodeStyle = _k === void 0 ? defaultNodeStyle : _k, _l = _a.edgeStyle, edgeStyle = _l === void 0 ? defaultEdgeStyle : _l, _m = _a.nodeStateStyles, nodeStateStyles = _m === void 0 ? defaultStateStyles : _m, _o = _a.edgeStateStyles, edgeStateStyles = _o === void 0 ? defaultStateStyles : _o, handleNodeClick = _a.handleNodeClick, handleEdgeClick = _a.handleEdgeClick, handleNodeHover = _a.handleNodeHover, handleNodeUnHover = _a.handleNodeUnHover, handleEdgeHover = _a.handleEdgeHover, handleEdgeUnHover = _a.handleEdgeUnHover, handleCanvasClick = _a.handleCanvasClick, graphRef = _a.graphRef;\n    var props = {\n        data: data,\n        className: className,\n        style: style,\n        width: width,\n        height: height,\n        nodeType: nodeType,\n        edgeType: edgeType,\n        collapseExpand: collapseExpand,\n        nodeSize: nodeSize,\n        nodeLabelCfg: nodeLabelCfg,\n        edgeLabelCfg: edgeLabelCfg,\n        layout: layout,\n        enableEdit: enableEdit,\n        minimapCfg: minimapCfg,\n        nodeStyle: nodeStyle,\n        edgeStyle: edgeStyle,\n        nodeStateStyles: nodeStateStyles,\n        edgeStateStyles: edgeStateStyles,\n        handleNodeClick: handleNodeClick,\n        handleEdgeClick: handleEdgeClick,\n        handleNodeHover: handleNodeHover,\n        handleNodeUnHover: handleNodeUnHover,\n        handleEdgeHover: handleEdgeHover,\n        handleEdgeUnHover: handleEdgeUnHover,\n        handleCanvasClick: handleCanvasClick,\n        graphRef: graphRef\n    };\n    var container = React.useRef(null);\n    useGraph(graph, props, container);\n    useEffect(function () {\n        var graphSize = getGraphSize(width, height, container);\n        if (!graph || graph.destroyed) {\n            if (nodeType === 'icon-node') {\n                customIconNode({ enableEdit: enableEdit });\n            }\n            graph = new G6.TreeGraph({\n                container: container.current,\n                width: graphSize[0],\n                height: graphSize[1],\n                linkCenter: true,\n                modes: {\n                    default: [\n                        'drag-canvas',\n                        'zoom-canvas',\n                    ],\n                },\n                defaultNode: {\n                    type: nodeType,\n                    size: nodeSize,\n                    style: nodeStyle,\n                    labelCfg: nodeLabelCfg\n                },\n                defaultEdge: {\n                    type: edgeType,\n                    style: edgeStyle,\n                    labelCfg: edgeLabelCfg\n                },\n                nodeStateStyles: nodeStateStyles,\n                edgeStateStyles: edgeStateStyles,\n                layout: layout\n            });\n            if (graphRef) {\n                graphRef.current = graph;\n            }\n        }\n        processMinimap(minimapCfg, graph);\n        graph.data(data);\n        graph.render();\n        graph.fitView();\n        if (collapseExpand) {\n            graph.addBehaviors({\n                type: 'collapse-expand',\n                onChange: function onChange(item, collapsed) {\n                    if (!item) {\n                        return false;\n                    }\n                    var data = item.get('model').data;\n                    data.collapsed = collapsed;\n                    return true;\n                },\n            }, 'default');\n        }\n        graph.on('node:mouseenter', function (evt) {\n            var item = evt.item;\n            graph.setItemState(item, 'hover', true);\n            if (handleNodeHover) {\n                handleNodeHover(item, graph);\n            }\n        });\n        graph.on('node:mouseleave', function (evt) {\n            var item = evt.item;\n            graph.setItemState(item, 'hover', false);\n            if (handleNodeUnHover) {\n                handleNodeUnHover(item, graph);\n            }\n        });\n        graph.on('node:click', function (evt) {\n            var item = evt.item, target = evt.target;\n            var targetType = target.get('type');\n            var name = target.get('name');\n            // 增加元素\n            if (targetType === 'marker') {\n                var model = item.getModel();\n                if (name === 'add-item') {\n                    if (!model.children) {\n                        model.children = [];\n                    }\n                    var tmpId = Math.random().toString(36).slice(-8);\n                    model.children.push({\n                        id: tmpId,\n                        label: tmpId\n                    });\n                    graph.updateChild(model, model.id);\n                }\n                else if (name === 'remove-item') {\n                    graph.removeChild(model.id);\n                }\n            }\n            else {\n                if (handleNodeClick) {\n                    handleNodeClick(item, graph);\n                }\n            }\n        });\n        graph.on('edge:mouseenter', function (evt) {\n            var item = evt.item;\n            graph.setItemState(item, 'hover', true);\n            if (handleEdgeHover) {\n                handleEdgeHover(item, graph);\n            }\n        });\n        graph.on('edge:mouseleave', function (evt) {\n            var item = evt.item;\n            graph.setItemState(item, 'hover', false);\n            if (handleEdgeUnHover) {\n                handleEdgeUnHover(item, graph);\n            }\n        });\n        graph.on('edge:click', function (evt) {\n            var item = evt.item;\n            if (handleEdgeClick) {\n                handleEdgeClick(item, graph);\n            }\n        });\n        graph.on('canvas:click', function (evt) {\n            handleCanvasClick && handleCanvasClick(graph);\n        });\n        return function () { return graph.destroy(); };\n    }, []);\n    return (React.createElement(ErrorBoundary, null,\n        React.createElement(\"div\", { className: className, style: style, ref: container })));\n};\nexport default OrganizationTreeGraphComponent;\n"]},"metadata":{},"sourceType":"module"}