{"ast":null,"code":"import _regeneratorRuntime from \"babel-runtime/regenerator\";\nimport _classCallCheck from \"babel-runtime/helpers/classCallCheck\";\nimport _createClass from \"babel-runtime/helpers/createClass\";\nimport _possibleConstructorReturn from \"babel-runtime/helpers/possibleConstructorReturn\";\nimport _inherits from \"babel-runtime/helpers/inherits\";\n\nvar __awaiter = this && this.__awaiter || function (thisArg, _arguments, P, generator) {\n  function adopt(value) {\n    return value instanceof P ? value : new P(function (resolve) {\n      resolve(value);\n    });\n  }\n\n  return new (P || (P = Promise))(function (resolve, reject) {\n    function fulfilled(value) {\n      try {\n        step(generator.next(value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n\n    function rejected(value) {\n      try {\n        step(generator[\"throw\"](value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n\n    function step(result) {\n      result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected);\n    }\n\n    step((generator = generator.apply(thisArg, _arguments || [])).next());\n  });\n};\n\nimport CameraRoll from \"@react-native-community/cameraroll\";\nimport React, { Component } from 'react';\nimport { Platform, StyleSheet, View } from 'react-native';\nimport ListView from '../list-view';\nimport ImageItem from './ImageItem';\nvar styles = StyleSheet.create({\n  wrapper: {\n    flex: 1\n  },\n  row: {\n    flexDirection: 'row',\n    flex: 1\n  },\n  marker: {\n    position: 'absolute',\n    top: 5,\n    backgroundColor: 'transparent'\n  },\n  spinner: {}\n});\n\nvar CameraRollPicker = function (_Component) {\n  _inherits(CameraRollPicker, _Component);\n\n  function CameraRollPicker(props) {\n    _classCallCheck(this, CameraRollPicker);\n\n    var _this = _possibleConstructorReturn(this, (CameraRollPicker.__proto__ || Object.getPrototypeOf(CameraRollPicker)).call(this, props));\n\n    _this.onFetch = function () {\n      var _ = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 1;\n\n      var startFetch = arguments[1];\n      var abortFetch = arguments[2];\n      return __awaiter(_this, void 0, void 0, /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n        var _props, assetType, groupTypes, first, groupName, mimeTypes, params, res, data;\n\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                _context.prev = 0;\n                _props = this.props, assetType = _props.assetType, groupTypes = _props.groupTypes, first = _props.first, groupName = _props.groupName, mimeTypes = _props.mimeTypes;\n                params = {\n                  first: first,\n                  after: this.after,\n                  assetType: assetType,\n                  groupName: groupName,\n                  mimeTypes: mimeTypes\n                };\n\n                if (Platform.OS !== 'android') {\n                  params.groupTypes = groupTypes;\n                }\n\n                _context.next = 6;\n                return CameraRoll.getPhotos(params);\n\n              case 6:\n                res = _context.sent;\n\n                if (res) {\n                  data = res.edges;\n\n                  if (res.page_info) {\n                    this.after = res.page_info.has_next_page ? res.page_info.end_cursor : '';\n                  }\n\n                  startFetch(data, first);\n                }\n\n                _context.next = 14;\n                break;\n\n              case 10:\n                _context.prev = 10;\n                _context.t0 = _context[\"catch\"](0);\n\n                if (__DEV__) {\n                  // tslint:disable-next-line:no-console\n                  console.error(_context.t0);\n                }\n\n                abortFetch();\n              // manually stop the refresh or pagination if it encounters network error\n\n              case 14:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, this, [[0, 10]]);\n      }));\n    };\n\n    _this._renderImage = function (item) {\n      var selected = _this.state.selected;\n      var _this$props = _this.props,\n          imageMargin = _this$props.imageMargin,\n          selectedMarker = _this$props.selectedMarker,\n          imagesPerRow = _this$props.imagesPerRow,\n          containerWidth = _this$props.containerWidth;\n      var uri = item.node.image.uri;\n      var isSelected = _this._arrayObjectIndexOf(selected, 'uri', uri) >= 0 ? true : false;\n      return React.createElement(ImageItem, {\n        key: uri,\n        item: item,\n        selected: isSelected,\n        imageMargin: imageMargin,\n        selectedMarker: selectedMarker,\n        imagesPerRow: imagesPerRow,\n        containerWidth: containerWidth // tslint:disable-next-line:jsx-no-bind\n        ,\n        onPress: _this._selectImage.bind(_this)\n      });\n    };\n\n    _this.state = {\n      images: [],\n      selected: _this.props.selected\n    };\n    return _this;\n  }\n\n  _createClass(CameraRollPicker, [{\n    key: \"UNSAFE_componentWillReceiveProps\",\n    value: function UNSAFE_componentWillReceiveProps(nextProps) {\n      this.setState({\n        selected: nextProps.selected\n      });\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this2 = this;\n\n      var _props2 = this.props,\n          imageMargin = _props2.imageMargin,\n          backgroundColor = _props2.backgroundColor,\n          imagesPerRow = _props2.imagesPerRow;\n      return React.createElement(View, {\n        style: [styles.wrapper, {\n          padding: imageMargin,\n          paddingRight: 0,\n          backgroundColor: backgroundColor\n        }]\n      }, React.createElement(ListView, {\n        onFetch: this.onFetch,\n        refreshable: false,\n        numColumns: imagesPerRow,\n        renderItem: function renderItem(item) {\n          return _this2._renderImage(item);\n        }\n      }));\n    }\n  }, {\n    key: \"_selectImage\",\n    value: function _selectImage(image) {\n      var _props3 = this.props,\n          maximum = _props3.maximum,\n          callback = _props3.callback,\n          selectSingleItem = _props3.selectSingleItem;\n      var selected = this.state.selected;\n\n      var index = this._arrayObjectIndexOf(selected, 'uri', image.uri);\n\n      if (index >= 0) {\n        selected.splice(index, 1);\n      } else {\n        if (selectSingleItem) {\n          selected.splice(0, selected.length);\n        }\n\n        if (selected.length < maximum) {\n          selected.push(image);\n        }\n      }\n\n      this.setState({\n        selected: selected\n      });\n      callback(selected, image);\n    }\n  }, {\n    key: \"_nEveryRow\",\n    value: function _nEveryRow(data, n) {\n      var result = [];\n      var temp = [];\n\n      for (var i = 0; i < data.length; ++i) {\n        if (i > 0 && i % n === 0) {\n          result.push(temp);\n          temp = [];\n        }\n\n        temp.push(data[i]);\n      }\n\n      if (temp.length > 0) {\n        while (temp.length !== n) {\n          temp.push(null);\n        }\n\n        result.push(temp);\n      }\n\n      return result;\n    }\n  }, {\n    key: \"_arrayObjectIndexOf\",\n    value: function _arrayObjectIndexOf(array, property, value) {\n      return array.map(function (o) {\n        return o[property];\n      }).indexOf(value);\n    }\n  }]);\n\n  return CameraRollPicker;\n}(Component);\n\nCameraRollPicker.defaultProps = {\n  groupTypes: 'SavedPhotos',\n  maximum: 15,\n  imagesPerRow: 6,\n  imageMargin: 4,\n  first: 50,\n  selectSingleItem: false,\n  assetType: 'Photos',\n  backgroundColor: 'white',\n  selected: [],\n  callback: function callback(selectedImages, currentImage) {\n    // tslint:disable-next-line:no-console\n    console.log(currentImage); // tslint:disable-next-line:no-console\n\n    console.log(selectedImages);\n  }\n};\nexport default CameraRollPicker;","map":{"version":3,"sources":["/Users/wanglijie/wanglijie/clover-defi-wallet/node_modules/@ant-design/react-native/es/image-picker/CameraRollPicker.js"],"names":["_regeneratorRuntime","_classCallCheck","_createClass","_possibleConstructorReturn","_inherits","__awaiter","thisArg","_arguments","P","generator","adopt","value","resolve","Promise","reject","fulfilled","step","next","e","rejected","result","done","then","apply","CameraRoll","React","Component","Platform","StyleSheet","View","ListView","ImageItem","styles","create","wrapper","flex","row","flexDirection","marker","position","top","backgroundColor","spinner","CameraRollPicker","_Component","props","_this","__proto__","Object","getPrototypeOf","call","onFetch","_","arguments","length","undefined","startFetch","abortFetch","mark","_callee","_props","assetType","groupTypes","first","groupName","mimeTypes","params","res","data","wrap","_callee$","_context","prev","after","OS","getPhotos","sent","edges","page_info","has_next_page","end_cursor","t0","__DEV__","console","error","stop","_renderImage","item","selected","state","_this$props","imageMargin","selectedMarker","imagesPerRow","containerWidth","uri","node","image","isSelected","_arrayObjectIndexOf","createElement","key","onPress","_selectImage","bind","images","UNSAFE_componentWillReceiveProps","nextProps","setState","render","_this2","_props2","style","padding","paddingRight","refreshable","numColumns","renderItem","_props3","maximum","callback","selectSingleItem","index","splice","push","_nEveryRow","n","temp","i","array","property","map","o","indexOf","defaultProps","selectedImages","currentImage","log"],"mappings":"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","sourcesContent":["import _regeneratorRuntime from \"babel-runtime/regenerator\";\nimport _classCallCheck from \"babel-runtime/helpers/classCallCheck\";\nimport _createClass from \"babel-runtime/helpers/createClass\";\nimport _possibleConstructorReturn from \"babel-runtime/helpers/possibleConstructorReturn\";\nimport _inherits from \"babel-runtime/helpers/inherits\";\nvar __awaiter = this && this.__awaiter || function (thisArg, _arguments, P, generator) {\n    function adopt(value) {\n        return value instanceof P ? value : new P(function (resolve) {\n            resolve(value);\n        });\n    }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) {\n            try {\n                step(generator.next(value));\n            } catch (e) {\n                reject(e);\n            }\n        }\n        function rejected(value) {\n            try {\n                step(generator[\"throw\"](value));\n            } catch (e) {\n                reject(e);\n            }\n        }\n        function step(result) {\n            result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected);\n        }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nimport CameraRoll from \"@react-native-community/cameraroll\";\nimport React, { Component } from 'react';\nimport { Platform, StyleSheet, View } from 'react-native';\nimport ListView from '../list-view';\nimport ImageItem from './ImageItem';\nvar styles = StyleSheet.create({\n    wrapper: {\n        flex: 1\n    },\n    row: {\n        flexDirection: 'row',\n        flex: 1\n    },\n    marker: {\n        position: 'absolute',\n        top: 5,\n        backgroundColor: 'transparent'\n    },\n    spinner: {}\n});\n\nvar CameraRollPicker = function (_Component) {\n    _inherits(CameraRollPicker, _Component);\n\n    function CameraRollPicker(props) {\n        _classCallCheck(this, CameraRollPicker);\n\n        var _this = _possibleConstructorReturn(this, (CameraRollPicker.__proto__ || Object.getPrototypeOf(CameraRollPicker)).call(this, props));\n\n        _this.onFetch = function () {\n            var _ = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 1;\n\n            var startFetch = arguments[1];\n            var abortFetch = arguments[2];\n            return __awaiter(_this, void 0, void 0, /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n                var _props, assetType, groupTypes, first, groupName, mimeTypes, params, res, data;\n\n                return _regeneratorRuntime.wrap(function _callee$(_context) {\n                    while (1) {\n                        switch (_context.prev = _context.next) {\n                            case 0:\n                                _context.prev = 0;\n                                _props = this.props, assetType = _props.assetType, groupTypes = _props.groupTypes, first = _props.first, groupName = _props.groupName, mimeTypes = _props.mimeTypes;\n                                params = {\n                                    first: first,\n                                    after: this.after,\n                                    assetType: assetType,\n                                    groupName: groupName,\n                                    mimeTypes: mimeTypes\n                                };\n\n                                if (Platform.OS !== 'android') {\n                                    params.groupTypes = groupTypes;\n                                }\n                                _context.next = 6;\n                                return CameraRoll.getPhotos(params);\n\n                            case 6:\n                                res = _context.sent;\n\n                                if (res) {\n                                    data = res.edges;\n\n                                    if (res.page_info) {\n                                        this.after = res.page_info.has_next_page ? res.page_info.end_cursor : '';\n                                    }\n                                    startFetch(data, first);\n                                }\n                                _context.next = 14;\n                                break;\n\n                            case 10:\n                                _context.prev = 10;\n                                _context.t0 = _context[\"catch\"](0);\n\n                                if (__DEV__) {\n                                    // tslint:disable-next-line:no-console\n                                    console.error(_context.t0);\n                                }\n                                abortFetch(); // manually stop the refresh or pagination if it encounters network error\n\n                            case 14:\n                            case \"end\":\n                                return _context.stop();\n                        }\n                    }\n                }, _callee, this, [[0, 10]]);\n            }));\n        };\n        _this._renderImage = function (item) {\n            var selected = _this.state.selected;\n            var _this$props = _this.props,\n                imageMargin = _this$props.imageMargin,\n                selectedMarker = _this$props.selectedMarker,\n                imagesPerRow = _this$props.imagesPerRow,\n                containerWidth = _this$props.containerWidth;\n\n            var uri = item.node.image.uri;\n            var isSelected = _this._arrayObjectIndexOf(selected, 'uri', uri) >= 0 ? true : false;\n            return React.createElement(ImageItem, { key: uri, item: item, selected: isSelected, imageMargin: imageMargin, selectedMarker: selectedMarker, imagesPerRow: imagesPerRow, containerWidth: containerWidth\n                // tslint:disable-next-line:jsx-no-bind\n                , onPress: _this._selectImage.bind(_this) });\n        };\n        _this.state = {\n            images: [],\n            selected: _this.props.selected\n        };\n        return _this;\n    }\n\n    _createClass(CameraRollPicker, [{\n        key: \"UNSAFE_componentWillReceiveProps\",\n        value: function UNSAFE_componentWillReceiveProps(nextProps) {\n            this.setState({\n                selected: nextProps.selected\n            });\n        }\n    }, {\n        key: \"render\",\n        value: function render() {\n            var _this2 = this;\n\n            var _props2 = this.props,\n                imageMargin = _props2.imageMargin,\n                backgroundColor = _props2.backgroundColor,\n                imagesPerRow = _props2.imagesPerRow;\n\n            return React.createElement(\n                View,\n                { style: [styles.wrapper, {\n                        padding: imageMargin,\n                        paddingRight: 0,\n                        backgroundColor: backgroundColor\n                    }] },\n                React.createElement(ListView, { onFetch: this.onFetch, refreshable: false, numColumns: imagesPerRow, renderItem: function renderItem(item) {\n                        return _this2._renderImage(item);\n                    } })\n            );\n        }\n    }, {\n        key: \"_selectImage\",\n        value: function _selectImage(image) {\n            var _props3 = this.props,\n                maximum = _props3.maximum,\n                callback = _props3.callback,\n                selectSingleItem = _props3.selectSingleItem;\n\n            var selected = this.state.selected;\n            var index = this._arrayObjectIndexOf(selected, 'uri', image.uri);\n            if (index >= 0) {\n                selected.splice(index, 1);\n            } else {\n                if (selectSingleItem) {\n                    selected.splice(0, selected.length);\n                }\n                if (selected.length < maximum) {\n                    selected.push(image);\n                }\n            }\n            this.setState({\n                selected: selected\n            });\n            callback(selected, image);\n        }\n    }, {\n        key: \"_nEveryRow\",\n        value: function _nEveryRow(data, n) {\n            var result = [];\n            var temp = [];\n            for (var i = 0; i < data.length; ++i) {\n                if (i > 0 && i % n === 0) {\n                    result.push(temp);\n                    temp = [];\n                }\n                temp.push(data[i]);\n            }\n            if (temp.length > 0) {\n                while (temp.length !== n) {\n                    temp.push(null);\n                }\n                result.push(temp);\n            }\n            return result;\n        }\n    }, {\n        key: \"_arrayObjectIndexOf\",\n        value: function _arrayObjectIndexOf(array, property, value) {\n            return array.map(function (o) {\n                return o[property];\n            }).indexOf(value);\n        }\n    }]);\n\n    return CameraRollPicker;\n}(Component);\n\nCameraRollPicker.defaultProps = {\n    groupTypes: 'SavedPhotos',\n    maximum: 15,\n    imagesPerRow: 6,\n    imageMargin: 4,\n    first: 50,\n    selectSingleItem: false,\n    assetType: 'Photos',\n    backgroundColor: 'white',\n    selected: [],\n    callback: function callback(selectedImages, currentImage) {\n        // tslint:disable-next-line:no-console\n        console.log(currentImage);\n        // tslint:disable-next-line:no-console\n        console.log(selectedImages);\n    }\n};\nexport default CameraRollPicker;"]},"metadata":{},"sourceType":"module"}