{"ast":null,"code":"\"use strict\";\n\nexports.__esModule = true;\n\nvar tslib_1 = require(\"tslib\");\n\nvar Displayable_1 = require(\"./Displayable\");\n\nvar Element_1 = require(\"../Element\");\n\nvar PathProxy_1 = require(\"../core/PathProxy\");\n\nvar pathContain = require(\"../contain/path\");\n\nvar util_1 = require(\"../core/util\");\n\nvar color_1 = require(\"../tool/color\");\n\nvar config_1 = require(\"../config\");\n\nexports.DEFAULT_PATH_STYLE = util_1.defaults({\n  fill: '#000',\n  stroke: null,\n  strokePercent: 1,\n  fillOpacity: 1,\n  strokeOpacity: 1,\n  lineDashOffset: 0,\n  lineWidth: 1,\n  lineCap: 'butt',\n  miterLimit: 10,\n  strokeNoScale: false,\n  strokeFirst: false\n}, Displayable_1.DEFAULT_COMMON_STYLE);\nexports.DEFAULT_PATH_ANIMATION_PROPS = {\n  style: util_1.defaults({\n    fill: true,\n    stroke: true,\n    strokePercent: true,\n    fillOpacity: true,\n    strokeOpacity: true,\n    lineDashOffset: true,\n    lineWidth: true,\n    miterLimit: true\n  }, Displayable_1.DEFAULT_COMMON_ANIMATION_PROPS.style)\n};\nvar pathCopyParams = ['x', 'y', 'rotation', 'scaleX', 'scaleY', 'originX', 'originY', 'invisible', 'culling', 'z', 'z2', 'zlevel', 'parent'];\n\nvar Path = function (_super) {\n  tslib_1.__extends(Path, _super);\n\n  function Path(opts) {\n    return _super.call(this, opts) || this;\n  }\n\n  Path.prototype.update = function () {\n    var _this = this;\n\n    _super.prototype.update.call(this);\n\n    var style = this.style;\n\n    if (style.decal) {\n      var decalEl = this._decalEl = this._decalEl || new Path();\n\n      if (decalEl.buildPath === Path.prototype.buildPath) {\n        decalEl.buildPath = function (ctx) {\n          _this.buildPath(ctx, _this.shape);\n        };\n      }\n\n      decalEl.silent = true;\n      var decalElStyle = decalEl.style;\n\n      for (var key in style) {\n        if (decalElStyle[key] !== style[key]) {\n          decalElStyle[key] = style[key];\n        }\n      }\n\n      decalElStyle.fill = style.fill ? style.decal : null;\n      decalElStyle.decal = null;\n      decalElStyle.shadowColor = null;\n      style.strokeFirst && (decalElStyle.stroke = null);\n\n      for (var i = 0; i < pathCopyParams.length; ++i) {\n        decalEl[pathCopyParams[i]] = this[pathCopyParams[i]];\n      }\n\n      decalEl.__dirty |= Element_1[\"default\"].REDARAW_BIT;\n    } else if (this._decalEl) {\n      this._decalEl = null;\n    }\n  };\n\n  Path.prototype.getDecalElement = function () {\n    return this._decalEl;\n  };\n\n  Path.prototype._init = function (props) {\n    var keysArr = util_1.keys(props);\n    this.shape = this.getDefaultShape();\n    var defaultStyle = this.getDefaultStyle();\n\n    if (defaultStyle) {\n      this.useStyle(defaultStyle);\n    }\n\n    for (var i = 0; i < keysArr.length; i++) {\n      var key = keysArr[i];\n      var value = props[key];\n\n      if (key === 'style') {\n        if (!this.style) {\n          this.useStyle(value);\n        } else {\n          util_1.extend(this.style, value);\n        }\n      } else if (key === 'shape') {\n        util_1.extend(this.shape, value);\n      } else {\n        _super.prototype.attrKV.call(this, key, value);\n      }\n    }\n\n    if (!this.style) {\n      this.useStyle({});\n    }\n  };\n\n  Path.prototype.getDefaultStyle = function () {\n    return null;\n  };\n\n  Path.prototype.getDefaultShape = function () {\n    return {};\n  };\n\n  Path.prototype.canBeInsideText = function () {\n    return this.hasFill();\n  };\n\n  Path.prototype.getInsideTextFill = function () {\n    var pathFill = this.style.fill;\n\n    if (pathFill !== 'none') {\n      if (util_1.isString(pathFill)) {\n        var fillLum = color_1.lum(pathFill, 0);\n\n        if (fillLum > 0.5) {\n          return config_1.DARK_LABEL_COLOR;\n        } else if (fillLum > 0.2) {\n          return config_1.LIGHTER_LABEL_COLOR;\n        }\n\n        return config_1.LIGHT_LABEL_COLOR;\n      } else if (pathFill) {\n        return config_1.LIGHT_LABEL_COLOR;\n      }\n    }\n\n    return config_1.DARK_LABEL_COLOR;\n  };\n\n  Path.prototype.getInsideTextStroke = function (textFill) {\n    var pathFill = this.style.fill;\n\n    if (util_1.isString(pathFill)) {\n      var zr = this.__zr;\n      var isDarkMode = !!(zr && zr.isDarkMode());\n      var isDarkLabel = color_1.lum(textFill, 0) < config_1.DARK_MODE_THRESHOLD;\n\n      if (isDarkMode === isDarkLabel) {\n        return pathFill;\n      }\n    }\n  };\n\n  Path.prototype.buildPath = function (ctx, shapeCfg, inBundle) {};\n\n  Path.prototype.pathUpdated = function () {\n    this.__dirty &= ~Path.SHAPE_CHANGED_BIT;\n  };\n\n  Path.prototype.createPathProxy = function () {\n    this.path = new PathProxy_1[\"default\"](false);\n  };\n\n  Path.prototype.hasStroke = function () {\n    var style = this.style;\n    var stroke = style.stroke;\n    return !(stroke == null || stroke === 'none' || !(style.lineWidth > 0));\n  };\n\n  Path.prototype.hasFill = function () {\n    var style = this.style;\n    var fill = style.fill;\n    return fill != null && fill !== 'none';\n  };\n\n  Path.prototype.getBoundingRect = function () {\n    var rect = this._rect;\n    var style = this.style;\n    var needsUpdateRect = !rect;\n\n    if (needsUpdateRect) {\n      var firstInvoke = false;\n\n      if (!this.path) {\n        firstInvoke = true;\n        this.createPathProxy();\n      }\n\n      var path = this.path;\n\n      if (firstInvoke || this.__dirty & Path.SHAPE_CHANGED_BIT) {\n        path.beginPath();\n        this.buildPath(path, this.shape, false);\n        this.pathUpdated();\n      }\n\n      rect = path.getBoundingRect();\n    }\n\n    this._rect = rect;\n\n    if (this.hasStroke() && this.path && this.path.len() > 0) {\n      var rectWithStroke = this._rectWithStroke || (this._rectWithStroke = rect.clone());\n\n      if (this.__dirty || needsUpdateRect) {\n        rectWithStroke.copy(rect);\n        var lineScale = style.strokeNoScale ? this.getLineScale() : 1;\n        var w = style.lineWidth;\n\n        if (!this.hasFill()) {\n          var strokeContainThreshold = this.strokeContainThreshold;\n          w = Math.max(w, strokeContainThreshold == null ? 4 : strokeContainThreshold);\n        }\n\n        if (lineScale > 1e-10) {\n          rectWithStroke.width += w / lineScale;\n          rectWithStroke.height += w / lineScale;\n          rectWithStroke.x -= w / lineScale / 2;\n          rectWithStroke.y -= w / lineScale / 2;\n        }\n      }\n\n      return rectWithStroke;\n    }\n\n    return rect;\n  };\n\n  Path.prototype.contain = function (x, y) {\n    var localPos = this.transformCoordToLocal(x, y);\n    var rect = this.getBoundingRect();\n    var style = this.style;\n    x = localPos[0];\n    y = localPos[1];\n\n    if (rect.contain(x, y)) {\n      var pathProxy = this.path;\n\n      if (this.hasStroke()) {\n        var lineWidth = style.lineWidth;\n        var lineScale = style.strokeNoScale ? this.getLineScale() : 1;\n\n        if (lineScale > 1e-10) {\n          if (!this.hasFill()) {\n            lineWidth = Math.max(lineWidth, this.strokeContainThreshold);\n          }\n\n          if (pathContain.containStroke(pathProxy, lineWidth / lineScale, x, y)) {\n            return true;\n          }\n        }\n      }\n\n      if (this.hasFill()) {\n        return pathContain.contain(pathProxy, x, y);\n      }\n    }\n\n    return false;\n  };\n\n  Path.prototype.dirtyShape = function () {\n    this.__dirty |= Path.SHAPE_CHANGED_BIT;\n\n    if (this._rect) {\n      this._rect = null;\n    }\n\n    if (this._decalEl) {\n      this._decalEl.dirtyShape();\n    }\n\n    this.markRedraw();\n  };\n\n  Path.prototype.dirty = function () {\n    this.dirtyStyle();\n    this.dirtyShape();\n  };\n\n  Path.prototype.animateShape = function (loop) {\n    return this.animate('shape', loop);\n  };\n\n  Path.prototype.updateDuringAnimation = function (targetKey) {\n    if (targetKey === 'style') {\n      this.dirtyStyle();\n    } else if (targetKey === 'shape') {\n      this.dirtyShape();\n    } else {\n      this.markRedraw();\n    }\n  };\n\n  Path.prototype.attrKV = function (key, value) {\n    if (key === 'shape') {\n      this.setShape(value);\n    } else {\n      _super.prototype.attrKV.call(this, key, value);\n    }\n  };\n\n  Path.prototype.setShape = function (keyOrObj, value) {\n    var shape = this.shape;\n\n    if (!shape) {\n      shape = this.shape = {};\n    }\n\n    if (typeof keyOrObj === 'string') {\n      shape[keyOrObj] = value;\n    } else {\n      util_1.extend(shape, keyOrObj);\n    }\n\n    this.dirtyShape();\n    return this;\n  };\n\n  Path.prototype.shapeChanged = function () {\n    return !!(this.__dirty & Path.SHAPE_CHANGED_BIT);\n  };\n\n  Path.prototype.createStyle = function (obj) {\n    return util_1.createObject(exports.DEFAULT_PATH_STYLE, obj);\n  };\n\n  Path.prototype._innerSaveToNormal = function (toState) {\n    _super.prototype._innerSaveToNormal.call(this, toState);\n\n    var normalState = this._normalState;\n\n    if (toState.shape && !normalState.shape) {\n      normalState.shape = util_1.extend({}, this.shape);\n    }\n  };\n\n  Path.prototype._applyStateObj = function (stateName, state, normalState, keepCurrentStates, transition, animationCfg) {\n    _super.prototype._applyStateObj.call(this, stateName, state, normalState, keepCurrentStates, transition, animationCfg);\n\n    var needsRestoreToNormal = !(state && keepCurrentStates);\n    var targetShape;\n\n    if (state && state.shape) {\n      if (transition) {\n        if (keepCurrentStates) {\n          targetShape = state.shape;\n        } else {\n          targetShape = util_1.extend({}, normalState.shape);\n          util_1.extend(targetShape, state.shape);\n        }\n      } else {\n        targetShape = util_1.extend({}, keepCurrentStates ? this.shape : normalState.shape);\n        util_1.extend(targetShape, state.shape);\n      }\n    } else if (needsRestoreToNormal) {\n      targetShape = normalState.shape;\n    }\n\n    if (targetShape) {\n      if (transition) {\n        this.shape = util_1.extend({}, this.shape);\n        var targetShapePrimaryProps = {};\n        var shapeKeys = util_1.keys(targetShape);\n\n        for (var i = 0; i < shapeKeys.length; i++) {\n          var key = shapeKeys[i];\n\n          if (typeof targetShape[key] === 'object') {\n            this.shape[key] = targetShape[key];\n          } else {\n            targetShapePrimaryProps[key] = targetShape[key];\n          }\n        }\n\n        this._transitionState(stateName, {\n          shape: targetShapePrimaryProps\n        }, animationCfg);\n      } else {\n        this.shape = targetShape;\n        this.dirtyShape();\n      }\n    }\n  };\n\n  Path.prototype._mergeStates = function (states) {\n    var mergedState = _super.prototype._mergeStates.call(this, states);\n\n    var mergedShape;\n\n    for (var i = 0; i < states.length; i++) {\n      var state = states[i];\n\n      if (state.shape) {\n        mergedShape = mergedShape || {};\n\n        this._mergeStyle(mergedShape, state.shape);\n      }\n    }\n\n    if (mergedShape) {\n      mergedState.shape = mergedShape;\n    }\n\n    return mergedState;\n  };\n\n  Path.prototype.getAnimationStyleProps = function () {\n    return exports.DEFAULT_PATH_ANIMATION_PROPS;\n  };\n\n  Path.prototype.isZeroArea = function () {\n    return false;\n  };\n\n  Path.extend = function (defaultProps) {\n    var Sub = function (_super) {\n      tslib_1.__extends(Sub, _super);\n\n      function Sub(opts) {\n        var _this = _super.call(this, opts) || this;\n\n        defaultProps.init && defaultProps.init.call(_this, opts);\n        return _this;\n      }\n\n      Sub.prototype.getDefaultStyle = function () {\n        return util_1.clone(defaultProps.style);\n      };\n\n      Sub.prototype.getDefaultShape = function () {\n        return util_1.clone(defaultProps.shape);\n      };\n\n      return Sub;\n    }(Path);\n\n    for (var key in defaultProps) {\n      if (typeof defaultProps[key] === 'function') {\n        Sub.prototype[key] = defaultProps[key];\n      }\n    }\n\n    return Sub;\n  };\n\n  Path.SHAPE_CHANGED_BIT = 4;\n\n  Path.initDefaultProps = function () {\n    var pathProto = Path.prototype;\n    pathProto.type = 'path';\n    pathProto.strokeContainThreshold = 5;\n    pathProto.segmentIgnoreThreshold = 0;\n    pathProto.subPixelOptimize = false;\n    pathProto.autoBatch = false;\n    pathProto.__dirty = Element_1[\"default\"].REDARAW_BIT | Displayable_1[\"default\"].STYLE_CHANGED_BIT | Path.SHAPE_CHANGED_BIT;\n  }();\n\n  return Path;\n}(Displayable_1[\"default\"]);\n\nexports[\"default\"] = Path;","map":{"version":3,"sources":["/Users/wanglijie/wanglijie/clover-defi-wallet/node_modules/zrender/lib/graphic/Path.js"],"names":["exports","__esModule","tslib_1","require","Displayable_1","Element_1","PathProxy_1","pathContain","util_1","color_1","config_1","DEFAULT_PATH_STYLE","defaults","fill","stroke","strokePercent","fillOpacity","strokeOpacity","lineDashOffset","lineWidth","lineCap","miterLimit","strokeNoScale","strokeFirst","DEFAULT_COMMON_STYLE","DEFAULT_PATH_ANIMATION_PROPS","style","DEFAULT_COMMON_ANIMATION_PROPS","pathCopyParams","Path","_super","__extends","opts","call","prototype","update","_this","decal","decalEl","_decalEl","buildPath","ctx","shape","silent","decalElStyle","key","shadowColor","i","length","__dirty","REDARAW_BIT","getDecalElement","_init","props","keysArr","keys","getDefaultShape","defaultStyle","getDefaultStyle","useStyle","value","extend","attrKV","canBeInsideText","hasFill","getInsideTextFill","pathFill","isString","fillLum","lum","DARK_LABEL_COLOR","LIGHTER_LABEL_COLOR","LIGHT_LABEL_COLOR","getInsideTextStroke","textFill","zr","__zr","isDarkMode","isDarkLabel","DARK_MODE_THRESHOLD","shapeCfg","inBundle","pathUpdated","SHAPE_CHANGED_BIT","createPathProxy","path","hasStroke","getBoundingRect","rect","_rect","needsUpdateRect","firstInvoke","beginPath","len","rectWithStroke","_rectWithStroke","clone","copy","lineScale","getLineScale","w","strokeContainThreshold","Math","max","width","height","x","y","contain","localPos","transformCoordToLocal","pathProxy","containStroke","dirtyShape","markRedraw","dirty","dirtyStyle","animateShape","loop","animate","updateDuringAnimation","targetKey","setShape","keyOrObj","shapeChanged","createStyle","obj","createObject","_innerSaveToNormal","toState","normalState","_normalState","_applyStateObj","stateName","state","keepCurrentStates","transition","animationCfg","needsRestoreToNormal","targetShape","targetShapePrimaryProps","shapeKeys","_transitionState","_mergeStates","states","mergedState","mergedShape","_mergeStyle","getAnimationStyleProps","isZeroArea","defaultProps","Sub","init","initDefaultProps","pathProto","type","segmentIgnoreThreshold","subPixelOptimize","autoBatch","STYLE_CHANGED_BIT"],"mappings":"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","sourcesContent":["\"use strict\";\nexports.__esModule = true;\nvar tslib_1 = require(\"tslib\");\nvar Displayable_1 = require(\"./Displayable\");\nvar Element_1 = require(\"../Element\");\nvar PathProxy_1 = require(\"../core/PathProxy\");\nvar pathContain = require(\"../contain/path\");\nvar util_1 = require(\"../core/util\");\nvar color_1 = require(\"../tool/color\");\nvar config_1 = require(\"../config\");\nexports.DEFAULT_PATH_STYLE = util_1.defaults({\n    fill: '#000',\n    stroke: null,\n    strokePercent: 1,\n    fillOpacity: 1,\n    strokeOpacity: 1,\n    lineDashOffset: 0,\n    lineWidth: 1,\n    lineCap: 'butt',\n    miterLimit: 10,\n    strokeNoScale: false,\n    strokeFirst: false\n}, Displayable_1.DEFAULT_COMMON_STYLE);\nexports.DEFAULT_PATH_ANIMATION_PROPS = {\n    style: util_1.defaults({\n        fill: true,\n        stroke: true,\n        strokePercent: true,\n        fillOpacity: true,\n        strokeOpacity: true,\n        lineDashOffset: true,\n        lineWidth: true,\n        miterLimit: true\n    }, Displayable_1.DEFAULT_COMMON_ANIMATION_PROPS.style)\n};\nvar pathCopyParams = [\n    'x', 'y', 'rotation', 'scaleX', 'scaleY', 'originX', 'originY', 'invisible',\n    'culling', 'z', 'z2', 'zlevel', 'parent'\n];\nvar Path = (function (_super) {\n    tslib_1.__extends(Path, _super);\n    function Path(opts) {\n        return _super.call(this, opts) || this;\n    }\n    Path.prototype.update = function () {\n        var _this = this;\n        _super.prototype.update.call(this);\n        var style = this.style;\n        if (style.decal) {\n            var decalEl = this._decalEl\n                = this._decalEl || new Path();\n            if (decalEl.buildPath === Path.prototype.buildPath) {\n                decalEl.buildPath = function (ctx) {\n                    _this.buildPath(ctx, _this.shape);\n                };\n            }\n            decalEl.silent = true;\n            var decalElStyle = decalEl.style;\n            for (var key in style) {\n                if (decalElStyle[key] !== style[key]) {\n                    decalElStyle[key] = style[key];\n                }\n            }\n            decalElStyle.fill = style.fill ? style.decal : null;\n            decalElStyle.decal = null;\n            decalElStyle.shadowColor = null;\n            style.strokeFirst && (decalElStyle.stroke = null);\n            for (var i = 0; i < pathCopyParams.length; ++i) {\n                decalEl[pathCopyParams[i]] = this[pathCopyParams[i]];\n            }\n            decalEl.__dirty |= Element_1[\"default\"].REDARAW_BIT;\n        }\n        else if (this._decalEl) {\n            this._decalEl = null;\n        }\n    };\n    Path.prototype.getDecalElement = function () {\n        return this._decalEl;\n    };\n    Path.prototype._init = function (props) {\n        var keysArr = util_1.keys(props);\n        this.shape = this.getDefaultShape();\n        var defaultStyle = this.getDefaultStyle();\n        if (defaultStyle) {\n            this.useStyle(defaultStyle);\n        }\n        for (var i = 0; i < keysArr.length; i++) {\n            var key = keysArr[i];\n            var value = props[key];\n            if (key === 'style') {\n                if (!this.style) {\n                    this.useStyle(value);\n                }\n                else {\n                    util_1.extend(this.style, value);\n                }\n            }\n            else if (key === 'shape') {\n                util_1.extend(this.shape, value);\n            }\n            else {\n                _super.prototype.attrKV.call(this, key, value);\n            }\n        }\n        if (!this.style) {\n            this.useStyle({});\n        }\n    };\n    Path.prototype.getDefaultStyle = function () {\n        return null;\n    };\n    Path.prototype.getDefaultShape = function () {\n        return {};\n    };\n    Path.prototype.canBeInsideText = function () {\n        return this.hasFill();\n    };\n    Path.prototype.getInsideTextFill = function () {\n        var pathFill = this.style.fill;\n        if (pathFill !== 'none') {\n            if (util_1.isString(pathFill)) {\n                var fillLum = color_1.lum(pathFill, 0);\n                if (fillLum > 0.5) {\n                    return config_1.DARK_LABEL_COLOR;\n                }\n                else if (fillLum > 0.2) {\n                    return config_1.LIGHTER_LABEL_COLOR;\n                }\n                return config_1.LIGHT_LABEL_COLOR;\n            }\n            else if (pathFill) {\n                return config_1.LIGHT_LABEL_COLOR;\n            }\n        }\n        return config_1.DARK_LABEL_COLOR;\n    };\n    Path.prototype.getInsideTextStroke = function (textFill) {\n        var pathFill = this.style.fill;\n        if (util_1.isString(pathFill)) {\n            var zr = this.__zr;\n            var isDarkMode = !!(zr && zr.isDarkMode());\n            var isDarkLabel = color_1.lum(textFill, 0) < config_1.DARK_MODE_THRESHOLD;\n            if (isDarkMode === isDarkLabel) {\n                return pathFill;\n            }\n        }\n    };\n    Path.prototype.buildPath = function (ctx, shapeCfg, inBundle) { };\n    Path.prototype.pathUpdated = function () {\n        this.__dirty &= ~Path.SHAPE_CHANGED_BIT;\n    };\n    Path.prototype.createPathProxy = function () {\n        this.path = new PathProxy_1[\"default\"](false);\n    };\n    Path.prototype.hasStroke = function () {\n        var style = this.style;\n        var stroke = style.stroke;\n        return !(stroke == null || stroke === 'none' || !(style.lineWidth > 0));\n    };\n    Path.prototype.hasFill = function () {\n        var style = this.style;\n        var fill = style.fill;\n        return fill != null && fill !== 'none';\n    };\n    Path.prototype.getBoundingRect = function () {\n        var rect = this._rect;\n        var style = this.style;\n        var needsUpdateRect = !rect;\n        if (needsUpdateRect) {\n            var firstInvoke = false;\n            if (!this.path) {\n                firstInvoke = true;\n                this.createPathProxy();\n            }\n            var path = this.path;\n            if (firstInvoke || (this.__dirty & Path.SHAPE_CHANGED_BIT)) {\n                path.beginPath();\n                this.buildPath(path, this.shape, false);\n                this.pathUpdated();\n            }\n            rect = path.getBoundingRect();\n        }\n        this._rect = rect;\n        if (this.hasStroke() && this.path && this.path.len() > 0) {\n            var rectWithStroke = this._rectWithStroke || (this._rectWithStroke = rect.clone());\n            if (this.__dirty || needsUpdateRect) {\n                rectWithStroke.copy(rect);\n                var lineScale = style.strokeNoScale ? this.getLineScale() : 1;\n                var w = style.lineWidth;\n                if (!this.hasFill()) {\n                    var strokeContainThreshold = this.strokeContainThreshold;\n                    w = Math.max(w, strokeContainThreshold == null ? 4 : strokeContainThreshold);\n                }\n                if (lineScale > 1e-10) {\n                    rectWithStroke.width += w / lineScale;\n                    rectWithStroke.height += w / lineScale;\n                    rectWithStroke.x -= w / lineScale / 2;\n                    rectWithStroke.y -= w / lineScale / 2;\n                }\n            }\n            return rectWithStroke;\n        }\n        return rect;\n    };\n    Path.prototype.contain = function (x, y) {\n        var localPos = this.transformCoordToLocal(x, y);\n        var rect = this.getBoundingRect();\n        var style = this.style;\n        x = localPos[0];\n        y = localPos[1];\n        if (rect.contain(x, y)) {\n            var pathProxy = this.path;\n            if (this.hasStroke()) {\n                var lineWidth = style.lineWidth;\n                var lineScale = style.strokeNoScale ? this.getLineScale() : 1;\n                if (lineScale > 1e-10) {\n                    if (!this.hasFill()) {\n                        lineWidth = Math.max(lineWidth, this.strokeContainThreshold);\n                    }\n                    if (pathContain.containStroke(pathProxy, lineWidth / lineScale, x, y)) {\n                        return true;\n                    }\n                }\n            }\n            if (this.hasFill()) {\n                return pathContain.contain(pathProxy, x, y);\n            }\n        }\n        return false;\n    };\n    Path.prototype.dirtyShape = function () {\n        this.__dirty |= Path.SHAPE_CHANGED_BIT;\n        if (this._rect) {\n            this._rect = null;\n        }\n        if (this._decalEl) {\n            this._decalEl.dirtyShape();\n        }\n        this.markRedraw();\n    };\n    Path.prototype.dirty = function () {\n        this.dirtyStyle();\n        this.dirtyShape();\n    };\n    Path.prototype.animateShape = function (loop) {\n        return this.animate('shape', loop);\n    };\n    Path.prototype.updateDuringAnimation = function (targetKey) {\n        if (targetKey === 'style') {\n            this.dirtyStyle();\n        }\n        else if (targetKey === 'shape') {\n            this.dirtyShape();\n        }\n        else {\n            this.markRedraw();\n        }\n    };\n    Path.prototype.attrKV = function (key, value) {\n        if (key === 'shape') {\n            this.setShape(value);\n        }\n        else {\n            _super.prototype.attrKV.call(this, key, value);\n        }\n    };\n    Path.prototype.setShape = function (keyOrObj, value) {\n        var shape = this.shape;\n        if (!shape) {\n            shape = this.shape = {};\n        }\n        if (typeof keyOrObj === 'string') {\n            shape[keyOrObj] = value;\n        }\n        else {\n            util_1.extend(shape, keyOrObj);\n        }\n        this.dirtyShape();\n        return this;\n    };\n    Path.prototype.shapeChanged = function () {\n        return !!(this.__dirty & Path.SHAPE_CHANGED_BIT);\n    };\n    Path.prototype.createStyle = function (obj) {\n        return util_1.createObject(exports.DEFAULT_PATH_STYLE, obj);\n    };\n    Path.prototype._innerSaveToNormal = function (toState) {\n        _super.prototype._innerSaveToNormal.call(this, toState);\n        var normalState = this._normalState;\n        if (toState.shape && !normalState.shape) {\n            normalState.shape = util_1.extend({}, this.shape);\n        }\n    };\n    Path.prototype._applyStateObj = function (stateName, state, normalState, keepCurrentStates, transition, animationCfg) {\n        _super.prototype._applyStateObj.call(this, stateName, state, normalState, keepCurrentStates, transition, animationCfg);\n        var needsRestoreToNormal = !(state && keepCurrentStates);\n        var targetShape;\n        if (state && state.shape) {\n            if (transition) {\n                if (keepCurrentStates) {\n                    targetShape = state.shape;\n                }\n                else {\n                    targetShape = util_1.extend({}, normalState.shape);\n                    util_1.extend(targetShape, state.shape);\n                }\n            }\n            else {\n                targetShape = util_1.extend({}, keepCurrentStates ? this.shape : normalState.shape);\n                util_1.extend(targetShape, state.shape);\n            }\n        }\n        else if (needsRestoreToNormal) {\n            targetShape = normalState.shape;\n        }\n        if (targetShape) {\n            if (transition) {\n                this.shape = util_1.extend({}, this.shape);\n                var targetShapePrimaryProps = {};\n                var shapeKeys = util_1.keys(targetShape);\n                for (var i = 0; i < shapeKeys.length; i++) {\n                    var key = shapeKeys[i];\n                    if (typeof targetShape[key] === 'object') {\n                        this.shape[key] = targetShape[key];\n                    }\n                    else {\n                        targetShapePrimaryProps[key] = targetShape[key];\n                    }\n                }\n                this._transitionState(stateName, {\n                    shape: targetShapePrimaryProps\n                }, animationCfg);\n            }\n            else {\n                this.shape = targetShape;\n                this.dirtyShape();\n            }\n        }\n    };\n    Path.prototype._mergeStates = function (states) {\n        var mergedState = _super.prototype._mergeStates.call(this, states);\n        var mergedShape;\n        for (var i = 0; i < states.length; i++) {\n            var state = states[i];\n            if (state.shape) {\n                mergedShape = mergedShape || {};\n                this._mergeStyle(mergedShape, state.shape);\n            }\n        }\n        if (mergedShape) {\n            mergedState.shape = mergedShape;\n        }\n        return mergedState;\n    };\n    Path.prototype.getAnimationStyleProps = function () {\n        return exports.DEFAULT_PATH_ANIMATION_PROPS;\n    };\n    Path.prototype.isZeroArea = function () {\n        return false;\n    };\n    Path.extend = function (defaultProps) {\n        var Sub = (function (_super) {\n            tslib_1.__extends(Sub, _super);\n            function Sub(opts) {\n                var _this = _super.call(this, opts) || this;\n                defaultProps.init && defaultProps.init.call(_this, opts);\n                return _this;\n            }\n            Sub.prototype.getDefaultStyle = function () {\n                return util_1.clone(defaultProps.style);\n            };\n            Sub.prototype.getDefaultShape = function () {\n                return util_1.clone(defaultProps.shape);\n            };\n            return Sub;\n        }(Path));\n        for (var key in defaultProps) {\n            if (typeof defaultProps[key] === 'function') {\n                Sub.prototype[key] = defaultProps[key];\n            }\n        }\n        return Sub;\n    };\n    Path.SHAPE_CHANGED_BIT = 4;\n    Path.initDefaultProps = (function () {\n        var pathProto = Path.prototype;\n        pathProto.type = 'path';\n        pathProto.strokeContainThreshold = 5;\n        pathProto.segmentIgnoreThreshold = 0;\n        pathProto.subPixelOptimize = false;\n        pathProto.autoBatch = false;\n        pathProto.__dirty = Element_1[\"default\"].REDARAW_BIT | Displayable_1[\"default\"].STYLE_CHANGED_BIT | Path.SHAPE_CHANGED_BIT;\n    })();\n    return Path;\n}(Displayable_1[\"default\"]));\nexports[\"default\"] = Path;\n"]},"metadata":{},"sourceType":"script"}