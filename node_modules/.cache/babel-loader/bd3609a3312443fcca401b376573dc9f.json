{"ast":null,"code":"\"use strict\";\n\nexports.__esModule = true;\n\nvar tslib_1 = require(\"tslib\");\n\nvar Element_1 = require(\"../Element\");\n\nvar BoundingRect_1 = require(\"../core/BoundingRect\");\n\nvar util_1 = require(\"../core/util\");\n\nvar STYLE_MAGIC_KEY = '__zr_style_' + Math.round(Math.random() * 10);\nexports.DEFAULT_COMMON_STYLE = {\n  shadowBlur: 0,\n  shadowOffsetX: 0,\n  shadowOffsetY: 0,\n  shadowColor: '#000',\n  opacity: 1,\n  blend: 'source-over'\n};\nexports.DEFAULT_COMMON_ANIMATION_PROPS = {\n  style: {\n    shadowBlur: true,\n    shadowOffsetX: true,\n    shadowOffsetY: true,\n    shadowColor: true,\n    opacity: true\n  }\n};\nexports.DEFAULT_COMMON_STYLE[STYLE_MAGIC_KEY] = true;\nvar PRIMARY_STATES_KEYS = ['z', 'z2', 'invisible'];\n\nvar Displayable = function (_super) {\n  tslib_1.__extends(Displayable, _super);\n\n  function Displayable(props) {\n    return _super.call(this, props) || this;\n  }\n\n  Displayable.prototype._init = function (props) {\n    var keysArr = util_1.keys(props);\n\n    for (var i = 0; i < keysArr.length; i++) {\n      var key = keysArr[i];\n\n      if (key === 'style') {\n        this.useStyle(props[key]);\n      } else {\n        _super.prototype.attrKV.call(this, key, props[key]);\n      }\n    }\n\n    if (!this.style) {\n      this.useStyle({});\n    }\n  };\n\n  Displayable.prototype.beforeBrush = function () {};\n\n  Displayable.prototype.afterBrush = function () {};\n\n  Displayable.prototype.innerBeforeBrush = function () {};\n\n  Displayable.prototype.innerAfterBrush = function () {};\n\n  Displayable.prototype.shouldBePainted = function (viewWidth, viewHeight, considerClipPath, considerAncestors) {\n    var m = this.transform;\n\n    if (this.ignore || this.invisible || this.style.opacity === 0 || this.culling && isDisplayableCulled(this, viewWidth, viewHeight) || m && !m[0] && !m[3]) {\n      return false;\n    }\n\n    if (considerClipPath && this.__clipPaths) {\n      for (var i = 0; i < this.__clipPaths.length; ++i) {\n        if (this.__clipPaths[i].isZeroArea()) {\n          return false;\n        }\n      }\n    }\n\n    if (considerAncestors && this.parent) {\n      var parent_1 = this.parent;\n\n      while (parent_1) {\n        if (parent_1.ignore) {\n          return false;\n        }\n\n        parent_1 = parent_1.parent;\n      }\n    }\n\n    return true;\n  };\n\n  Displayable.prototype.contain = function (x, y) {\n    return this.rectContain(x, y);\n  };\n\n  Displayable.prototype.traverse = function (cb, context) {\n    cb.call(context, this);\n  };\n\n  Displayable.prototype.rectContain = function (x, y) {\n    var coord = this.transformCoordToLocal(x, y);\n    var rect = this.getBoundingRect();\n    return rect.contain(coord[0], coord[1]);\n  };\n\n  Displayable.prototype.getPaintRect = function () {\n    var rect = this._paintRect;\n\n    if (!this._paintRect || this.__dirty) {\n      var transform = this.transform;\n      var elRect = this.getBoundingRect();\n      var style = this.style;\n      var shadowSize = style.shadowBlur || 0;\n      var shadowOffsetX = style.shadowOffsetX || 0;\n      var shadowOffsetY = style.shadowOffsetY || 0;\n      rect = this._paintRect || (this._paintRect = new BoundingRect_1[\"default\"](0, 0, 0, 0));\n\n      if (transform) {\n        BoundingRect_1[\"default\"].applyTransform(rect, elRect, transform);\n      } else {\n        rect.copy(elRect);\n      }\n\n      if (shadowSize || shadowOffsetX || shadowOffsetY) {\n        rect.width += shadowSize * 2 + Math.abs(shadowOffsetX);\n        rect.height += shadowSize * 2 + Math.abs(shadowOffsetY);\n        rect.x = Math.min(rect.x, rect.x + shadowOffsetX - shadowSize);\n        rect.y = Math.min(rect.y, rect.y + shadowOffsetY - shadowSize);\n      }\n\n      var tolerance = this.dirtyRectTolerance;\n\n      if (!rect.isZero()) {\n        rect.x = Math.floor(rect.x - tolerance);\n        rect.y = Math.floor(rect.y - tolerance);\n        rect.width = Math.ceil(rect.width + 1 + tolerance * 2);\n        rect.height = Math.ceil(rect.height + 1 + tolerance * 2);\n      }\n    }\n\n    return rect;\n  };\n\n  Displayable.prototype.setPrevPaintRect = function (paintRect) {\n    if (paintRect) {\n      this._prevPaintRect = this._prevPaintRect || new BoundingRect_1[\"default\"](0, 0, 0, 0);\n\n      this._prevPaintRect.copy(paintRect);\n    } else {\n      this._prevPaintRect = null;\n    }\n  };\n\n  Displayable.prototype.getPrevPaintRect = function () {\n    return this._prevPaintRect;\n  };\n\n  Displayable.prototype.animateStyle = function (loop) {\n    return this.animate('style', loop);\n  };\n\n  Displayable.prototype.updateDuringAnimation = function (targetKey) {\n    if (targetKey === 'style') {\n      this.dirtyStyle();\n    } else {\n      this.markRedraw();\n    }\n  };\n\n  Displayable.prototype.attrKV = function (key, value) {\n    if (key !== 'style') {\n      _super.prototype.attrKV.call(this, key, value);\n    } else {\n      if (!this.style) {\n        this.useStyle(value);\n      } else {\n        this.setStyle(value);\n      }\n    }\n  };\n\n  Displayable.prototype.setStyle = function (keyOrObj, value) {\n    if (typeof keyOrObj === 'string') {\n      this.style[keyOrObj] = value;\n    } else {\n      util_1.extend(this.style, keyOrObj);\n    }\n\n    this.dirtyStyle();\n    return this;\n  };\n\n  Displayable.prototype.dirtyStyle = function () {\n    this.markRedraw();\n    this.__dirty |= Displayable.STYLE_CHANGED_BIT;\n\n    if (this._rect) {\n      this._rect = null;\n    }\n  };\n\n  Displayable.prototype.dirty = function () {\n    this.dirtyStyle();\n  };\n\n  Displayable.prototype.styleChanged = function () {\n    return !!(this.__dirty & Displayable.STYLE_CHANGED_BIT);\n  };\n\n  Displayable.prototype.styleUpdated = function () {\n    this.__dirty &= ~Displayable.STYLE_CHANGED_BIT;\n  };\n\n  Displayable.prototype.createStyle = function (obj) {\n    return util_1.createObject(exports.DEFAULT_COMMON_STYLE, obj);\n  };\n\n  Displayable.prototype.useStyle = function (obj) {\n    if (!obj[STYLE_MAGIC_KEY]) {\n      obj = this.createStyle(obj);\n    }\n\n    if (this.__inHover) {\n      this.__hoverStyle = obj;\n    } else {\n      this.style = obj;\n    }\n\n    this.dirtyStyle();\n  };\n\n  Displayable.prototype.isStyleObject = function (obj) {\n    return obj[STYLE_MAGIC_KEY];\n  };\n\n  Displayable.prototype._innerSaveToNormal = function (toState) {\n    _super.prototype._innerSaveToNormal.call(this, toState);\n\n    var normalState = this._normalState;\n\n    if (toState.style && !normalState.style) {\n      normalState.style = this._mergeStyle(this.createStyle(), this.style);\n    }\n\n    this._savePrimaryToNormal(toState, normalState, PRIMARY_STATES_KEYS);\n  };\n\n  Displayable.prototype._applyStateObj = function (stateName, state, normalState, keepCurrentStates, transition, animationCfg) {\n    _super.prototype._applyStateObj.call(this, stateName, state, normalState, keepCurrentStates, transition, animationCfg);\n\n    var needsRestoreToNormal = !(state && keepCurrentStates);\n    var targetStyle;\n\n    if (state && state.style) {\n      if (transition) {\n        if (keepCurrentStates) {\n          targetStyle = state.style;\n        } else {\n          targetStyle = this._mergeStyle(this.createStyle(), normalState.style);\n\n          this._mergeStyle(targetStyle, state.style);\n        }\n      } else {\n        targetStyle = this._mergeStyle(this.createStyle(), keepCurrentStates ? this.style : normalState.style);\n\n        this._mergeStyle(targetStyle, state.style);\n      }\n    } else if (needsRestoreToNormal) {\n      targetStyle = normalState.style;\n    }\n\n    if (targetStyle) {\n      if (transition) {\n        var sourceStyle = this.style;\n        this.style = this.createStyle(needsRestoreToNormal ? {} : sourceStyle);\n\n        if (needsRestoreToNormal) {\n          var changedKeys = util_1.keys(sourceStyle);\n\n          for (var i = 0; i < changedKeys.length; i++) {\n            var key = changedKeys[i];\n\n            if (key in targetStyle) {\n              targetStyle[key] = targetStyle[key];\n              this.style[key] = sourceStyle[key];\n            }\n          }\n        }\n\n        var targetKeys = util_1.keys(targetStyle);\n\n        for (var i = 0; i < targetKeys.length; i++) {\n          var key = targetKeys[i];\n          this.style[key] = this.style[key];\n        }\n\n        this._transitionState(stateName, {\n          style: targetStyle\n        }, animationCfg, this.getAnimationStyleProps());\n      } else {\n        this.useStyle(targetStyle);\n      }\n    }\n\n    for (var i = 0; i < PRIMARY_STATES_KEYS.length; i++) {\n      var key = PRIMARY_STATES_KEYS[i];\n\n      if (state && state[key] != null) {\n        this[key] = state[key];\n      } else if (needsRestoreToNormal) {\n        if (normalState[key] != null) {\n          this[key] = normalState[key];\n        }\n      }\n    }\n  };\n\n  Displayable.prototype._mergeStates = function (states) {\n    var mergedState = _super.prototype._mergeStates.call(this, states);\n\n    var mergedStyle;\n\n    for (var i = 0; i < states.length; i++) {\n      var state = states[i];\n\n      if (state.style) {\n        mergedStyle = mergedStyle || {};\n\n        this._mergeStyle(mergedStyle, state.style);\n      }\n    }\n\n    if (mergedStyle) {\n      mergedState.style = mergedStyle;\n    }\n\n    return mergedState;\n  };\n\n  Displayable.prototype._mergeStyle = function (targetStyle, sourceStyle) {\n    util_1.extend(targetStyle, sourceStyle);\n    return targetStyle;\n  };\n\n  Displayable.prototype.getAnimationStyleProps = function () {\n    return exports.DEFAULT_COMMON_ANIMATION_PROPS;\n  };\n\n  Displayable.STYLE_CHANGED_BIT = 2;\n\n  Displayable.initDefaultProps = function () {\n    var dispProto = Displayable.prototype;\n    dispProto.type = 'displayable';\n    dispProto.invisible = false;\n    dispProto.z = 0;\n    dispProto.z2 = 0;\n    dispProto.zlevel = 0;\n    dispProto.culling = false;\n    dispProto.cursor = 'pointer';\n    dispProto.rectHover = false;\n    dispProto.incremental = false;\n    dispProto._rect = null;\n    dispProto.dirtyRectTolerance = 0;\n    dispProto.__dirty = Element_1[\"default\"].REDARAW_BIT | Displayable.STYLE_CHANGED_BIT;\n  }();\n\n  return Displayable;\n}(Element_1[\"default\"]);\n\nvar tmpRect = new BoundingRect_1[\"default\"](0, 0, 0, 0);\nvar viewRect = new BoundingRect_1[\"default\"](0, 0, 0, 0);\n\nfunction isDisplayableCulled(el, width, height) {\n  tmpRect.copy(el.getBoundingRect());\n\n  if (el.transform) {\n    tmpRect.applyTransform(el.transform);\n  }\n\n  viewRect.width = width;\n  viewRect.height = height;\n  return !tmpRect.intersect(viewRect);\n}\n\nexports[\"default\"] = Displayable;","map":{"version":3,"sources":["/Users/wanglijie/wanglijie/clover-defi-wallet/node_modules/zrender/lib/graphic/Displayable.js"],"names":["exports","__esModule","tslib_1","require","Element_1","BoundingRect_1","util_1","STYLE_MAGIC_KEY","Math","round","random","DEFAULT_COMMON_STYLE","shadowBlur","shadowOffsetX","shadowOffsetY","shadowColor","opacity","blend","DEFAULT_COMMON_ANIMATION_PROPS","style","PRIMARY_STATES_KEYS","Displayable","_super","__extends","props","call","prototype","_init","keysArr","keys","i","length","key","useStyle","attrKV","beforeBrush","afterBrush","innerBeforeBrush","innerAfterBrush","shouldBePainted","viewWidth","viewHeight","considerClipPath","considerAncestors","m","transform","ignore","invisible","culling","isDisplayableCulled","__clipPaths","isZeroArea","parent","parent_1","contain","x","y","rectContain","traverse","cb","context","coord","transformCoordToLocal","rect","getBoundingRect","getPaintRect","_paintRect","__dirty","elRect","shadowSize","applyTransform","copy","width","abs","height","min","tolerance","dirtyRectTolerance","isZero","floor","ceil","setPrevPaintRect","paintRect","_prevPaintRect","getPrevPaintRect","animateStyle","loop","animate","updateDuringAnimation","targetKey","dirtyStyle","markRedraw","value","setStyle","keyOrObj","extend","STYLE_CHANGED_BIT","_rect","dirty","styleChanged","styleUpdated","createStyle","obj","createObject","__inHover","__hoverStyle","isStyleObject","_innerSaveToNormal","toState","normalState","_normalState","_mergeStyle","_savePrimaryToNormal","_applyStateObj","stateName","state","keepCurrentStates","transition","animationCfg","needsRestoreToNormal","targetStyle","sourceStyle","changedKeys","targetKeys","_transitionState","getAnimationStyleProps","_mergeStates","states","mergedState","mergedStyle","initDefaultProps","dispProto","type","z","z2","zlevel","cursor","rectHover","incremental","REDARAW_BIT","tmpRect","viewRect","el","intersect"],"mappings":"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","sourcesContent":["\"use strict\";\nexports.__esModule = true;\nvar tslib_1 = require(\"tslib\");\nvar Element_1 = require(\"../Element\");\nvar BoundingRect_1 = require(\"../core/BoundingRect\");\nvar util_1 = require(\"../core/util\");\nvar STYLE_MAGIC_KEY = '__zr_style_' + Math.round((Math.random() * 10));\nexports.DEFAULT_COMMON_STYLE = {\n    shadowBlur: 0,\n    shadowOffsetX: 0,\n    shadowOffsetY: 0,\n    shadowColor: '#000',\n    opacity: 1,\n    blend: 'source-over'\n};\nexports.DEFAULT_COMMON_ANIMATION_PROPS = {\n    style: {\n        shadowBlur: true,\n        shadowOffsetX: true,\n        shadowOffsetY: true,\n        shadowColor: true,\n        opacity: true\n    }\n};\nexports.DEFAULT_COMMON_STYLE[STYLE_MAGIC_KEY] = true;\nvar PRIMARY_STATES_KEYS = ['z', 'z2', 'invisible'];\nvar Displayable = (function (_super) {\n    tslib_1.__extends(Displayable, _super);\n    function Displayable(props) {\n        return _super.call(this, props) || this;\n    }\n    Displayable.prototype._init = function (props) {\n        var keysArr = util_1.keys(props);\n        for (var i = 0; i < keysArr.length; i++) {\n            var key = keysArr[i];\n            if (key === 'style') {\n                this.useStyle(props[key]);\n            }\n            else {\n                _super.prototype.attrKV.call(this, key, props[key]);\n            }\n        }\n        if (!this.style) {\n            this.useStyle({});\n        }\n    };\n    Displayable.prototype.beforeBrush = function () { };\n    Displayable.prototype.afterBrush = function () { };\n    Displayable.prototype.innerBeforeBrush = function () { };\n    Displayable.prototype.innerAfterBrush = function () { };\n    Displayable.prototype.shouldBePainted = function (viewWidth, viewHeight, considerClipPath, considerAncestors) {\n        var m = this.transform;\n        if (this.ignore\n            || this.invisible\n            || this.style.opacity === 0\n            || (this.culling\n                && isDisplayableCulled(this, viewWidth, viewHeight))\n            || (m && !m[0] && !m[3])) {\n            return false;\n        }\n        if (considerClipPath && this.__clipPaths) {\n            for (var i = 0; i < this.__clipPaths.length; ++i) {\n                if (this.__clipPaths[i].isZeroArea()) {\n                    return false;\n                }\n            }\n        }\n        if (considerAncestors && this.parent) {\n            var parent_1 = this.parent;\n            while (parent_1) {\n                if (parent_1.ignore) {\n                    return false;\n                }\n                parent_1 = parent_1.parent;\n            }\n        }\n        return true;\n    };\n    Displayable.prototype.contain = function (x, y) {\n        return this.rectContain(x, y);\n    };\n    Displayable.prototype.traverse = function (cb, context) {\n        cb.call(context, this);\n    };\n    Displayable.prototype.rectContain = function (x, y) {\n        var coord = this.transformCoordToLocal(x, y);\n        var rect = this.getBoundingRect();\n        return rect.contain(coord[0], coord[1]);\n    };\n    Displayable.prototype.getPaintRect = function () {\n        var rect = this._paintRect;\n        if (!this._paintRect || this.__dirty) {\n            var transform = this.transform;\n            var elRect = this.getBoundingRect();\n            var style = this.style;\n            var shadowSize = style.shadowBlur || 0;\n            var shadowOffsetX = style.shadowOffsetX || 0;\n            var shadowOffsetY = style.shadowOffsetY || 0;\n            rect = this._paintRect || (this._paintRect = new BoundingRect_1[\"default\"](0, 0, 0, 0));\n            if (transform) {\n                BoundingRect_1[\"default\"].applyTransform(rect, elRect, transform);\n            }\n            else {\n                rect.copy(elRect);\n            }\n            if (shadowSize || shadowOffsetX || shadowOffsetY) {\n                rect.width += shadowSize * 2 + Math.abs(shadowOffsetX);\n                rect.height += shadowSize * 2 + Math.abs(shadowOffsetY);\n                rect.x = Math.min(rect.x, rect.x + shadowOffsetX - shadowSize);\n                rect.y = Math.min(rect.y, rect.y + shadowOffsetY - shadowSize);\n            }\n            var tolerance = this.dirtyRectTolerance;\n            if (!rect.isZero()) {\n                rect.x = Math.floor(rect.x - tolerance);\n                rect.y = Math.floor(rect.y - tolerance);\n                rect.width = Math.ceil(rect.width + 1 + tolerance * 2);\n                rect.height = Math.ceil(rect.height + 1 + tolerance * 2);\n            }\n        }\n        return rect;\n    };\n    Displayable.prototype.setPrevPaintRect = function (paintRect) {\n        if (paintRect) {\n            this._prevPaintRect = this._prevPaintRect || new BoundingRect_1[\"default\"](0, 0, 0, 0);\n            this._prevPaintRect.copy(paintRect);\n        }\n        else {\n            this._prevPaintRect = null;\n        }\n    };\n    Displayable.prototype.getPrevPaintRect = function () {\n        return this._prevPaintRect;\n    };\n    Displayable.prototype.animateStyle = function (loop) {\n        return this.animate('style', loop);\n    };\n    Displayable.prototype.updateDuringAnimation = function (targetKey) {\n        if (targetKey === 'style') {\n            this.dirtyStyle();\n        }\n        else {\n            this.markRedraw();\n        }\n    };\n    Displayable.prototype.attrKV = function (key, value) {\n        if (key !== 'style') {\n            _super.prototype.attrKV.call(this, key, value);\n        }\n        else {\n            if (!this.style) {\n                this.useStyle(value);\n            }\n            else {\n                this.setStyle(value);\n            }\n        }\n    };\n    Displayable.prototype.setStyle = function (keyOrObj, value) {\n        if (typeof keyOrObj === 'string') {\n            this.style[keyOrObj] = value;\n        }\n        else {\n            util_1.extend(this.style, keyOrObj);\n        }\n        this.dirtyStyle();\n        return this;\n    };\n    Displayable.prototype.dirtyStyle = function () {\n        this.markRedraw();\n        this.__dirty |= Displayable.STYLE_CHANGED_BIT;\n        if (this._rect) {\n            this._rect = null;\n        }\n    };\n    Displayable.prototype.dirty = function () {\n        this.dirtyStyle();\n    };\n    Displayable.prototype.styleChanged = function () {\n        return !!(this.__dirty & Displayable.STYLE_CHANGED_BIT);\n    };\n    Displayable.prototype.styleUpdated = function () {\n        this.__dirty &= ~Displayable.STYLE_CHANGED_BIT;\n    };\n    Displayable.prototype.createStyle = function (obj) {\n        return util_1.createObject(exports.DEFAULT_COMMON_STYLE, obj);\n    };\n    Displayable.prototype.useStyle = function (obj) {\n        if (!obj[STYLE_MAGIC_KEY]) {\n            obj = this.createStyle(obj);\n        }\n        if (this.__inHover) {\n            this.__hoverStyle = obj;\n        }\n        else {\n            this.style = obj;\n        }\n        this.dirtyStyle();\n    };\n    Displayable.prototype.isStyleObject = function (obj) {\n        return obj[STYLE_MAGIC_KEY];\n    };\n    Displayable.prototype._innerSaveToNormal = function (toState) {\n        _super.prototype._innerSaveToNormal.call(this, toState);\n        var normalState = this._normalState;\n        if (toState.style && !normalState.style) {\n            normalState.style = this._mergeStyle(this.createStyle(), this.style);\n        }\n        this._savePrimaryToNormal(toState, normalState, PRIMARY_STATES_KEYS);\n    };\n    Displayable.prototype._applyStateObj = function (stateName, state, normalState, keepCurrentStates, transition, animationCfg) {\n        _super.prototype._applyStateObj.call(this, stateName, state, normalState, keepCurrentStates, transition, animationCfg);\n        var needsRestoreToNormal = !(state && keepCurrentStates);\n        var targetStyle;\n        if (state && state.style) {\n            if (transition) {\n                if (keepCurrentStates) {\n                    targetStyle = state.style;\n                }\n                else {\n                    targetStyle = this._mergeStyle(this.createStyle(), normalState.style);\n                    this._mergeStyle(targetStyle, state.style);\n                }\n            }\n            else {\n                targetStyle = this._mergeStyle(this.createStyle(), keepCurrentStates ? this.style : normalState.style);\n                this._mergeStyle(targetStyle, state.style);\n            }\n        }\n        else if (needsRestoreToNormal) {\n            targetStyle = normalState.style;\n        }\n        if (targetStyle) {\n            if (transition) {\n                var sourceStyle = this.style;\n                this.style = this.createStyle(needsRestoreToNormal ? {} : sourceStyle);\n                if (needsRestoreToNormal) {\n                    var changedKeys = util_1.keys(sourceStyle);\n                    for (var i = 0; i < changedKeys.length; i++) {\n                        var key = changedKeys[i];\n                        if (key in targetStyle) {\n                            targetStyle[key] = targetStyle[key];\n                            this.style[key] = sourceStyle[key];\n                        }\n                    }\n                }\n                var targetKeys = util_1.keys(targetStyle);\n                for (var i = 0; i < targetKeys.length; i++) {\n                    var key = targetKeys[i];\n                    this.style[key] = this.style[key];\n                }\n                this._transitionState(stateName, {\n                    style: targetStyle\n                }, animationCfg, this.getAnimationStyleProps());\n            }\n            else {\n                this.useStyle(targetStyle);\n            }\n        }\n        for (var i = 0; i < PRIMARY_STATES_KEYS.length; i++) {\n            var key = PRIMARY_STATES_KEYS[i];\n            if (state && state[key] != null) {\n                this[key] = state[key];\n            }\n            else if (needsRestoreToNormal) {\n                if (normalState[key] != null) {\n                    this[key] = normalState[key];\n                }\n            }\n        }\n    };\n    Displayable.prototype._mergeStates = function (states) {\n        var mergedState = _super.prototype._mergeStates.call(this, states);\n        var mergedStyle;\n        for (var i = 0; i < states.length; i++) {\n            var state = states[i];\n            if (state.style) {\n                mergedStyle = mergedStyle || {};\n                this._mergeStyle(mergedStyle, state.style);\n            }\n        }\n        if (mergedStyle) {\n            mergedState.style = mergedStyle;\n        }\n        return mergedState;\n    };\n    Displayable.prototype._mergeStyle = function (targetStyle, sourceStyle) {\n        util_1.extend(targetStyle, sourceStyle);\n        return targetStyle;\n    };\n    Displayable.prototype.getAnimationStyleProps = function () {\n        return exports.DEFAULT_COMMON_ANIMATION_PROPS;\n    };\n    Displayable.STYLE_CHANGED_BIT = 2;\n    Displayable.initDefaultProps = (function () {\n        var dispProto = Displayable.prototype;\n        dispProto.type = 'displayable';\n        dispProto.invisible = false;\n        dispProto.z = 0;\n        dispProto.z2 = 0;\n        dispProto.zlevel = 0;\n        dispProto.culling = false;\n        dispProto.cursor = 'pointer';\n        dispProto.rectHover = false;\n        dispProto.incremental = false;\n        dispProto._rect = null;\n        dispProto.dirtyRectTolerance = 0;\n        dispProto.__dirty = Element_1[\"default\"].REDARAW_BIT | Displayable.STYLE_CHANGED_BIT;\n    })();\n    return Displayable;\n}(Element_1[\"default\"]));\nvar tmpRect = new BoundingRect_1[\"default\"](0, 0, 0, 0);\nvar viewRect = new BoundingRect_1[\"default\"](0, 0, 0, 0);\nfunction isDisplayableCulled(el, width, height) {\n    tmpRect.copy(el.getBoundingRect());\n    if (el.transform) {\n        tmpRect.applyTransform(el.transform);\n    }\n    viewRect.width = width;\n    viewRect.height = height;\n    return !tmpRect.intersect(viewRect);\n}\nexports[\"default\"] = Displayable;\n"]},"metadata":{},"sourceType":"script"}