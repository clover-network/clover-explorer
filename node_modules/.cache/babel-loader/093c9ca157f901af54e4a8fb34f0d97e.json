{"ast":null,"code":"import { __assign, __rest } from \"tslib\";\nimport { mix, isString } from '@antv/util';\nimport Shape from '../shape';\nimport Global from '../../global';\nShape.registerNode('modelRect', {\n  // 自定义节点时的配置\n  options: {\n    size: [185, 70],\n    style: {\n      radius: 5,\n      stroke: '#69c0ff',\n      fill: '#ffffff',\n      lineWidth: Global.defaultNode.style.lineWidth,\n      fillOpacity: 1\n    },\n    // 文本样式配置\n    labelCfg: {\n      style: {\n        fill: '#595959',\n        fontSize: 14\n      },\n      offset: 30\n    },\n    descriptionCfg: {\n      style: {\n        fontSize: 12,\n        fill: '#bfbfbf'\n      },\n      paddingTop: 0\n    },\n    preRect: {\n      show: true,\n      width: 4,\n      fill: '#40a9ff',\n      radius: 2\n    },\n    // 节点上左右上下四个方向上的链接circle配置\n    linkPoints: {\n      top: false,\n      right: false,\n      bottom: false,\n      left: false,\n      // circle的大小\n      size: 10,\n      lineWidth: 1,\n      fill: '#72CC4A',\n      stroke: '#72CC4A'\n    },\n    // 节点中icon配置\n    logoIcon: {\n      // 是否显示icon，值为 false 则不渲染icon\n      show: true,\n      x: 0,\n      y: 0,\n      // icon的地址，字符串类型\n      img: 'https://gw.alipayobjects.com/zos/basement_prod/4f81893c-1806-4de4-aff3-9a6b266bc8a2.svg',\n      width: 16,\n      height: 16,\n      // 用于调整图标的左右位置\n      offset: 0\n    },\n    // 节点中表示状态的icon配置\n    stateIcon: {\n      // 是否显示icon，值为 false 则不渲染icon\n      show: true,\n      x: 0,\n      y: 0,\n      // icon的地址，字符串类型\n      img: 'https://gw.alipayobjects.com/zos/basement_prod/300a2523-67e0-4cbf-9d4a-67c077b40395.svg',\n      width: 16,\n      height: 16,\n      // 用于调整图标的左右位置\n      offset: -5\n    },\n    // 连接点，默认为左右\n    // anchorPoints: [{ x: 0, y: 0.5 }, { x: 1, y: 0.5 }]\n    anchorPoints: [[0, 0.5], [1, 0.5]]\n  },\n  shapeType: 'modelRect',\n  drawShape: function drawShape(cfg, group) {\n    var _a = this.getOptions(cfg).preRect,\n        preRect = _a === void 0 ? {} : _a;\n    var style = this.getShapeStyle(cfg);\n    var size = this.getSize(cfg);\n    var width = size[0];\n    var height = size[1];\n    var keyShape = group.addShape('rect', {\n      attrs: style,\n      className: this.type + \"-keyShape\",\n      name: this.type + \"-keyShape\",\n      draggable: true\n    });\n\n    var preRectShow = preRect.show,\n        preRectStyle = __rest(preRect, [\"show\"]);\n\n    if (preRectShow) {\n      group.addShape('rect', {\n        attrs: __assign({\n          x: -width / 2,\n          y: -height / 2,\n          height: height\n        }, preRectStyle),\n        className: 'pre-rect',\n        name: 'pre-rect',\n        draggable: true\n      });\n    }\n\n    this.drawLogoIcon(cfg, group);\n    this.drawStateIcon(cfg, group);\n    this.drawLinkPoints(cfg, group);\n    return keyShape;\n  },\n\n  /**\n   * 绘制模型矩形左边的logo图标\n   * @param {Object} cfg 数据配置项\n   * @param {Group} group Group实例\n   */\n  drawLogoIcon: function drawLogoIcon(cfg, group) {\n    var _a = this.getOptions(cfg).logoIcon,\n        logoIcon = _a === void 0 ? {} : _a;\n    var size = this.getSize(cfg);\n    var width = size[0];\n\n    if (logoIcon.show) {\n      var w = logoIcon.width,\n          h = logoIcon.height,\n          x = logoIcon.x,\n          y = logoIcon.y,\n          offset = logoIcon.offset,\n          logoIconStyle = __rest(logoIcon, [\"width\", \"height\", \"x\", \"y\", \"offset\"]);\n\n      group.addShape('image', {\n        attrs: __assign(__assign({}, logoIconStyle), {\n          x: x || -width / 2 + w + offset,\n          y: y || -h / 2,\n          width: w,\n          height: h\n        }),\n        className: 'rect-logo-icon',\n        name: 'rect-logo-icon',\n        draggable: true\n      });\n    }\n  },\n\n  /**\n   * 绘制模型矩形右边的状态图标\n   * @param {Object} cfg 数据配置项\n   * @param {Group} group Group实例\n   */\n  drawStateIcon: function drawStateIcon(cfg, group) {\n    var _a = this.getOptions(cfg).stateIcon,\n        stateIcon = _a === void 0 ? {} : _a;\n    var size = this.getSize(cfg);\n    var width = size[0];\n\n    if (stateIcon.show) {\n      var w = stateIcon.width,\n          h = stateIcon.height,\n          x = stateIcon.x,\n          y = stateIcon.y,\n          offset = stateIcon.offset,\n          iconStyle = __rest(stateIcon, [\"width\", \"height\", \"x\", \"y\", \"offset\"]);\n\n      group.addShape('image', {\n        attrs: __assign(__assign({}, iconStyle), {\n          x: x || width / 2 - w + offset,\n          y: y || -h / 2,\n          width: w,\n          height: h\n        }),\n        className: 'rect-state-icon',\n        name: 'rect-state-icon',\n        draggable: true\n      });\n    }\n  },\n\n  /**\n   * 绘制节点上的LinkPoints\n   * @param {Object} cfg data数据配置项\n   * @param {Group} group Group实例\n   */\n  drawLinkPoints: function drawLinkPoints(cfg, group) {\n    var _a = this.getOptions(cfg).linkPoints,\n        linkPoints = _a === void 0 ? {} : _a;\n\n    var top = linkPoints.top,\n        left = linkPoints.left,\n        right = linkPoints.right,\n        bottom = linkPoints.bottom,\n        markSize = linkPoints.size,\n        markR = linkPoints.r,\n        markStyle = __rest(linkPoints, [\"top\", \"left\", \"right\", \"bottom\", \"size\", \"r\"]);\n\n    var size = this.getSize(cfg);\n    var width = size[0];\n    var height = size[1];\n\n    if (left) {\n      // left circle\n      group.addShape('circle', {\n        attrs: __assign(__assign({}, markStyle), {\n          x: -width / 2,\n          y: 0,\n          r: markSize / 2 || markR || 5\n        }),\n        className: 'link-point-left',\n        name: 'link-point-left',\n        isAnchorPoint: true\n      });\n    }\n\n    if (right) {\n      // right circle\n      group.addShape('circle', {\n        attrs: __assign(__assign({}, markStyle), {\n          x: width / 2,\n          y: 0,\n          r: markSize / 2 || markR || 5\n        }),\n        className: 'link-point-right',\n        name: 'link-point-right',\n        isAnchorPoint: true\n      });\n    }\n\n    if (top) {\n      // top circle\n      group.addShape('circle', {\n        attrs: __assign(__assign({}, markStyle), {\n          x: 0,\n          y: -height / 2,\n          r: markSize / 2 || markR || 5\n        }),\n        className: 'link-point-top',\n        name: 'link-point-top',\n        isAnchorPoint: true\n      });\n    }\n\n    if (bottom) {\n      // bottom circle\n      group.addShape('circle', {\n        attrs: __assign(__assign({}, markStyle), {\n          x: 0,\n          y: height / 2,\n          r: markSize / 2 || markR || 5\n        }),\n        className: 'link-point-bottom',\n        name: 'link-point-bottom',\n        isAnchorPoint: true\n      });\n    }\n  },\n  drawLabel: function drawLabel(cfg, group) {\n    var _a = this.getOptions(cfg),\n        _b = _a.labelCfg,\n        labelCfg = _b === void 0 ? {} : _b,\n        _c = _a.logoIcon,\n        logoIcon = _c === void 0 ? {} : _c,\n        _d = _a.descriptionCfg,\n        descriptionCfg = _d === void 0 ? {} : _d;\n\n    var size = this.getSize(cfg);\n    var width = size[0];\n    var label = null;\n    var show = logoIcon.show,\n        w = logoIcon.width;\n    var offsetX = -width / 2 + labelCfg.offset;\n\n    if (show) {\n      offsetX = -width / 2 + w + labelCfg.offset;\n    }\n\n    var fontStyle = labelCfg.style;\n    var descriptionStyle = descriptionCfg.style,\n        descriptionPaddingTop = descriptionCfg.paddingTop;\n\n    if (isString(cfg.description)) {\n      label = group.addShape('text', {\n        attrs: __assign(__assign({}, fontStyle), {\n          x: offsetX,\n          y: -5,\n          text: cfg.label\n        }),\n        className: 'text-shape',\n        name: 'text-shape',\n        draggable: true\n      });\n      group.addShape('text', {\n        attrs: __assign(__assign({}, descriptionStyle), {\n          x: offsetX,\n          y: 17 + (descriptionPaddingTop || 0),\n          text: cfg.description\n        }),\n        className: 'rect-description',\n        name: 'rect-description',\n        draggable: true\n      });\n    } else {\n      label = group.addShape('text', {\n        attrs: __assign(__assign({}, fontStyle), {\n          x: offsetX,\n          y: 7,\n          text: cfg.label\n        }),\n        draggable: true\n      });\n    }\n\n    return label;\n  },\n\n  /**\n   * 获取节点的样式，供基于该节点自定义时使用\n   * @param {Object} cfg 节点数据模型\n   * @return {Object} 节点的样式\n   */\n  getShapeStyle: function getShapeStyle(cfg) {\n    var defaultStyle = this.getOptions(cfg).style;\n    var strokeStyle = {\n      stroke: cfg.color\n    }; // 如果设置了color，则覆盖默认的stroke属性\n\n    var style = mix({}, defaultStyle, strokeStyle);\n    var size = this.getSize(cfg);\n    var width = style.width || size[0];\n    var height = style.height || size[1];\n\n    var styles = __assign({\n      x: -width / 2,\n      y: -height / 2,\n      width: width,\n      height: height\n    }, style);\n\n    return styles;\n  },\n  update: function update(cfg, item) {\n    var _a = this.getOptions(cfg),\n        _b = _a.style,\n        style = _b === void 0 ? {} : _b,\n        _c = _a.labelCfg,\n        labelCfg = _c === void 0 ? {} : _c,\n        _d = _a.descriptionCfg,\n        descriptionCfg = _d === void 0 ? {} : _d;\n\n    var size = this.getSize(cfg);\n    var width = size[0];\n    var height = size[1];\n    var keyShape = item.get('keyShape');\n    keyShape.attr(__assign(__assign({}, style), {\n      x: -width / 2,\n      y: -height / 2,\n      width: width,\n      height: height\n    }));\n    var group = item.getContainer();\n    var logoIconShape = group.find(function (element) {\n      return element.get('className') === 'rect-logo-icon';\n    });\n    var currentLogoIconAttr = logoIconShape ? logoIconShape.attr() : {};\n    var logoIcon = mix({}, currentLogoIconAttr, cfg.logoIcon);\n    var w = logoIcon.width;\n\n    if (w === undefined) {\n      w = this.options.logoIcon.width;\n    }\n\n    var show = cfg.logoIcon ? cfg.logoIcon.show : undefined;\n    var offset = labelCfg.offset;\n    var offsetX = -width / 2 + w + offset;\n\n    if (!show && show !== undefined) {\n      offsetX = -width / 2 + offset;\n    }\n\n    var label = group.find(function (element) {\n      return element.get('className') === 'node-label';\n    });\n    var description = group.find(function (element) {\n      return element.get('className') === 'rect-description';\n    });\n\n    if (cfg.label) {\n      if (!label) {\n        group.addShape('text', {\n          attrs: __assign(__assign({}, labelCfg.style), {\n            x: offsetX,\n            y: cfg.description ? -5 : 7,\n            text: cfg.label\n          }),\n          className: 'node-label',\n          name: 'node-label',\n          draggable: true\n        });\n      } else {\n        var cfgStyle = cfg.labelCfg ? cfg.labelCfg.style : {};\n        var labelStyle = mix({}, label.attr(), cfgStyle);\n        if (cfg.label) labelStyle.text = cfg.label;\n        labelStyle.x = offsetX;\n        if (isString(cfg.description)) labelStyle.y = -5;\n\n        if (description) {\n          description.resetMatrix();\n          description.attr({\n            x: offsetX\n          });\n        }\n\n        label.resetMatrix();\n        label.attr(labelStyle);\n      }\n    }\n\n    if (isString(cfg.description)) {\n      var paddingTop = descriptionCfg.paddingTop;\n\n      if (!description) {\n        group.addShape('text', {\n          attrs: __assign(__assign({}, descriptionCfg.style), {\n            x: offsetX,\n            y: 17 + (paddingTop || 0),\n            text: cfg.description\n          }),\n          className: 'rect-description',\n          name: 'rect-description',\n          draggable: true\n        });\n      } else {\n        var cfgStyle = cfg.descriptionCfg ? cfg.descriptionCfg.style : {};\n        var descriptionStyle = mix({}, description.attr(), cfgStyle);\n        if (isString(cfg.description)) descriptionStyle.text = cfg.description;\n        descriptionStyle.x = offsetX;\n        description.resetMatrix();\n        description.attr(__assign(__assign({}, descriptionStyle), {\n          y: 17 + (paddingTop || 0)\n        }));\n      }\n    }\n\n    var preRectShape = group.find(function (element) {\n      return element.get('className') === 'pre-rect';\n    });\n\n    if (preRectShape) {\n      var preRect = mix({}, preRectShape.attr(), cfg.preRect);\n      preRectShape.attr(__assign(__assign({}, preRect), {\n        x: -width / 2,\n        y: -height / 2,\n        height: height\n      }));\n    }\n\n    if (logoIconShape) {\n      if (!show && show !== undefined) {\n        logoIconShape.remove();\n      } else {\n        var logoW = logoIcon.width,\n            h = logoIcon.height,\n            x = logoIcon.x,\n            y = logoIcon.y,\n            logoOffset = logoIcon.offset,\n            logoIconStyle = __rest(logoIcon, [\"width\", \"height\", \"x\", \"y\", \"offset\"]);\n\n        logoIconShape.attr(__assign(__assign({}, logoIconStyle), {\n          x: x || -width / 2 + logoW + logoOffset,\n          y: y || -h / 2,\n          width: logoW,\n          height: h\n        }));\n      }\n    } else if (show) {\n      this.drawLogoIcon(cfg, group);\n    }\n\n    var stateIconShape = group.find(function (element) {\n      return element.get('className') === 'rect-state-icon';\n    });\n    var currentStateIconAttr = stateIconShape ? stateIconShape.attr() : {};\n    var stateIcon = mix({}, currentStateIconAttr, cfg.stateIcon);\n\n    if (stateIconShape) {\n      if (!stateIcon.show && stateIcon.show !== undefined) {\n        stateIconShape.remove();\n      }\n\n      var stateW = stateIcon.width,\n          h = stateIcon.height,\n          x = stateIcon.x,\n          y = stateIcon.y,\n          stateOffset = stateIcon.offset,\n          stateIconStyle = __rest(stateIcon, [\"width\", \"height\", \"x\", \"y\", \"offset\"]);\n\n      stateIconShape.attr(__assign(__assign({}, stateIconStyle), {\n        x: x || width / 2 - stateW + stateOffset,\n        y: y || -h / 2,\n        width: stateW,\n        height: h\n      }));\n    } else if (stateIcon.show) {\n      this.drawStateIcon(cfg, group);\n    }\n\n    this.updateLinkPoints(cfg, group);\n  }\n}, 'single-node');","map":{"version":3,"sources":["/Users/wanglijie/wanglijie/clover-defi-wallet/node_modules/@antv/g6/es/shape/nodes/modelRect.js"],"names":["__assign","__rest","mix","isString","Shape","Global","registerNode","options","size","style","radius","stroke","fill","lineWidth","defaultNode","fillOpacity","labelCfg","fontSize","offset","descriptionCfg","paddingTop","preRect","show","width","linkPoints","top","right","bottom","left","logoIcon","x","y","img","height","stateIcon","anchorPoints","shapeType","drawShape","cfg","group","_a","getOptions","getShapeStyle","getSize","keyShape","addShape","attrs","className","type","name","draggable","preRectShow","preRectStyle","drawLogoIcon","drawStateIcon","drawLinkPoints","w","h","logoIconStyle","iconStyle","markSize","markR","r","markStyle","isAnchorPoint","drawLabel","_b","_c","_d","label","offsetX","fontStyle","descriptionStyle","descriptionPaddingTop","description","text","defaultStyle","strokeStyle","color","styles","update","item","get","attr","getContainer","logoIconShape","find","element","currentLogoIconAttr","undefined","cfgStyle","labelStyle","resetMatrix","preRectShape","remove","logoW","logoOffset","stateIconShape","currentStateIconAttr","stateW","stateOffset","stateIconStyle","updateLinkPoints"],"mappings":"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","sourcesContent":["import { __assign, __rest } from \"tslib\";\nimport { mix, isString } from '@antv/util';\nimport Shape from '../shape';\nimport Global from '../../global';\nShape.registerNode('modelRect', {\n  // 自定义节点时的配置\n  options: {\n    size: [185, 70],\n    style: {\n      radius: 5,\n      stroke: '#69c0ff',\n      fill: '#ffffff',\n      lineWidth: Global.defaultNode.style.lineWidth,\n      fillOpacity: 1\n    },\n    // 文本样式配置\n    labelCfg: {\n      style: {\n        fill: '#595959',\n        fontSize: 14\n      },\n      offset: 30\n    },\n    descriptionCfg: {\n      style: {\n        fontSize: 12,\n        fill: '#bfbfbf'\n      },\n      paddingTop: 0\n    },\n    preRect: {\n      show: true,\n      width: 4,\n      fill: '#40a9ff',\n      radius: 2\n    },\n    // 节点上左右上下四个方向上的链接circle配置\n    linkPoints: {\n      top: false,\n      right: false,\n      bottom: false,\n      left: false,\n      // circle的大小\n      size: 10,\n      lineWidth: 1,\n      fill: '#72CC4A',\n      stroke: '#72CC4A'\n    },\n    // 节点中icon配置\n    logoIcon: {\n      // 是否显示icon，值为 false 则不渲染icon\n      show: true,\n      x: 0,\n      y: 0,\n      // icon的地址，字符串类型\n      img: 'https://gw.alipayobjects.com/zos/basement_prod/4f81893c-1806-4de4-aff3-9a6b266bc8a2.svg',\n      width: 16,\n      height: 16,\n      // 用于调整图标的左右位置\n      offset: 0\n    },\n    // 节点中表示状态的icon配置\n    stateIcon: {\n      // 是否显示icon，值为 false 则不渲染icon\n      show: true,\n      x: 0,\n      y: 0,\n      // icon的地址，字符串类型\n      img: 'https://gw.alipayobjects.com/zos/basement_prod/300a2523-67e0-4cbf-9d4a-67c077b40395.svg',\n      width: 16,\n      height: 16,\n      // 用于调整图标的左右位置\n      offset: -5\n    },\n    // 连接点，默认为左右\n    // anchorPoints: [{ x: 0, y: 0.5 }, { x: 1, y: 0.5 }]\n    anchorPoints: [[0, 0.5], [1, 0.5]]\n  },\n  shapeType: 'modelRect',\n  drawShape: function drawShape(cfg, group) {\n    var _a = this.getOptions(cfg).preRect,\n        preRect = _a === void 0 ? {} : _a;\n    var style = this.getShapeStyle(cfg);\n    var size = this.getSize(cfg);\n    var width = size[0];\n    var height = size[1];\n    var keyShape = group.addShape('rect', {\n      attrs: style,\n      className: this.type + \"-keyShape\",\n      name: this.type + \"-keyShape\",\n      draggable: true\n    });\n\n    var preRectShow = preRect.show,\n        preRectStyle = __rest(preRect, [\"show\"]);\n\n    if (preRectShow) {\n      group.addShape('rect', {\n        attrs: __assign({\n          x: -width / 2,\n          y: -height / 2,\n          height: height\n        }, preRectStyle),\n        className: 'pre-rect',\n        name: 'pre-rect',\n        draggable: true\n      });\n    }\n\n    this.drawLogoIcon(cfg, group);\n    this.drawStateIcon(cfg, group);\n    this.drawLinkPoints(cfg, group);\n    return keyShape;\n  },\n\n  /**\n   * 绘制模型矩形左边的logo图标\n   * @param {Object} cfg 数据配置项\n   * @param {Group} group Group实例\n   */\n  drawLogoIcon: function drawLogoIcon(cfg, group) {\n    var _a = this.getOptions(cfg).logoIcon,\n        logoIcon = _a === void 0 ? {} : _a;\n    var size = this.getSize(cfg);\n    var width = size[0];\n\n    if (logoIcon.show) {\n      var w = logoIcon.width,\n          h = logoIcon.height,\n          x = logoIcon.x,\n          y = logoIcon.y,\n          offset = logoIcon.offset,\n          logoIconStyle = __rest(logoIcon, [\"width\", \"height\", \"x\", \"y\", \"offset\"]);\n\n      group.addShape('image', {\n        attrs: __assign(__assign({}, logoIconStyle), {\n          x: x || -width / 2 + w + offset,\n          y: y || -h / 2,\n          width: w,\n          height: h\n        }),\n        className: 'rect-logo-icon',\n        name: 'rect-logo-icon',\n        draggable: true\n      });\n    }\n  },\n\n  /**\n   * 绘制模型矩形右边的状态图标\n   * @param {Object} cfg 数据配置项\n   * @param {Group} group Group实例\n   */\n  drawStateIcon: function drawStateIcon(cfg, group) {\n    var _a = this.getOptions(cfg).stateIcon,\n        stateIcon = _a === void 0 ? {} : _a;\n    var size = this.getSize(cfg);\n    var width = size[0];\n\n    if (stateIcon.show) {\n      var w = stateIcon.width,\n          h = stateIcon.height,\n          x = stateIcon.x,\n          y = stateIcon.y,\n          offset = stateIcon.offset,\n          iconStyle = __rest(stateIcon, [\"width\", \"height\", \"x\", \"y\", \"offset\"]);\n\n      group.addShape('image', {\n        attrs: __assign(__assign({}, iconStyle), {\n          x: x || width / 2 - w + offset,\n          y: y || -h / 2,\n          width: w,\n          height: h\n        }),\n        className: 'rect-state-icon',\n        name: 'rect-state-icon',\n        draggable: true\n      });\n    }\n  },\n\n  /**\n   * 绘制节点上的LinkPoints\n   * @param {Object} cfg data数据配置项\n   * @param {Group} group Group实例\n   */\n  drawLinkPoints: function drawLinkPoints(cfg, group) {\n    var _a = this.getOptions(cfg).linkPoints,\n        linkPoints = _a === void 0 ? {} : _a;\n\n    var top = linkPoints.top,\n        left = linkPoints.left,\n        right = linkPoints.right,\n        bottom = linkPoints.bottom,\n        markSize = linkPoints.size,\n        markR = linkPoints.r,\n        markStyle = __rest(linkPoints, [\"top\", \"left\", \"right\", \"bottom\", \"size\", \"r\"]);\n\n    var size = this.getSize(cfg);\n    var width = size[0];\n    var height = size[1];\n\n    if (left) {\n      // left circle\n      group.addShape('circle', {\n        attrs: __assign(__assign({}, markStyle), {\n          x: -width / 2,\n          y: 0,\n          r: markSize / 2 || markR || 5\n        }),\n        className: 'link-point-left',\n        name: 'link-point-left',\n        isAnchorPoint: true\n      });\n    }\n\n    if (right) {\n      // right circle\n      group.addShape('circle', {\n        attrs: __assign(__assign({}, markStyle), {\n          x: width / 2,\n          y: 0,\n          r: markSize / 2 || markR || 5\n        }),\n        className: 'link-point-right',\n        name: 'link-point-right',\n        isAnchorPoint: true\n      });\n    }\n\n    if (top) {\n      // top circle\n      group.addShape('circle', {\n        attrs: __assign(__assign({}, markStyle), {\n          x: 0,\n          y: -height / 2,\n          r: markSize / 2 || markR || 5\n        }),\n        className: 'link-point-top',\n        name: 'link-point-top',\n        isAnchorPoint: true\n      });\n    }\n\n    if (bottom) {\n      // bottom circle\n      group.addShape('circle', {\n        attrs: __assign(__assign({}, markStyle), {\n          x: 0,\n          y: height / 2,\n          r: markSize / 2 || markR || 5\n        }),\n        className: 'link-point-bottom',\n        name: 'link-point-bottom',\n        isAnchorPoint: true\n      });\n    }\n  },\n  drawLabel: function drawLabel(cfg, group) {\n    var _a = this.getOptions(cfg),\n        _b = _a.labelCfg,\n        labelCfg = _b === void 0 ? {} : _b,\n        _c = _a.logoIcon,\n        logoIcon = _c === void 0 ? {} : _c,\n        _d = _a.descriptionCfg,\n        descriptionCfg = _d === void 0 ? {} : _d;\n\n    var size = this.getSize(cfg);\n    var width = size[0];\n    var label = null;\n    var show = logoIcon.show,\n        w = logoIcon.width;\n    var offsetX = -width / 2 + labelCfg.offset;\n\n    if (show) {\n      offsetX = -width / 2 + w + labelCfg.offset;\n    }\n\n    var fontStyle = labelCfg.style;\n    var descriptionStyle = descriptionCfg.style,\n        descriptionPaddingTop = descriptionCfg.paddingTop;\n\n    if (isString(cfg.description)) {\n      label = group.addShape('text', {\n        attrs: __assign(__assign({}, fontStyle), {\n          x: offsetX,\n          y: -5,\n          text: cfg.label\n        }),\n        className: 'text-shape',\n        name: 'text-shape',\n        draggable: true\n      });\n      group.addShape('text', {\n        attrs: __assign(__assign({}, descriptionStyle), {\n          x: offsetX,\n          y: 17 + (descriptionPaddingTop || 0),\n          text: cfg.description\n        }),\n        className: 'rect-description',\n        name: 'rect-description',\n        draggable: true\n      });\n    } else {\n      label = group.addShape('text', {\n        attrs: __assign(__assign({}, fontStyle), {\n          x: offsetX,\n          y: 7,\n          text: cfg.label\n        }),\n        draggable: true\n      });\n    }\n\n    return label;\n  },\n\n  /**\n   * 获取节点的样式，供基于该节点自定义时使用\n   * @param {Object} cfg 节点数据模型\n   * @return {Object} 节点的样式\n   */\n  getShapeStyle: function getShapeStyle(cfg) {\n    var defaultStyle = this.getOptions(cfg).style;\n    var strokeStyle = {\n      stroke: cfg.color\n    }; // 如果设置了color，则覆盖默认的stroke属性\n\n    var style = mix({}, defaultStyle, strokeStyle);\n    var size = this.getSize(cfg);\n    var width = style.width || size[0];\n    var height = style.height || size[1];\n\n    var styles = __assign({\n      x: -width / 2,\n      y: -height / 2,\n      width: width,\n      height: height\n    }, style);\n\n    return styles;\n  },\n  update: function update(cfg, item) {\n    var _a = this.getOptions(cfg),\n        _b = _a.style,\n        style = _b === void 0 ? {} : _b,\n        _c = _a.labelCfg,\n        labelCfg = _c === void 0 ? {} : _c,\n        _d = _a.descriptionCfg,\n        descriptionCfg = _d === void 0 ? {} : _d;\n\n    var size = this.getSize(cfg);\n    var width = size[0];\n    var height = size[1];\n    var keyShape = item.get('keyShape');\n    keyShape.attr(__assign(__assign({}, style), {\n      x: -width / 2,\n      y: -height / 2,\n      width: width,\n      height: height\n    }));\n    var group = item.getContainer();\n    var logoIconShape = group.find(function (element) {\n      return element.get('className') === 'rect-logo-icon';\n    });\n    var currentLogoIconAttr = logoIconShape ? logoIconShape.attr() : {};\n    var logoIcon = mix({}, currentLogoIconAttr, cfg.logoIcon);\n    var w = logoIcon.width;\n\n    if (w === undefined) {\n      w = this.options.logoIcon.width;\n    }\n\n    var show = cfg.logoIcon ? cfg.logoIcon.show : undefined;\n    var offset = labelCfg.offset;\n    var offsetX = -width / 2 + w + offset;\n\n    if (!show && show !== undefined) {\n      offsetX = -width / 2 + offset;\n    }\n\n    var label = group.find(function (element) {\n      return element.get('className') === 'node-label';\n    });\n    var description = group.find(function (element) {\n      return element.get('className') === 'rect-description';\n    });\n\n    if (cfg.label) {\n      if (!label) {\n        group.addShape('text', {\n          attrs: __assign(__assign({}, labelCfg.style), {\n            x: offsetX,\n            y: cfg.description ? -5 : 7,\n            text: cfg.label\n          }),\n          className: 'node-label',\n          name: 'node-label',\n          draggable: true\n        });\n      } else {\n        var cfgStyle = cfg.labelCfg ? cfg.labelCfg.style : {};\n        var labelStyle = mix({}, label.attr(), cfgStyle);\n        if (cfg.label) labelStyle.text = cfg.label;\n        labelStyle.x = offsetX;\n        if (isString(cfg.description)) labelStyle.y = -5;\n\n        if (description) {\n          description.resetMatrix();\n          description.attr({\n            x: offsetX\n          });\n        }\n\n        label.resetMatrix();\n        label.attr(labelStyle);\n      }\n    }\n\n    if (isString(cfg.description)) {\n      var paddingTop = descriptionCfg.paddingTop;\n\n      if (!description) {\n        group.addShape('text', {\n          attrs: __assign(__assign({}, descriptionCfg.style), {\n            x: offsetX,\n            y: 17 + (paddingTop || 0),\n            text: cfg.description\n          }),\n          className: 'rect-description',\n          name: 'rect-description',\n          draggable: true\n        });\n      } else {\n        var cfgStyle = cfg.descriptionCfg ? cfg.descriptionCfg.style : {};\n        var descriptionStyle = mix({}, description.attr(), cfgStyle);\n        if (isString(cfg.description)) descriptionStyle.text = cfg.description;\n        descriptionStyle.x = offsetX;\n        description.resetMatrix();\n        description.attr(__assign(__assign({}, descriptionStyle), {\n          y: 17 + (paddingTop || 0)\n        }));\n      }\n    }\n\n    var preRectShape = group.find(function (element) {\n      return element.get('className') === 'pre-rect';\n    });\n\n    if (preRectShape) {\n      var preRect = mix({}, preRectShape.attr(), cfg.preRect);\n      preRectShape.attr(__assign(__assign({}, preRect), {\n        x: -width / 2,\n        y: -height / 2,\n        height: height\n      }));\n    }\n\n    if (logoIconShape) {\n      if (!show && show !== undefined) {\n        logoIconShape.remove();\n      } else {\n        var logoW = logoIcon.width,\n            h = logoIcon.height,\n            x = logoIcon.x,\n            y = logoIcon.y,\n            logoOffset = logoIcon.offset,\n            logoIconStyle = __rest(logoIcon, [\"width\", \"height\", \"x\", \"y\", \"offset\"]);\n\n        logoIconShape.attr(__assign(__assign({}, logoIconStyle), {\n          x: x || -width / 2 + logoW + logoOffset,\n          y: y || -h / 2,\n          width: logoW,\n          height: h\n        }));\n      }\n    } else if (show) {\n      this.drawLogoIcon(cfg, group);\n    }\n\n    var stateIconShape = group.find(function (element) {\n      return element.get('className') === 'rect-state-icon';\n    });\n    var currentStateIconAttr = stateIconShape ? stateIconShape.attr() : {};\n    var stateIcon = mix({}, currentStateIconAttr, cfg.stateIcon);\n\n    if (stateIconShape) {\n      if (!stateIcon.show && stateIcon.show !== undefined) {\n        stateIconShape.remove();\n      }\n\n      var stateW = stateIcon.width,\n          h = stateIcon.height,\n          x = stateIcon.x,\n          y = stateIcon.y,\n          stateOffset = stateIcon.offset,\n          stateIconStyle = __rest(stateIcon, [\"width\", \"height\", \"x\", \"y\", \"offset\"]);\n\n      stateIconShape.attr(__assign(__assign({}, stateIconStyle), {\n        x: x || width / 2 - stateW + stateOffset,\n        y: y || -h / 2,\n        width: stateW,\n        height: h\n      }));\n    } else if (stateIcon.show) {\n      this.drawStateIcon(cfg, group);\n    }\n\n    this.updateLinkPoints(cfg, group);\n  }\n}, 'single-node');"]},"metadata":{},"sourceType":"module"}