{"ast":null,"code":"/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\n\n/**\n * AUTO-GENERATED FILE. DO NOT MODIFY.\n */\n\"use strict\";\n\nexports.__esModule = true;\n\nvar tslib_1 = require(\"tslib\");\n\nvar zrUtil = require(\"zrender/lib/core/util\");\n\nvar env_1 = require(\"zrender/lib/core/env\");\n\nvar TooltipHTMLContent_1 = require(\"./TooltipHTMLContent\");\n\nvar TooltipRichContent_1 = require(\"./TooltipRichContent\");\n\nvar formatUtil = require(\"../../util/format\");\n\nvar numberUtil = require(\"../../util/number\");\n\nvar graphic = require(\"../../util/graphic\");\n\nvar findPointFromSeries_1 = require(\"../axisPointer/findPointFromSeries\");\n\nvar layoutUtil = require(\"../../util/layout\");\n\nvar Model_1 = require(\"../../model/Model\");\n\nvar globalListener = require(\"../axisPointer/globalListener\");\n\nvar axisHelper = require(\"../../coord/axisHelper\");\n\nvar axisPointerViewHelper = require(\"../axisPointer/viewHelper\");\n\nvar model_1 = require(\"../../util/model\");\n\nvar Component_1 = require(\"../../view/Component\");\n\nvar time_1 = require(\"../../util/time\");\n\nvar innerStore_1 = require(\"../../util/innerStore\");\n\nvar helper_1 = require(\"./helper\");\n\nvar dataFormat_1 = require(\"../../model/mixin/dataFormat\");\n\nvar tooltipMarkup_1 = require(\"./tooltipMarkup\");\n\nvar event_1 = require(\"../../util/event\");\n\nvar bind = zrUtil.bind;\nvar each = zrUtil.each;\nvar parsePercent = numberUtil.parsePercent;\nvar proxyRect = new graphic.Rect({\n  shape: {\n    x: -1,\n    y: -1,\n    width: 2,\n    height: 2\n  }\n});\n\nvar TooltipView = function (_super) {\n  tslib_1.__extends(TooltipView, _super);\n\n  function TooltipView() {\n    var _this = _super !== null && _super.apply(this, arguments) || this;\n\n    _this.type = TooltipView.type;\n    return _this;\n  }\n\n  TooltipView.prototype.init = function (ecModel, api) {\n    if (env_1[\"default\"].node) {\n      return;\n    }\n\n    var tooltipModel = ecModel.getComponent('tooltip');\n    var renderMode = tooltipModel.get('renderMode');\n    this._renderMode = model_1.getTooltipRenderMode(renderMode);\n    this._tooltipContent = this._renderMode === 'richText' ? new TooltipRichContent_1[\"default\"](api) : new TooltipHTMLContent_1[\"default\"](api.getDom(), api, {\n      appendToBody: tooltipModel.get('appendToBody', true)\n    });\n  };\n\n  TooltipView.prototype.render = function (tooltipModel, ecModel, api) {\n    if (env_1[\"default\"].node) {\n      return;\n    }\n\n    this.group.removeAll();\n    this._tooltipModel = tooltipModel;\n    this._ecModel = ecModel;\n    this._api = api;\n    this._alwaysShowContent = tooltipModel.get('alwaysShowContent');\n    var tooltipContent = this._tooltipContent;\n    tooltipContent.update(tooltipModel);\n    tooltipContent.setEnterable(tooltipModel.get('enterable'));\n\n    this._initGlobalListener();\n\n    this._keepShow();\n  };\n\n  TooltipView.prototype._initGlobalListener = function () {\n    var tooltipModel = this._tooltipModel;\n    var triggerOn = tooltipModel.get('triggerOn');\n    globalListener.register('itemTooltip', this._api, bind(function (currTrigger, e, dispatchAction) {\n      if (triggerOn !== 'none') {\n        if (triggerOn.indexOf(currTrigger) >= 0) {\n          this._tryShow(e, dispatchAction);\n        } else if (currTrigger === 'leave') {\n          this._hide(dispatchAction);\n        }\n      }\n    }, this));\n  };\n\n  TooltipView.prototype._keepShow = function () {\n    var tooltipModel = this._tooltipModel;\n    var ecModel = this._ecModel;\n    var api = this._api;\n\n    if (this._lastX != null && this._lastY != null && tooltipModel.get('triggerOn') !== 'none') {\n      var self_1 = this;\n      clearTimeout(this._refreshUpdateTimeout);\n      this._refreshUpdateTimeout = setTimeout(function () {\n        !api.isDisposed() && self_1.manuallyShowTip(tooltipModel, ecModel, api, {\n          x: self_1._lastX,\n          y: self_1._lastY,\n          dataByCoordSys: self_1._lastDataByCoordSys\n        });\n      });\n    }\n  };\n\n  TooltipView.prototype.manuallyShowTip = function (tooltipModel, ecModel, api, payload) {\n    if (payload.from === this.uid || env_1[\"default\"].node) {\n      return;\n    }\n\n    var dispatchAction = makeDispatchAction(payload, api);\n    this._ticket = '';\n    var dataByCoordSys = payload.dataByCoordSys;\n\n    if (payload.tooltip && payload.x != null && payload.y != null) {\n      var el = proxyRect;\n      el.x = payload.x;\n      el.y = payload.y;\n      el.update();\n      el.tooltip = payload.tooltip;\n\n      this._tryShow({\n        offsetX: payload.x,\n        offsetY: payload.y,\n        target: el\n      }, dispatchAction);\n    } else if (dataByCoordSys) {\n      this._tryShow({\n        offsetX: payload.x,\n        offsetY: payload.y,\n        position: payload.position,\n        dataByCoordSys: dataByCoordSys,\n        tooltipOption: payload.tooltipOption\n      }, dispatchAction);\n    } else if (payload.seriesIndex != null) {\n      if (this._manuallyAxisShowTip(tooltipModel, ecModel, api, payload)) {\n        return;\n      }\n\n      var pointInfo = findPointFromSeries_1[\"default\"](payload, ecModel);\n      var cx = pointInfo.point[0];\n      var cy = pointInfo.point[1];\n\n      if (cx != null && cy != null) {\n        this._tryShow({\n          offsetX: cx,\n          offsetY: cy,\n          position: payload.position,\n          target: pointInfo.el\n        }, dispatchAction);\n      }\n    } else if (payload.x != null && payload.y != null) {\n      api.dispatchAction({\n        type: 'updateAxisPointer',\n        x: payload.x,\n        y: payload.y\n      });\n\n      this._tryShow({\n        offsetX: payload.x,\n        offsetY: payload.y,\n        position: payload.position,\n        target: api.getZr().findHover(payload.x, payload.y).target\n      }, dispatchAction);\n    }\n  };\n\n  TooltipView.prototype.manuallyHideTip = function (tooltipModel, ecModel, api, payload) {\n    var tooltipContent = this._tooltipContent;\n\n    if (!this._alwaysShowContent && this._tooltipModel) {\n      tooltipContent.hideLater(this._tooltipModel.get('hideDelay'));\n    }\n\n    this._lastX = this._lastY = this._lastDataByCoordSys = null;\n\n    if (payload.from !== this.uid) {\n      this._hide(makeDispatchAction(payload, api));\n    }\n  };\n\n  TooltipView.prototype._manuallyAxisShowTip = function (tooltipModel, ecModel, api, payload) {\n    var seriesIndex = payload.seriesIndex;\n    var dataIndex = payload.dataIndex;\n    var coordSysAxesInfo = ecModel.getComponent('axisPointer').coordSysAxesInfo;\n\n    if (seriesIndex == null || dataIndex == null || coordSysAxesInfo == null) {\n      return;\n    }\n\n    var seriesModel = ecModel.getSeriesByIndex(seriesIndex);\n\n    if (!seriesModel) {\n      return;\n    }\n\n    var data = seriesModel.getData();\n    var tooltipCascadedModel = buildTooltipModel([data.getItemModel(dataIndex), seriesModel, (seriesModel.coordinateSystem || {}).model, tooltipModel]);\n\n    if (tooltipCascadedModel.get('trigger') !== 'axis') {\n      return;\n    }\n\n    api.dispatchAction({\n      type: 'updateAxisPointer',\n      seriesIndex: seriesIndex,\n      dataIndex: dataIndex,\n      position: payload.position\n    });\n    return true;\n  };\n\n  TooltipView.prototype._tryShow = function (e, dispatchAction) {\n    var el = e.target;\n    var tooltipModel = this._tooltipModel;\n\n    if (!tooltipModel) {\n      return;\n    }\n\n    this._lastX = e.offsetX;\n    this._lastY = e.offsetY;\n    var dataByCoordSys = e.dataByCoordSys;\n\n    if (dataByCoordSys && dataByCoordSys.length) {\n      this._showAxisTooltip(dataByCoordSys, e);\n    } else if (el && event_1.findEventDispatcher(el, function (target) {\n      return innerStore_1.getECData(target).dataIndex != null;\n    })) {\n      this._lastDataByCoordSys = null;\n\n      this._showSeriesItemTooltip(e, el, dispatchAction);\n    } else if (el && el.tooltip) {\n      this._lastDataByCoordSys = null;\n\n      this._showComponentItemTooltip(e, el, dispatchAction);\n    } else {\n      this._lastDataByCoordSys = null;\n\n      this._hide(dispatchAction);\n    }\n  };\n\n  TooltipView.prototype._showOrMove = function (tooltipModel, cb) {\n    var delay = tooltipModel.get('showDelay');\n    cb = zrUtil.bind(cb, this);\n    clearTimeout(this._showTimout);\n    delay > 0 ? this._showTimout = setTimeout(cb, delay) : cb();\n  };\n\n  TooltipView.prototype._showAxisTooltip = function (dataByCoordSys, e) {\n    var ecModel = this._ecModel;\n    var globalTooltipModel = this._tooltipModel;\n    var point = [e.offsetX, e.offsetY];\n    var singleTooltipModel = buildTooltipModel([e.tooltipOption, globalTooltipModel]);\n    var renderMode = this._renderMode;\n    var cbParamsList = [];\n    var articleMarkup = tooltipMarkup_1.createTooltipMarkup('section', {\n      blocks: [],\n      noHeader: true\n    });\n    var markupTextArrLegacy = [];\n    var markupStyleCreator = new tooltipMarkup_1.TooltipMarkupStyleCreator();\n    each(dataByCoordSys, function (itemCoordSys) {\n      each(itemCoordSys.dataByAxis, function (axisItem) {\n        var axisModel = ecModel.getComponent(axisItem.axisDim + 'Axis', axisItem.axisIndex);\n        var axisValue = axisItem.value;\n\n        if (!axisModel || axisValue == null) {\n          return;\n        }\n\n        var axisValueLabel = axisPointerViewHelper.getValueLabel(axisValue, axisModel.axis, ecModel, axisItem.seriesDataIndices, axisItem.valueLabelOpt);\n        var axisSectionMarkup = tooltipMarkup_1.createTooltipMarkup('section', {\n          header: axisValueLabel,\n          noHeader: !zrUtil.trim(axisValueLabel),\n          sortBlocks: true,\n          blocks: []\n        });\n        articleMarkup.blocks.push(axisSectionMarkup);\n        zrUtil.each(axisItem.seriesDataIndices, function (idxItem) {\n          var series = ecModel.getSeriesByIndex(idxItem.seriesIndex);\n          var dataIndex = idxItem.dataIndexInside;\n          var cbParams = series.getDataParams(dataIndex);\n          cbParams.axisDim = axisItem.axisDim;\n          cbParams.axisIndex = axisItem.axisIndex;\n          cbParams.axisType = axisItem.axisType;\n          cbParams.axisId = axisItem.axisId;\n          cbParams.axisValue = axisHelper.getAxisRawValue(axisModel.axis, {\n            value: axisValue\n          });\n          cbParams.axisValueLabel = axisValueLabel;\n          cbParams.marker = markupStyleCreator.makeTooltipMarker('item', formatUtil.convertToColorString(cbParams.color), renderMode);\n          var seriesTooltipResult = dataFormat_1.normalizeTooltipFormatResult(series.formatTooltip(dataIndex, true, null));\n\n          if (seriesTooltipResult.markupFragment) {\n            axisSectionMarkup.blocks.push(seriesTooltipResult.markupFragment);\n          }\n\n          if (seriesTooltipResult.markupText) {\n            markupTextArrLegacy.push(seriesTooltipResult.markupText);\n          }\n\n          cbParamsList.push(cbParams);\n        });\n      });\n    });\n    articleMarkup.blocks.reverse();\n    markupTextArrLegacy.reverse();\n    var positionExpr = e.position;\n    var orderMode = singleTooltipModel.get('order');\n    var builtMarkupText = tooltipMarkup_1.buildTooltipMarkup(articleMarkup, markupStyleCreator, renderMode, orderMode, ecModel.get('useUTC'));\n    builtMarkupText && markupTextArrLegacy.unshift(builtMarkupText);\n    var blockBreak = renderMode === 'richText' ? '\\n\\n' : '<br/>';\n    var allMarkupText = markupTextArrLegacy.join(blockBreak);\n\n    this._showOrMove(singleTooltipModel, function () {\n      if (this._updateContentNotChangedOnAxis(dataByCoordSys)) {\n        this._updatePosition(singleTooltipModel, positionExpr, point[0], point[1], this._tooltipContent, cbParamsList);\n      } else {\n        this._showTooltipContent(singleTooltipModel, allMarkupText, cbParamsList, Math.random() + '', point[0], point[1], positionExpr, null, markupStyleCreator);\n      }\n    });\n  };\n\n  TooltipView.prototype._showSeriesItemTooltip = function (e, el, dispatchAction) {\n    var dispatcher = event_1.findEventDispatcher(el, function (target) {\n      return innerStore_1.getECData(target).dataIndex != null;\n    });\n    var ecModel = this._ecModel;\n    var ecData = innerStore_1.getECData(dispatcher);\n    var seriesIndex = ecData.seriesIndex;\n    var seriesModel = ecModel.getSeriesByIndex(seriesIndex);\n    var dataModel = ecData.dataModel || seriesModel;\n    var dataIndex = ecData.dataIndex;\n    var dataType = ecData.dataType;\n    var data = dataModel.getData(dataType);\n    var renderMode = this._renderMode;\n    var tooltipModel = buildTooltipModel([data.getItemModel(dataIndex), dataModel, seriesModel && (seriesModel.coordinateSystem || {}).model, this._tooltipModel]);\n    var tooltipTrigger = tooltipModel.get('trigger');\n\n    if (tooltipTrigger != null && tooltipTrigger !== 'item') {\n      return;\n    }\n\n    var params = dataModel.getDataParams(dataIndex, dataType);\n    var markupStyleCreator = new tooltipMarkup_1.TooltipMarkupStyleCreator();\n    params.marker = markupStyleCreator.makeTooltipMarker('item', formatUtil.convertToColorString(params.color), renderMode);\n    var seriesTooltipResult = dataFormat_1.normalizeTooltipFormatResult(dataModel.formatTooltip(dataIndex, false, dataType));\n    var orderMode = tooltipModel.get('order');\n    var markupText = seriesTooltipResult.markupFragment ? tooltipMarkup_1.buildTooltipMarkup(seriesTooltipResult.markupFragment, markupStyleCreator, renderMode, orderMode, ecModel.get('useUTC')) : seriesTooltipResult.markupText;\n    var asyncTicket = 'item_' + dataModel.name + '_' + dataIndex;\n\n    this._showOrMove(tooltipModel, function () {\n      this._showTooltipContent(tooltipModel, markupText, params, asyncTicket, e.offsetX, e.offsetY, e.position, e.target, markupStyleCreator);\n    });\n\n    dispatchAction({\n      type: 'showTip',\n      dataIndexInside: dataIndex,\n      dataIndex: data.getRawIndex(dataIndex),\n      seriesIndex: seriesIndex,\n      from: this.uid\n    });\n  };\n\n  TooltipView.prototype._showComponentItemTooltip = function (e, el, dispatchAction) {\n    var tooltipOpt = el.tooltip;\n\n    if (zrUtil.isString(tooltipOpt)) {\n      var content = tooltipOpt;\n      tooltipOpt = {\n        content: content,\n        formatter: content\n      };\n    }\n\n    var subTooltipModel = new Model_1[\"default\"](tooltipOpt, this._tooltipModel, this._ecModel);\n    var defaultHtml = subTooltipModel.get('content');\n    var asyncTicket = Math.random() + '';\n    var markupStyleCreator = new tooltipMarkup_1.TooltipMarkupStyleCreator();\n\n    this._showOrMove(subTooltipModel, function () {\n      this._showTooltipContent(subTooltipModel, defaultHtml, subTooltipModel.get('formatterParams') || {}, asyncTicket, e.offsetX, e.offsetY, e.position, el, markupStyleCreator);\n    });\n\n    dispatchAction({\n      type: 'showTip',\n      from: this.uid\n    });\n  };\n\n  TooltipView.prototype._showTooltipContent = function (tooltipModel, defaultHtml, params, asyncTicket, x, y, positionExpr, el, markupStyleCreator) {\n    this._ticket = '';\n\n    if (!tooltipModel.get('showContent') || !tooltipModel.get('show')) {\n      return;\n    }\n\n    var tooltipContent = this._tooltipContent;\n    var formatter = tooltipModel.get('formatter');\n    positionExpr = positionExpr || tooltipModel.get('position');\n    var html = defaultHtml;\n\n    var nearPoint = this._getNearestPoint([x, y], params, tooltipModel.get('trigger'));\n\n    if (formatter && zrUtil.isString(formatter)) {\n      var useUTC = tooltipModel.ecModel.get('useUTC');\n      var params0 = zrUtil.isArray(params) ? params[0] : params;\n      var isTimeAxis = params0 && params0.axisType && params0.axisType.indexOf('time') >= 0;\n      html = formatter;\n\n      if (isTimeAxis) {\n        html = time_1.format(params0.axisValue, html, useUTC);\n      }\n\n      html = formatUtil.formatTpl(html, params, true);\n    } else if (zrUtil.isFunction(formatter)) {\n      var callback = bind(function (cbTicket, html) {\n        if (cbTicket === this._ticket) {\n          tooltipContent.setContent(html, markupStyleCreator, tooltipModel, nearPoint.color, positionExpr);\n\n          this._updatePosition(tooltipModel, positionExpr, x, y, tooltipContent, params, el);\n        }\n      }, this);\n      this._ticket = asyncTicket;\n      html = formatter(params, asyncTicket, callback);\n    }\n\n    tooltipContent.setContent(html, markupStyleCreator, tooltipModel, nearPoint.color, positionExpr);\n    tooltipContent.show(tooltipModel, nearPoint.color);\n\n    this._updatePosition(tooltipModel, positionExpr, x, y, tooltipContent, params, el);\n  };\n\n  TooltipView.prototype._getNearestPoint = function (point, tooltipDataParams, trigger) {\n    if (trigger === 'axis' || zrUtil.isArray(tooltipDataParams)) {\n      return {\n        color: this._renderMode === 'html' ? '#fff' : 'none'\n      };\n    }\n\n    if (!zrUtil.isArray(tooltipDataParams)) {\n      return {\n        color: tooltipDataParams.color || tooltipDataParams.borderColor\n      };\n    }\n  };\n\n  TooltipView.prototype._updatePosition = function (tooltipModel, positionExpr, x, y, content, params, el) {\n    var viewWidth = this._api.getWidth();\n\n    var viewHeight = this._api.getHeight();\n\n    positionExpr = positionExpr || tooltipModel.get('position');\n    var contentSize = content.getSize();\n    var align = tooltipModel.get('align');\n    var vAlign = tooltipModel.get('verticalAlign');\n    var rect = el && el.getBoundingRect().clone();\n    el && rect.applyTransform(el.transform);\n\n    if (zrUtil.isFunction(positionExpr)) {\n      positionExpr = positionExpr([x, y], params, content.el, rect, {\n        viewSize: [viewWidth, viewHeight],\n        contentSize: contentSize.slice()\n      });\n    }\n\n    if (zrUtil.isArray(positionExpr)) {\n      x = parsePercent(positionExpr[0], viewWidth);\n      y = parsePercent(positionExpr[1], viewHeight);\n    } else if (zrUtil.isObject(positionExpr)) {\n      var boxLayoutPosition = positionExpr;\n      boxLayoutPosition.width = contentSize[0];\n      boxLayoutPosition.height = contentSize[1];\n      var layoutRect = layoutUtil.getLayoutRect(boxLayoutPosition, {\n        width: viewWidth,\n        height: viewHeight\n      });\n      x = layoutRect.x;\n      y = layoutRect.y;\n      align = null;\n      vAlign = null;\n    } else if (zrUtil.isString(positionExpr) && el) {\n      var pos = calcTooltipPosition(positionExpr, rect, contentSize);\n      x = pos[0];\n      y = pos[1];\n    } else {\n      var pos = refixTooltipPosition(x, y, content, viewWidth, viewHeight, align ? null : 20, vAlign ? null : 20);\n      x = pos[0];\n      y = pos[1];\n    }\n\n    align && (x -= isCenterAlign(align) ? contentSize[0] / 2 : align === 'right' ? contentSize[0] : 0);\n    vAlign && (y -= isCenterAlign(vAlign) ? contentSize[1] / 2 : vAlign === 'bottom' ? contentSize[1] : 0);\n\n    if (helper_1.shouldTooltipConfine(tooltipModel)) {\n      var pos = confineTooltipPosition(x, y, content, viewWidth, viewHeight);\n      x = pos[0];\n      y = pos[1];\n    }\n\n    content.moveTo(x, y);\n  };\n\n  TooltipView.prototype._updateContentNotChangedOnAxis = function (dataByCoordSys) {\n    var lastCoordSys = this._lastDataByCoordSys;\n    var contentNotChanged = !!lastCoordSys && lastCoordSys.length === dataByCoordSys.length;\n    contentNotChanged && each(lastCoordSys, function (lastItemCoordSys, indexCoordSys) {\n      var lastDataByAxis = lastItemCoordSys.dataByAxis || [];\n      var thisItemCoordSys = dataByCoordSys[indexCoordSys] || {};\n      var thisDataByAxis = thisItemCoordSys.dataByAxis || [];\n      contentNotChanged = contentNotChanged && lastDataByAxis.length === thisDataByAxis.length;\n      contentNotChanged && each(lastDataByAxis, function (lastItem, indexAxis) {\n        var thisItem = thisDataByAxis[indexAxis] || {};\n        var lastIndices = lastItem.seriesDataIndices || [];\n        var newIndices = thisItem.seriesDataIndices || [];\n        contentNotChanged = contentNotChanged && lastItem.value === thisItem.value && lastItem.axisType === thisItem.axisType && lastItem.axisId === thisItem.axisId && lastIndices.length === newIndices.length;\n        contentNotChanged && each(lastIndices, function (lastIdxItem, j) {\n          var newIdxItem = newIndices[j];\n          contentNotChanged = contentNotChanged && lastIdxItem.seriesIndex === newIdxItem.seriesIndex && lastIdxItem.dataIndex === newIdxItem.dataIndex;\n        });\n      });\n    });\n    this._lastDataByCoordSys = dataByCoordSys;\n    return !!contentNotChanged;\n  };\n\n  TooltipView.prototype._hide = function (dispatchAction) {\n    this._lastDataByCoordSys = null;\n    dispatchAction({\n      type: 'hideTip',\n      from: this.uid\n    });\n  };\n\n  TooltipView.prototype.dispose = function (ecModel, api) {\n    if (env_1[\"default\"].node) {\n      return;\n    }\n\n    this._tooltipContent.dispose();\n\n    globalListener.unregister('itemTooltip', api);\n  };\n\n  TooltipView.type = 'tooltip';\n  return TooltipView;\n}(Component_1[\"default\"]);\n\nfunction buildTooltipModel(modelCascade) {\n  var resultModel = modelCascade.pop();\n\n  while (modelCascade.length) {\n    var tooltipOpt = modelCascade.pop();\n\n    if (tooltipOpt) {\n      if (tooltipOpt instanceof Model_1[\"default\"]) {\n        tooltipOpt = tooltipOpt.get('tooltip', true);\n      }\n\n      if (zrUtil.isString(tooltipOpt)) {\n        tooltipOpt = {\n          formatter: tooltipOpt\n        };\n      }\n\n      resultModel = new Model_1[\"default\"](tooltipOpt, resultModel, resultModel.ecModel);\n    }\n  }\n\n  return resultModel;\n}\n\nfunction makeDispatchAction(payload, api) {\n  return payload.dispatchAction || zrUtil.bind(api.dispatchAction, api);\n}\n\nfunction refixTooltipPosition(x, y, content, viewWidth, viewHeight, gapH, gapV) {\n  var size = content.getOuterSize();\n  var width = size.width;\n  var height = size.height;\n\n  if (gapH != null) {\n    if (x + width + gapH + 2 > viewWidth) {\n      x -= width + gapH;\n    } else {\n      x += gapH;\n    }\n  }\n\n  if (gapV != null) {\n    if (y + height + gapV > viewHeight) {\n      y -= height + gapV;\n    } else {\n      y += gapV;\n    }\n  }\n\n  return [x, y];\n}\n\nfunction confineTooltipPosition(x, y, content, viewWidth, viewHeight) {\n  var size = content.getOuterSize();\n  var width = size.width;\n  var height = size.height;\n  x = Math.min(x + width, viewWidth) - width;\n  y = Math.min(y + height, viewHeight) - height;\n  x = Math.max(x, 0);\n  y = Math.max(y, 0);\n  return [x, y];\n}\n\nfunction calcTooltipPosition(position, rect, contentSize) {\n  var domWidth = contentSize[0];\n  var domHeight = contentSize[1];\n  var gap = 10;\n  var offset = 5;\n  var x = 0;\n  var y = 0;\n  var rectWidth = rect.width;\n  var rectHeight = rect.height;\n\n  switch (position) {\n    case 'inside':\n      x = rect.x + rectWidth / 2 - domWidth / 2;\n      y = rect.y + rectHeight / 2 - domHeight / 2;\n      break;\n\n    case 'top':\n      x = rect.x + rectWidth / 2 - domWidth / 2;\n      y = rect.y - domHeight - gap;\n      break;\n\n    case 'bottom':\n      x = rect.x + rectWidth / 2 - domWidth / 2;\n      y = rect.y + rectHeight + gap;\n      break;\n\n    case 'left':\n      x = rect.x - domWidth - gap - offset;\n      y = rect.y + rectHeight / 2 - domHeight / 2;\n      break;\n\n    case 'right':\n      x = rect.x + rectWidth + gap + offset;\n      y = rect.y + rectHeight / 2 - domHeight / 2;\n  }\n\n  return [x, y];\n}\n\nfunction isCenterAlign(align) {\n  return align === 'center' || align === 'middle';\n}\n\nComponent_1[\"default\"].registerClass(TooltipView);","map":{"version":3,"sources":["/Users/wanglijie/wanglijie/clover-defi-wallet/node_modules/echarts/lib/component/tooltip/TooltipView.js"],"names":["exports","__esModule","tslib_1","require","zrUtil","env_1","TooltipHTMLContent_1","TooltipRichContent_1","formatUtil","numberUtil","graphic","findPointFromSeries_1","layoutUtil","Model_1","globalListener","axisHelper","axisPointerViewHelper","model_1","Component_1","time_1","innerStore_1","helper_1","dataFormat_1","tooltipMarkup_1","event_1","bind","each","parsePercent","proxyRect","Rect","shape","x","y","width","height","TooltipView","_super","__extends","_this","apply","arguments","type","prototype","init","ecModel","api","node","tooltipModel","getComponent","renderMode","get","_renderMode","getTooltipRenderMode","_tooltipContent","getDom","appendToBody","render","group","removeAll","_tooltipModel","_ecModel","_api","_alwaysShowContent","tooltipContent","update","setEnterable","_initGlobalListener","_keepShow","triggerOn","register","currTrigger","e","dispatchAction","indexOf","_tryShow","_hide","_lastX","_lastY","self_1","clearTimeout","_refreshUpdateTimeout","setTimeout","isDisposed","manuallyShowTip","dataByCoordSys","_lastDataByCoordSys","payload","from","uid","makeDispatchAction","_ticket","tooltip","el","offsetX","offsetY","target","position","tooltipOption","seriesIndex","_manuallyAxisShowTip","pointInfo","cx","point","cy","getZr","findHover","manuallyHideTip","hideLater","dataIndex","coordSysAxesInfo","seriesModel","getSeriesByIndex","data","getData","tooltipCascadedModel","buildTooltipModel","getItemModel","coordinateSystem","model","length","_showAxisTooltip","findEventDispatcher","getECData","_showSeriesItemTooltip","_showComponentItemTooltip","_showOrMove","cb","delay","_showTimout","globalTooltipModel","singleTooltipModel","cbParamsList","articleMarkup","createTooltipMarkup","blocks","noHeader","markupTextArrLegacy","markupStyleCreator","TooltipMarkupStyleCreator","itemCoordSys","dataByAxis","axisItem","axisModel","axisDim","axisIndex","axisValue","value","axisValueLabel","getValueLabel","axis","seriesDataIndices","valueLabelOpt","axisSectionMarkup","header","trim","sortBlocks","push","idxItem","series","dataIndexInside","cbParams","getDataParams","axisType","axisId","getAxisRawValue","marker","makeTooltipMarker","convertToColorString","color","seriesTooltipResult","normalizeTooltipFormatResult","formatTooltip","markupFragment","markupText","reverse","positionExpr","orderMode","builtMarkupText","buildTooltipMarkup","unshift","blockBreak","allMarkupText","join","_updateContentNotChangedOnAxis","_updatePosition","_showTooltipContent","Math","random","dispatcher","ecData","dataModel","dataType","tooltipTrigger","params","asyncTicket","name","getRawIndex","tooltipOpt","isString","content","formatter","subTooltipModel","defaultHtml","html","nearPoint","_getNearestPoint","useUTC","params0","isArray","isTimeAxis","format","formatTpl","isFunction","callback","cbTicket","setContent","show","tooltipDataParams","trigger","borderColor","viewWidth","getWidth","viewHeight","getHeight","contentSize","getSize","align","vAlign","rect","getBoundingRect","clone","applyTransform","transform","viewSize","slice","isObject","boxLayoutPosition","layoutRect","getLayoutRect","pos","calcTooltipPosition","refixTooltipPosition","isCenterAlign","shouldTooltipConfine","confineTooltipPosition","moveTo","lastCoordSys","contentNotChanged","lastItemCoordSys","indexCoordSys","lastDataByAxis","thisItemCoordSys","thisDataByAxis","lastItem","indexAxis","thisItem","lastIndices","newIndices","lastIdxItem","j","newIdxItem","dispose","unregister","modelCascade","resultModel","pop","gapH","gapV","size","getOuterSize","min","max","domWidth","domHeight","gap","offset","rectWidth","rectHeight","registerClass"],"mappings":"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","sourcesContent":["\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\n\n\n\n/**\n * AUTO-GENERATED FILE. DO NOT MODIFY.\n */\n\n\"use strict\";\n\nexports.__esModule = true;\n\nvar tslib_1 = require(\"tslib\");\n\nvar zrUtil = require(\"zrender/lib/core/util\");\n\nvar env_1 = require(\"zrender/lib/core/env\");\n\nvar TooltipHTMLContent_1 = require(\"./TooltipHTMLContent\");\n\nvar TooltipRichContent_1 = require(\"./TooltipRichContent\");\n\nvar formatUtil = require(\"../../util/format\");\n\nvar numberUtil = require(\"../../util/number\");\n\nvar graphic = require(\"../../util/graphic\");\n\nvar findPointFromSeries_1 = require(\"../axisPointer/findPointFromSeries\");\n\nvar layoutUtil = require(\"../../util/layout\");\n\nvar Model_1 = require(\"../../model/Model\");\n\nvar globalListener = require(\"../axisPointer/globalListener\");\n\nvar axisHelper = require(\"../../coord/axisHelper\");\n\nvar axisPointerViewHelper = require(\"../axisPointer/viewHelper\");\n\nvar model_1 = require(\"../../util/model\");\n\nvar Component_1 = require(\"../../view/Component\");\n\nvar time_1 = require(\"../../util/time\");\n\nvar innerStore_1 = require(\"../../util/innerStore\");\n\nvar helper_1 = require(\"./helper\");\n\nvar dataFormat_1 = require(\"../../model/mixin/dataFormat\");\n\nvar tooltipMarkup_1 = require(\"./tooltipMarkup\");\n\nvar event_1 = require(\"../../util/event\");\n\nvar bind = zrUtil.bind;\nvar each = zrUtil.each;\nvar parsePercent = numberUtil.parsePercent;\nvar proxyRect = new graphic.Rect({\n  shape: {\n    x: -1,\n    y: -1,\n    width: 2,\n    height: 2\n  }\n});\n\nvar TooltipView = function (_super) {\n  tslib_1.__extends(TooltipView, _super);\n\n  function TooltipView() {\n    var _this = _super !== null && _super.apply(this, arguments) || this;\n\n    _this.type = TooltipView.type;\n    return _this;\n  }\n\n  TooltipView.prototype.init = function (ecModel, api) {\n    if (env_1[\"default\"].node) {\n      return;\n    }\n\n    var tooltipModel = ecModel.getComponent('tooltip');\n    var renderMode = tooltipModel.get('renderMode');\n    this._renderMode = model_1.getTooltipRenderMode(renderMode);\n    this._tooltipContent = this._renderMode === 'richText' ? new TooltipRichContent_1[\"default\"](api) : new TooltipHTMLContent_1[\"default\"](api.getDom(), api, {\n      appendToBody: tooltipModel.get('appendToBody', true)\n    });\n  };\n\n  TooltipView.prototype.render = function (tooltipModel, ecModel, api) {\n    if (env_1[\"default\"].node) {\n      return;\n    }\n\n    this.group.removeAll();\n    this._tooltipModel = tooltipModel;\n    this._ecModel = ecModel;\n    this._api = api;\n    this._alwaysShowContent = tooltipModel.get('alwaysShowContent');\n    var tooltipContent = this._tooltipContent;\n    tooltipContent.update(tooltipModel);\n    tooltipContent.setEnterable(tooltipModel.get('enterable'));\n\n    this._initGlobalListener();\n\n    this._keepShow();\n  };\n\n  TooltipView.prototype._initGlobalListener = function () {\n    var tooltipModel = this._tooltipModel;\n    var triggerOn = tooltipModel.get('triggerOn');\n    globalListener.register('itemTooltip', this._api, bind(function (currTrigger, e, dispatchAction) {\n      if (triggerOn !== 'none') {\n        if (triggerOn.indexOf(currTrigger) >= 0) {\n          this._tryShow(e, dispatchAction);\n        } else if (currTrigger === 'leave') {\n          this._hide(dispatchAction);\n        }\n      }\n    }, this));\n  };\n\n  TooltipView.prototype._keepShow = function () {\n    var tooltipModel = this._tooltipModel;\n    var ecModel = this._ecModel;\n    var api = this._api;\n\n    if (this._lastX != null && this._lastY != null && tooltipModel.get('triggerOn') !== 'none') {\n      var self_1 = this;\n      clearTimeout(this._refreshUpdateTimeout);\n      this._refreshUpdateTimeout = setTimeout(function () {\n        !api.isDisposed() && self_1.manuallyShowTip(tooltipModel, ecModel, api, {\n          x: self_1._lastX,\n          y: self_1._lastY,\n          dataByCoordSys: self_1._lastDataByCoordSys\n        });\n      });\n    }\n  };\n\n  TooltipView.prototype.manuallyShowTip = function (tooltipModel, ecModel, api, payload) {\n    if (payload.from === this.uid || env_1[\"default\"].node) {\n      return;\n    }\n\n    var dispatchAction = makeDispatchAction(payload, api);\n    this._ticket = '';\n    var dataByCoordSys = payload.dataByCoordSys;\n\n    if (payload.tooltip && payload.x != null && payload.y != null) {\n      var el = proxyRect;\n      el.x = payload.x;\n      el.y = payload.y;\n      el.update();\n      el.tooltip = payload.tooltip;\n\n      this._tryShow({\n        offsetX: payload.x,\n        offsetY: payload.y,\n        target: el\n      }, dispatchAction);\n    } else if (dataByCoordSys) {\n      this._tryShow({\n        offsetX: payload.x,\n        offsetY: payload.y,\n        position: payload.position,\n        dataByCoordSys: dataByCoordSys,\n        tooltipOption: payload.tooltipOption\n      }, dispatchAction);\n    } else if (payload.seriesIndex != null) {\n      if (this._manuallyAxisShowTip(tooltipModel, ecModel, api, payload)) {\n        return;\n      }\n\n      var pointInfo = findPointFromSeries_1[\"default\"](payload, ecModel);\n      var cx = pointInfo.point[0];\n      var cy = pointInfo.point[1];\n\n      if (cx != null && cy != null) {\n        this._tryShow({\n          offsetX: cx,\n          offsetY: cy,\n          position: payload.position,\n          target: pointInfo.el\n        }, dispatchAction);\n      }\n    } else if (payload.x != null && payload.y != null) {\n      api.dispatchAction({\n        type: 'updateAxisPointer',\n        x: payload.x,\n        y: payload.y\n      });\n\n      this._tryShow({\n        offsetX: payload.x,\n        offsetY: payload.y,\n        position: payload.position,\n        target: api.getZr().findHover(payload.x, payload.y).target\n      }, dispatchAction);\n    }\n  };\n\n  TooltipView.prototype.manuallyHideTip = function (tooltipModel, ecModel, api, payload) {\n    var tooltipContent = this._tooltipContent;\n\n    if (!this._alwaysShowContent && this._tooltipModel) {\n      tooltipContent.hideLater(this._tooltipModel.get('hideDelay'));\n    }\n\n    this._lastX = this._lastY = this._lastDataByCoordSys = null;\n\n    if (payload.from !== this.uid) {\n      this._hide(makeDispatchAction(payload, api));\n    }\n  };\n\n  TooltipView.prototype._manuallyAxisShowTip = function (tooltipModel, ecModel, api, payload) {\n    var seriesIndex = payload.seriesIndex;\n    var dataIndex = payload.dataIndex;\n    var coordSysAxesInfo = ecModel.getComponent('axisPointer').coordSysAxesInfo;\n\n    if (seriesIndex == null || dataIndex == null || coordSysAxesInfo == null) {\n      return;\n    }\n\n    var seriesModel = ecModel.getSeriesByIndex(seriesIndex);\n\n    if (!seriesModel) {\n      return;\n    }\n\n    var data = seriesModel.getData();\n    var tooltipCascadedModel = buildTooltipModel([data.getItemModel(dataIndex), seriesModel, (seriesModel.coordinateSystem || {}).model, tooltipModel]);\n\n    if (tooltipCascadedModel.get('trigger') !== 'axis') {\n      return;\n    }\n\n    api.dispatchAction({\n      type: 'updateAxisPointer',\n      seriesIndex: seriesIndex,\n      dataIndex: dataIndex,\n      position: payload.position\n    });\n    return true;\n  };\n\n  TooltipView.prototype._tryShow = function (e, dispatchAction) {\n    var el = e.target;\n    var tooltipModel = this._tooltipModel;\n\n    if (!tooltipModel) {\n      return;\n    }\n\n    this._lastX = e.offsetX;\n    this._lastY = e.offsetY;\n    var dataByCoordSys = e.dataByCoordSys;\n\n    if (dataByCoordSys && dataByCoordSys.length) {\n      this._showAxisTooltip(dataByCoordSys, e);\n    } else if (el && event_1.findEventDispatcher(el, function (target) {\n      return innerStore_1.getECData(target).dataIndex != null;\n    })) {\n      this._lastDataByCoordSys = null;\n\n      this._showSeriesItemTooltip(e, el, dispatchAction);\n    } else if (el && el.tooltip) {\n      this._lastDataByCoordSys = null;\n\n      this._showComponentItemTooltip(e, el, dispatchAction);\n    } else {\n      this._lastDataByCoordSys = null;\n\n      this._hide(dispatchAction);\n    }\n  };\n\n  TooltipView.prototype._showOrMove = function (tooltipModel, cb) {\n    var delay = tooltipModel.get('showDelay');\n    cb = zrUtil.bind(cb, this);\n    clearTimeout(this._showTimout);\n    delay > 0 ? this._showTimout = setTimeout(cb, delay) : cb();\n  };\n\n  TooltipView.prototype._showAxisTooltip = function (dataByCoordSys, e) {\n    var ecModel = this._ecModel;\n    var globalTooltipModel = this._tooltipModel;\n    var point = [e.offsetX, e.offsetY];\n    var singleTooltipModel = buildTooltipModel([e.tooltipOption, globalTooltipModel]);\n    var renderMode = this._renderMode;\n    var cbParamsList = [];\n    var articleMarkup = tooltipMarkup_1.createTooltipMarkup('section', {\n      blocks: [],\n      noHeader: true\n    });\n    var markupTextArrLegacy = [];\n    var markupStyleCreator = new tooltipMarkup_1.TooltipMarkupStyleCreator();\n    each(dataByCoordSys, function (itemCoordSys) {\n      each(itemCoordSys.dataByAxis, function (axisItem) {\n        var axisModel = ecModel.getComponent(axisItem.axisDim + 'Axis', axisItem.axisIndex);\n        var axisValue = axisItem.value;\n\n        if (!axisModel || axisValue == null) {\n          return;\n        }\n\n        var axisValueLabel = axisPointerViewHelper.getValueLabel(axisValue, axisModel.axis, ecModel, axisItem.seriesDataIndices, axisItem.valueLabelOpt);\n        var axisSectionMarkup = tooltipMarkup_1.createTooltipMarkup('section', {\n          header: axisValueLabel,\n          noHeader: !zrUtil.trim(axisValueLabel),\n          sortBlocks: true,\n          blocks: []\n        });\n        articleMarkup.blocks.push(axisSectionMarkup);\n        zrUtil.each(axisItem.seriesDataIndices, function (idxItem) {\n          var series = ecModel.getSeriesByIndex(idxItem.seriesIndex);\n          var dataIndex = idxItem.dataIndexInside;\n          var cbParams = series.getDataParams(dataIndex);\n          cbParams.axisDim = axisItem.axisDim;\n          cbParams.axisIndex = axisItem.axisIndex;\n          cbParams.axisType = axisItem.axisType;\n          cbParams.axisId = axisItem.axisId;\n          cbParams.axisValue = axisHelper.getAxisRawValue(axisModel.axis, {\n            value: axisValue\n          });\n          cbParams.axisValueLabel = axisValueLabel;\n          cbParams.marker = markupStyleCreator.makeTooltipMarker('item', formatUtil.convertToColorString(cbParams.color), renderMode);\n          var seriesTooltipResult = dataFormat_1.normalizeTooltipFormatResult(series.formatTooltip(dataIndex, true, null));\n\n          if (seriesTooltipResult.markupFragment) {\n            axisSectionMarkup.blocks.push(seriesTooltipResult.markupFragment);\n          }\n\n          if (seriesTooltipResult.markupText) {\n            markupTextArrLegacy.push(seriesTooltipResult.markupText);\n          }\n\n          cbParamsList.push(cbParams);\n        });\n      });\n    });\n    articleMarkup.blocks.reverse();\n    markupTextArrLegacy.reverse();\n    var positionExpr = e.position;\n    var orderMode = singleTooltipModel.get('order');\n    var builtMarkupText = tooltipMarkup_1.buildTooltipMarkup(articleMarkup, markupStyleCreator, renderMode, orderMode, ecModel.get('useUTC'));\n    builtMarkupText && markupTextArrLegacy.unshift(builtMarkupText);\n    var blockBreak = renderMode === 'richText' ? '\\n\\n' : '<br/>';\n    var allMarkupText = markupTextArrLegacy.join(blockBreak);\n\n    this._showOrMove(singleTooltipModel, function () {\n      if (this._updateContentNotChangedOnAxis(dataByCoordSys)) {\n        this._updatePosition(singleTooltipModel, positionExpr, point[0], point[1], this._tooltipContent, cbParamsList);\n      } else {\n        this._showTooltipContent(singleTooltipModel, allMarkupText, cbParamsList, Math.random() + '', point[0], point[1], positionExpr, null, markupStyleCreator);\n      }\n    });\n  };\n\n  TooltipView.prototype._showSeriesItemTooltip = function (e, el, dispatchAction) {\n    var dispatcher = event_1.findEventDispatcher(el, function (target) {\n      return innerStore_1.getECData(target).dataIndex != null;\n    });\n    var ecModel = this._ecModel;\n    var ecData = innerStore_1.getECData(dispatcher);\n    var seriesIndex = ecData.seriesIndex;\n    var seriesModel = ecModel.getSeriesByIndex(seriesIndex);\n    var dataModel = ecData.dataModel || seriesModel;\n    var dataIndex = ecData.dataIndex;\n    var dataType = ecData.dataType;\n    var data = dataModel.getData(dataType);\n    var renderMode = this._renderMode;\n    var tooltipModel = buildTooltipModel([data.getItemModel(dataIndex), dataModel, seriesModel && (seriesModel.coordinateSystem || {}).model, this._tooltipModel]);\n    var tooltipTrigger = tooltipModel.get('trigger');\n\n    if (tooltipTrigger != null && tooltipTrigger !== 'item') {\n      return;\n    }\n\n    var params = dataModel.getDataParams(dataIndex, dataType);\n    var markupStyleCreator = new tooltipMarkup_1.TooltipMarkupStyleCreator();\n    params.marker = markupStyleCreator.makeTooltipMarker('item', formatUtil.convertToColorString(params.color), renderMode);\n    var seriesTooltipResult = dataFormat_1.normalizeTooltipFormatResult(dataModel.formatTooltip(dataIndex, false, dataType));\n    var orderMode = tooltipModel.get('order');\n    var markupText = seriesTooltipResult.markupFragment ? tooltipMarkup_1.buildTooltipMarkup(seriesTooltipResult.markupFragment, markupStyleCreator, renderMode, orderMode, ecModel.get('useUTC')) : seriesTooltipResult.markupText;\n    var asyncTicket = 'item_' + dataModel.name + '_' + dataIndex;\n\n    this._showOrMove(tooltipModel, function () {\n      this._showTooltipContent(tooltipModel, markupText, params, asyncTicket, e.offsetX, e.offsetY, e.position, e.target, markupStyleCreator);\n    });\n\n    dispatchAction({\n      type: 'showTip',\n      dataIndexInside: dataIndex,\n      dataIndex: data.getRawIndex(dataIndex),\n      seriesIndex: seriesIndex,\n      from: this.uid\n    });\n  };\n\n  TooltipView.prototype._showComponentItemTooltip = function (e, el, dispatchAction) {\n    var tooltipOpt = el.tooltip;\n\n    if (zrUtil.isString(tooltipOpt)) {\n      var content = tooltipOpt;\n      tooltipOpt = {\n        content: content,\n        formatter: content\n      };\n    }\n\n    var subTooltipModel = new Model_1[\"default\"](tooltipOpt, this._tooltipModel, this._ecModel);\n    var defaultHtml = subTooltipModel.get('content');\n    var asyncTicket = Math.random() + '';\n    var markupStyleCreator = new tooltipMarkup_1.TooltipMarkupStyleCreator();\n\n    this._showOrMove(subTooltipModel, function () {\n      this._showTooltipContent(subTooltipModel, defaultHtml, subTooltipModel.get('formatterParams') || {}, asyncTicket, e.offsetX, e.offsetY, e.position, el, markupStyleCreator);\n    });\n\n    dispatchAction({\n      type: 'showTip',\n      from: this.uid\n    });\n  };\n\n  TooltipView.prototype._showTooltipContent = function (tooltipModel, defaultHtml, params, asyncTicket, x, y, positionExpr, el, markupStyleCreator) {\n    this._ticket = '';\n\n    if (!tooltipModel.get('showContent') || !tooltipModel.get('show')) {\n      return;\n    }\n\n    var tooltipContent = this._tooltipContent;\n    var formatter = tooltipModel.get('formatter');\n    positionExpr = positionExpr || tooltipModel.get('position');\n    var html = defaultHtml;\n\n    var nearPoint = this._getNearestPoint([x, y], params, tooltipModel.get('trigger'));\n\n    if (formatter && zrUtil.isString(formatter)) {\n      var useUTC = tooltipModel.ecModel.get('useUTC');\n      var params0 = zrUtil.isArray(params) ? params[0] : params;\n      var isTimeAxis = params0 && params0.axisType && params0.axisType.indexOf('time') >= 0;\n      html = formatter;\n\n      if (isTimeAxis) {\n        html = time_1.format(params0.axisValue, html, useUTC);\n      }\n\n      html = formatUtil.formatTpl(html, params, true);\n    } else if (zrUtil.isFunction(formatter)) {\n      var callback = bind(function (cbTicket, html) {\n        if (cbTicket === this._ticket) {\n          tooltipContent.setContent(html, markupStyleCreator, tooltipModel, nearPoint.color, positionExpr);\n\n          this._updatePosition(tooltipModel, positionExpr, x, y, tooltipContent, params, el);\n        }\n      }, this);\n      this._ticket = asyncTicket;\n      html = formatter(params, asyncTicket, callback);\n    }\n\n    tooltipContent.setContent(html, markupStyleCreator, tooltipModel, nearPoint.color, positionExpr);\n    tooltipContent.show(tooltipModel, nearPoint.color);\n\n    this._updatePosition(tooltipModel, positionExpr, x, y, tooltipContent, params, el);\n  };\n\n  TooltipView.prototype._getNearestPoint = function (point, tooltipDataParams, trigger) {\n    if (trigger === 'axis' || zrUtil.isArray(tooltipDataParams)) {\n      return {\n        color: this._renderMode === 'html' ? '#fff' : 'none'\n      };\n    }\n\n    if (!zrUtil.isArray(tooltipDataParams)) {\n      return {\n        color: tooltipDataParams.color || tooltipDataParams.borderColor\n      };\n    }\n  };\n\n  TooltipView.prototype._updatePosition = function (tooltipModel, positionExpr, x, y, content, params, el) {\n    var viewWidth = this._api.getWidth();\n\n    var viewHeight = this._api.getHeight();\n\n    positionExpr = positionExpr || tooltipModel.get('position');\n    var contentSize = content.getSize();\n    var align = tooltipModel.get('align');\n    var vAlign = tooltipModel.get('verticalAlign');\n    var rect = el && el.getBoundingRect().clone();\n    el && rect.applyTransform(el.transform);\n\n    if (zrUtil.isFunction(positionExpr)) {\n      positionExpr = positionExpr([x, y], params, content.el, rect, {\n        viewSize: [viewWidth, viewHeight],\n        contentSize: contentSize.slice()\n      });\n    }\n\n    if (zrUtil.isArray(positionExpr)) {\n      x = parsePercent(positionExpr[0], viewWidth);\n      y = parsePercent(positionExpr[1], viewHeight);\n    } else if (zrUtil.isObject(positionExpr)) {\n      var boxLayoutPosition = positionExpr;\n      boxLayoutPosition.width = contentSize[0];\n      boxLayoutPosition.height = contentSize[1];\n      var layoutRect = layoutUtil.getLayoutRect(boxLayoutPosition, {\n        width: viewWidth,\n        height: viewHeight\n      });\n      x = layoutRect.x;\n      y = layoutRect.y;\n      align = null;\n      vAlign = null;\n    } else if (zrUtil.isString(positionExpr) && el) {\n      var pos = calcTooltipPosition(positionExpr, rect, contentSize);\n      x = pos[0];\n      y = pos[1];\n    } else {\n      var pos = refixTooltipPosition(x, y, content, viewWidth, viewHeight, align ? null : 20, vAlign ? null : 20);\n      x = pos[0];\n      y = pos[1];\n    }\n\n    align && (x -= isCenterAlign(align) ? contentSize[0] / 2 : align === 'right' ? contentSize[0] : 0);\n    vAlign && (y -= isCenterAlign(vAlign) ? contentSize[1] / 2 : vAlign === 'bottom' ? contentSize[1] : 0);\n\n    if (helper_1.shouldTooltipConfine(tooltipModel)) {\n      var pos = confineTooltipPosition(x, y, content, viewWidth, viewHeight);\n      x = pos[0];\n      y = pos[1];\n    }\n\n    content.moveTo(x, y);\n  };\n\n  TooltipView.prototype._updateContentNotChangedOnAxis = function (dataByCoordSys) {\n    var lastCoordSys = this._lastDataByCoordSys;\n    var contentNotChanged = !!lastCoordSys && lastCoordSys.length === dataByCoordSys.length;\n    contentNotChanged && each(lastCoordSys, function (lastItemCoordSys, indexCoordSys) {\n      var lastDataByAxis = lastItemCoordSys.dataByAxis || [];\n      var thisItemCoordSys = dataByCoordSys[indexCoordSys] || {};\n      var thisDataByAxis = thisItemCoordSys.dataByAxis || [];\n      contentNotChanged = contentNotChanged && lastDataByAxis.length === thisDataByAxis.length;\n      contentNotChanged && each(lastDataByAxis, function (lastItem, indexAxis) {\n        var thisItem = thisDataByAxis[indexAxis] || {};\n        var lastIndices = lastItem.seriesDataIndices || [];\n        var newIndices = thisItem.seriesDataIndices || [];\n        contentNotChanged = contentNotChanged && lastItem.value === thisItem.value && lastItem.axisType === thisItem.axisType && lastItem.axisId === thisItem.axisId && lastIndices.length === newIndices.length;\n        contentNotChanged && each(lastIndices, function (lastIdxItem, j) {\n          var newIdxItem = newIndices[j];\n          contentNotChanged = contentNotChanged && lastIdxItem.seriesIndex === newIdxItem.seriesIndex && lastIdxItem.dataIndex === newIdxItem.dataIndex;\n        });\n      });\n    });\n    this._lastDataByCoordSys = dataByCoordSys;\n    return !!contentNotChanged;\n  };\n\n  TooltipView.prototype._hide = function (dispatchAction) {\n    this._lastDataByCoordSys = null;\n    dispatchAction({\n      type: 'hideTip',\n      from: this.uid\n    });\n  };\n\n  TooltipView.prototype.dispose = function (ecModel, api) {\n    if (env_1[\"default\"].node) {\n      return;\n    }\n\n    this._tooltipContent.dispose();\n\n    globalListener.unregister('itemTooltip', api);\n  };\n\n  TooltipView.type = 'tooltip';\n  return TooltipView;\n}(Component_1[\"default\"]);\n\nfunction buildTooltipModel(modelCascade) {\n  var resultModel = modelCascade.pop();\n\n  while (modelCascade.length) {\n    var tooltipOpt = modelCascade.pop();\n\n    if (tooltipOpt) {\n      if (tooltipOpt instanceof Model_1[\"default\"]) {\n        tooltipOpt = tooltipOpt.get('tooltip', true);\n      }\n\n      if (zrUtil.isString(tooltipOpt)) {\n        tooltipOpt = {\n          formatter: tooltipOpt\n        };\n      }\n\n      resultModel = new Model_1[\"default\"](tooltipOpt, resultModel, resultModel.ecModel);\n    }\n  }\n\n  return resultModel;\n}\n\nfunction makeDispatchAction(payload, api) {\n  return payload.dispatchAction || zrUtil.bind(api.dispatchAction, api);\n}\n\nfunction refixTooltipPosition(x, y, content, viewWidth, viewHeight, gapH, gapV) {\n  var size = content.getOuterSize();\n  var width = size.width;\n  var height = size.height;\n\n  if (gapH != null) {\n    if (x + width + gapH + 2 > viewWidth) {\n      x -= width + gapH;\n    } else {\n      x += gapH;\n    }\n  }\n\n  if (gapV != null) {\n    if (y + height + gapV > viewHeight) {\n      y -= height + gapV;\n    } else {\n      y += gapV;\n    }\n  }\n\n  return [x, y];\n}\n\nfunction confineTooltipPosition(x, y, content, viewWidth, viewHeight) {\n  var size = content.getOuterSize();\n  var width = size.width;\n  var height = size.height;\n  x = Math.min(x + width, viewWidth) - width;\n  y = Math.min(y + height, viewHeight) - height;\n  x = Math.max(x, 0);\n  y = Math.max(y, 0);\n  return [x, y];\n}\n\nfunction calcTooltipPosition(position, rect, contentSize) {\n  var domWidth = contentSize[0];\n  var domHeight = contentSize[1];\n  var gap = 10;\n  var offset = 5;\n  var x = 0;\n  var y = 0;\n  var rectWidth = rect.width;\n  var rectHeight = rect.height;\n\n  switch (position) {\n    case 'inside':\n      x = rect.x + rectWidth / 2 - domWidth / 2;\n      y = rect.y + rectHeight / 2 - domHeight / 2;\n      break;\n\n    case 'top':\n      x = rect.x + rectWidth / 2 - domWidth / 2;\n      y = rect.y - domHeight - gap;\n      break;\n\n    case 'bottom':\n      x = rect.x + rectWidth / 2 - domWidth / 2;\n      y = rect.y + rectHeight + gap;\n      break;\n\n    case 'left':\n      x = rect.x - domWidth - gap - offset;\n      y = rect.y + rectHeight / 2 - domHeight / 2;\n      break;\n\n    case 'right':\n      x = rect.x + rectWidth + gap + offset;\n      y = rect.y + rectHeight / 2 - domHeight / 2;\n  }\n\n  return [x, y];\n}\n\nfunction isCenterAlign(align) {\n  return align === 'center' || align === 'middle';\n}\n\nComponent_1[\"default\"].registerClass(TooltipView);"]},"metadata":{},"sourceType":"script"}