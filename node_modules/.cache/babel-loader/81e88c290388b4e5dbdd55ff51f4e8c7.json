{"ast":null,"code":"import { __assign } from \"tslib\";\nimport { deepMix } from '@antv/util';\nimport Button from './timeButton';\nvar DEFAULT_RECT_FILL = '#ccc';\nvar DEFAULT_RECT_STROKE = 'green';\nvar DEFAULT_PLAYBTN_STYLE = {\n  fill: '#607889',\n  stroke: '#607889'\n};\nvar DEFAULT_PREBTN_STYLE = {\n  fill: '#fff'\n};\nvar DEFAULT_NEXTBTN_STYLE = {\n  fill: 'green'\n};\nvar DEFAULT_CONTROLLER_CONFIG = {\n  speed: 2,\n  loop: false,\n  fill: '#fff',\n  stroke: '#fff',\n  hiddleToggle: false,\n  preBtnStyle: {\n    fill: '#ccc',\n    stroke: '#ccc'\n  },\n  nextBtnStyle: {\n    fill: '#ccc',\n    stroke: '#ccc'\n  },\n  playBtnStyle: {\n    fill: '#fff',\n    stroke: '#ccc'\n  }\n};\nvar SPEED_CONTROLLER_OFFSET = 110;\nvar TOGGLE_MODEL_OFFSET = 50;\n\nvar ControllerBtn =\n/** @class */\nfunction () {\n  function ControllerBtn(cfg) {\n    this.controllerCfg = deepMix({}, DEFAULT_CONTROLLER_CONFIG, cfg);\n    this.group = cfg.group;\n    this.speedAxisY = [];\n    this.currentSpeed = this.controllerCfg.speed;\n    this.currentType = 'range';\n    this.init();\n  }\n\n  ControllerBtn.prototype.init = function () {\n    this.renderPlayButton();\n  };\n  /** 获取播放键 marker path */\n\n\n  ControllerBtn.prototype.getNextMarkerPath = function (x, y, len) {\n    return [['M', x, y - len], ['L', x + len, y], ['L', x, y + len]];\n  };\n\n  ControllerBtn.prototype.getPreMarkerPath = function (x, y, len) {\n    return [['M', x, y - len], ['L', x - len, y], ['L', x, y + len]];\n  };\n\n  ControllerBtn.prototype.renderPlayButton = function () {\n    var controllerCfg = this.controllerCfg;\n    var width = controllerCfg.width,\n        height = controllerCfg.height,\n        x = controllerCfg.x,\n        y = controllerCfg.y,\n        hiddleToggle = controllerCfg.hiddleToggle,\n        _a = controllerCfg.fill,\n        fill = _a === void 0 ? DEFAULT_RECT_FILL : _a,\n        _b = controllerCfg.stroke,\n        stroke = _b === void 0 ? DEFAULT_RECT_STROKE : _b,\n        _c = controllerCfg.playBtnStyle,\n        playBtnStyle = _c === void 0 ? DEFAULT_PLAYBTN_STYLE : _c,\n        _d = controllerCfg.preBtnStyle,\n        preBtnStyle = _d === void 0 ? DEFAULT_PREBTN_STYLE : _d,\n        _e = controllerCfg.nextBtnStyle,\n        nextBtnStyle = _e === void 0 ? DEFAULT_NEXTBTN_STYLE : _e;\n    var r = height / 2 - 5;\n    var realY = y + 10; // 绘制最外层的矩形包围框\n\n    var container = this.group.addShape('rect', {\n      attrs: {\n        x: x,\n        y: realY,\n        width: width,\n        height: height,\n        stroke: stroke,\n        fill: fill\n      },\n      name: 'container-rect'\n    });\n\n    if (this.playButton) {\n      this.playButton.update({\n        x: width / 2,\n        y: realY,\n        r: r\n      });\n    } else {\n      this.playButton = new Button({\n        group: this.group,\n        x: width / 2,\n        y: realY + r + 5,\n        r: r,\n        isPlay: this.isPlay,\n        style: playBtnStyle\n      });\n    } // 后退按钮\n\n\n    this.group.addShape('path', {\n      attrs: __assign({\n        path: this.getPreMarkerPath(width / 2 - 5 * r, realY + r + 5, r * 0.5)\n      }, preBtnStyle),\n      name: 'preStepBtn'\n    });\n    this.group.addShape('path', {\n      attrs: __assign({\n        path: this.getPreMarkerPath(width / 2 - 4.5 * r, realY + r + 5, r * 0.5)\n      }, preBtnStyle),\n      name: 'preStepBtn'\n    }); // 前进按钮\n\n    this.group.addShape('path', {\n      attrs: __assign({\n        path: this.getNextMarkerPath(width / 2 + 5 * r, realY + r + 5, r * 0.5)\n      }, nextBtnStyle),\n      name: 'nextStepBtn'\n    });\n    this.group.addShape('path', {\n      attrs: __assign({\n        path: this.getNextMarkerPath(width / 2 + 4.5 * r, realY + r + 5, r * 0.5)\n      }, nextBtnStyle),\n      name: 'nextStepBtn'\n    });\n    container.toBack(); // 调节speed的按钮\n\n    this.renderSpeedBtn();\n\n    if (!hiddleToggle) {\n      this.renderToggleTime();\n    }\n\n    this.bindEvent();\n  };\n\n  ControllerBtn.prototype.renderSpeedBtn = function () {\n    var _a = this.controllerCfg,\n        y = _a.y,\n        width = _a.width,\n        hiddleToggle = _a.hiddleToggle;\n    var speedGroup = this.group.addGroup({\n      name: 'speed-group'\n    });\n    this.speedGroup = speedGroup;\n    var count = 1;\n    var speedNum = [];\n    var maxSpeed = 9; // 增加speed刻度\n\n    for (var i = 0; i < 5; i++) {\n      var axisY = y + 15 + i * (i + 1) + count; // 灰色刻度\n\n      speedGroup.addShape('rect', {\n        attrs: {\n          x: width - (!hiddleToggle ? SPEED_CONTROLLER_OFFSET : TOGGLE_MODEL_OFFSET),\n          y: axisY,\n          width: 15,\n          height: 2,\n          fill: '#ccc'\n        },\n        speed: maxSpeed,\n        name: 'speed-rect'\n      });\n      this.speedAxisY.push(axisY);\n      speedNum.push(maxSpeed);\n      maxSpeed = maxSpeed - 2;\n      count++;\n    }\n\n    for (var i = 0; i < 4; i++) {\n      // 灰色刻度\n      speedGroup.addShape('rect', {\n        attrs: {\n          x: width - (!hiddleToggle ? SPEED_CONTROLLER_OFFSET : TOGGLE_MODEL_OFFSET),\n          y: this.speedAxisY[i] + 2,\n          width: 15,\n          height: 2 * i + 1,\n          fill: '#fff',\n          opacity: 0.3\n        },\n        speed: speedNum[i] - 1,\n        name: 'speed-rect'\n      });\n    } // 速度文本\n\n\n    this.speedText = speedGroup.addShape('text', {\n      attrs: {\n        x: width - (!hiddleToggle ? SPEED_CONTROLLER_OFFSET : TOGGLE_MODEL_OFFSET) + 20,\n        y: this.speedAxisY[1] + 15,\n        text: \"1.0X\",\n        fill: '#ccc'\n      }\n    });\n    this.speedPoint = speedGroup.addShape('path', {\n      attrs: {\n        path: this.getPath(width - (!hiddleToggle ? SPEED_CONTROLLER_OFFSET : TOGGLE_MODEL_OFFSET), this.speedAxisY[4]),\n        fill: '#ccc'\n      }\n    });\n  };\n\n  ControllerBtn.prototype.getPath = function (x, y) {\n    return [['M', x, y], ['L', x - 12, y - 6], ['L', x - 12, y + 6], ['Z']];\n  };\n\n  ControllerBtn.prototype.renderToggleTime = function () {\n    var width = this.controllerCfg.width;\n    this.toggleGroup = this.group.addGroup({\n      name: 'toggle-group'\n    });\n    this.toggleGroup.addShape('rect', {\n      attrs: {\n        width: 14,\n        height: 14,\n        x: width - TOGGLE_MODEL_OFFSET,\n        y: this.speedAxisY[1],\n        fill: '#fff',\n        stroke: '#ccc',\n        lineWidth: 2,\n        radius: 3\n      },\n      isChecked: false,\n      name: 'toggle-model'\n    });\n    this.checkedIcon = this.toggleGroup.addShape('path', {\n      attrs: {\n        path: [['M', width - TOGGLE_MODEL_OFFSET + 3, this.speedAxisY[1] + 6], ['L', width - TOGGLE_MODEL_OFFSET + 7, this.speedAxisY[1] + 10], ['L', width - TOGGLE_MODEL_OFFSET + 12, this.speedAxisY[1] + 4]],\n        stroke: 'green',\n        lineWidth: 3\n      },\n      capture: false\n    });\n    this.checkedIcon.hide();\n    this.checkedText = this.toggleGroup.addShape('text', {\n      attrs: {\n        text: '单一时间',\n        x: width - TOGGLE_MODEL_OFFSET + 20,\n        y: this.speedAxisY[1] + 15,\n        fill: '#ccc'\n      }\n    });\n  };\n\n  ControllerBtn.prototype.bindEvent = function () {\n    var _this = this;\n\n    var _a = this.controllerCfg,\n        width = _a.width,\n        hiddleToggle = _a.hiddleToggle;\n    this.speedGroup.on('speed-rect:click', function (evt) {\n      _this.speedPoint.attr('path', _this.getPath(width - (!hiddleToggle ? SPEED_CONTROLLER_OFFSET : TOGGLE_MODEL_OFFSET), evt.y));\n\n      _this.currentSpeed = evt.target.get('speed');\n\n      _this.speedText.attr('text', _this.currentSpeed + \".0X\");\n\n      _this.group.emit('timebarConfigChanged', {\n        speed: _this.currentSpeed,\n        type: _this.currentType\n      });\n    });\n\n    if (this.toggleGroup) {\n      this.toggleGroup.on('toggle-model:click', function (evt) {\n        var isChecked = evt.target.get('isChecked');\n\n        if (!isChecked) {\n          _this.checkedIcon.show();\n\n          _this.checkedText.attr('text', '时间范围');\n\n          _this.currentType = 'single';\n        } else {\n          _this.checkedIcon.hide();\n\n          _this.checkedText.attr('text', '单一时间');\n\n          _this.currentType = 'range';\n        }\n\n        evt.target.set('isChecked', !isChecked);\n\n        _this.group.emit('timebarConfigChanged', {\n          type: _this.currentType,\n          speed: _this.currentSpeed\n        });\n      });\n    }\n  };\n\n  ControllerBtn.prototype.destroy = function () {\n    this.speedGroup.off('speed-rect:click');\n\n    if (this.toggleGroup) {\n      this.toggleGroup.off('toggle-model:click');\n      this.toggleGroup.destroy();\n    }\n\n    this.speedGroup.destroy();\n  };\n\n  return ControllerBtn;\n}();\n\nexport default ControllerBtn;","map":{"version":3,"sources":["/Users/wanglijie/wanglijie/clover-defi-wallet/node_modules/@antv/g6/es/plugins/timeBar/controllerBtn.js"],"names":["__assign","deepMix","Button","DEFAULT_RECT_FILL","DEFAULT_RECT_STROKE","DEFAULT_PLAYBTN_STYLE","fill","stroke","DEFAULT_PREBTN_STYLE","DEFAULT_NEXTBTN_STYLE","DEFAULT_CONTROLLER_CONFIG","speed","loop","hiddleToggle","preBtnStyle","nextBtnStyle","playBtnStyle","SPEED_CONTROLLER_OFFSET","TOGGLE_MODEL_OFFSET","ControllerBtn","cfg","controllerCfg","group","speedAxisY","currentSpeed","currentType","init","prototype","renderPlayButton","getNextMarkerPath","x","y","len","getPreMarkerPath","width","height","_a","_b","_c","_d","_e","r","realY","container","addShape","attrs","name","playButton","update","isPlay","style","path","toBack","renderSpeedBtn","renderToggleTime","bindEvent","speedGroup","addGroup","count","speedNum","maxSpeed","i","axisY","push","opacity","speedText","text","speedPoint","getPath","toggleGroup","lineWidth","radius","isChecked","checkedIcon","capture","hide","checkedText","_this","on","evt","attr","target","get","emit","type","show","set","destroy","off"],"mappings":"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","sourcesContent":["import { __assign } from \"tslib\";\nimport { deepMix } from '@antv/util';\nimport Button from './timeButton';\nvar DEFAULT_RECT_FILL = '#ccc';\nvar DEFAULT_RECT_STROKE = 'green';\nvar DEFAULT_PLAYBTN_STYLE = {\n  fill: '#607889',\n  stroke: '#607889'\n};\nvar DEFAULT_PREBTN_STYLE = {\n  fill: '#fff'\n};\nvar DEFAULT_NEXTBTN_STYLE = {\n  fill: 'green'\n};\nvar DEFAULT_CONTROLLER_CONFIG = {\n  speed: 2,\n  loop: false,\n  fill: '#fff',\n  stroke: '#fff',\n  hiddleToggle: false,\n  preBtnStyle: {\n    fill: '#ccc',\n    stroke: '#ccc'\n  },\n  nextBtnStyle: {\n    fill: '#ccc',\n    stroke: '#ccc'\n  },\n  playBtnStyle: {\n    fill: '#fff',\n    stroke: '#ccc'\n  }\n};\nvar SPEED_CONTROLLER_OFFSET = 110;\nvar TOGGLE_MODEL_OFFSET = 50;\n\nvar ControllerBtn =\n/** @class */\nfunction () {\n  function ControllerBtn(cfg) {\n    this.controllerCfg = deepMix({}, DEFAULT_CONTROLLER_CONFIG, cfg);\n    this.group = cfg.group;\n    this.speedAxisY = [];\n    this.currentSpeed = this.controllerCfg.speed;\n    this.currentType = 'range';\n    this.init();\n  }\n\n  ControllerBtn.prototype.init = function () {\n    this.renderPlayButton();\n  };\n  /** 获取播放键 marker path */\n\n\n  ControllerBtn.prototype.getNextMarkerPath = function (x, y, len) {\n    return [['M', x, y - len], ['L', x + len, y], ['L', x, y + len]];\n  };\n\n  ControllerBtn.prototype.getPreMarkerPath = function (x, y, len) {\n    return [['M', x, y - len], ['L', x - len, y], ['L', x, y + len]];\n  };\n\n  ControllerBtn.prototype.renderPlayButton = function () {\n    var controllerCfg = this.controllerCfg;\n    var width = controllerCfg.width,\n        height = controllerCfg.height,\n        x = controllerCfg.x,\n        y = controllerCfg.y,\n        hiddleToggle = controllerCfg.hiddleToggle,\n        _a = controllerCfg.fill,\n        fill = _a === void 0 ? DEFAULT_RECT_FILL : _a,\n        _b = controllerCfg.stroke,\n        stroke = _b === void 0 ? DEFAULT_RECT_STROKE : _b,\n        _c = controllerCfg.playBtnStyle,\n        playBtnStyle = _c === void 0 ? DEFAULT_PLAYBTN_STYLE : _c,\n        _d = controllerCfg.preBtnStyle,\n        preBtnStyle = _d === void 0 ? DEFAULT_PREBTN_STYLE : _d,\n        _e = controllerCfg.nextBtnStyle,\n        nextBtnStyle = _e === void 0 ? DEFAULT_NEXTBTN_STYLE : _e;\n    var r = height / 2 - 5;\n    var realY = y + 10; // 绘制最外层的矩形包围框\n\n    var container = this.group.addShape('rect', {\n      attrs: {\n        x: x,\n        y: realY,\n        width: width,\n        height: height,\n        stroke: stroke,\n        fill: fill\n      },\n      name: 'container-rect'\n    });\n\n    if (this.playButton) {\n      this.playButton.update({\n        x: width / 2,\n        y: realY,\n        r: r\n      });\n    } else {\n      this.playButton = new Button({\n        group: this.group,\n        x: width / 2,\n        y: realY + r + 5,\n        r: r,\n        isPlay: this.isPlay,\n        style: playBtnStyle\n      });\n    } // 后退按钮\n\n\n    this.group.addShape('path', {\n      attrs: __assign({\n        path: this.getPreMarkerPath(width / 2 - 5 * r, realY + r + 5, r * 0.5)\n      }, preBtnStyle),\n      name: 'preStepBtn'\n    });\n    this.group.addShape('path', {\n      attrs: __assign({\n        path: this.getPreMarkerPath(width / 2 - 4.5 * r, realY + r + 5, r * 0.5)\n      }, preBtnStyle),\n      name: 'preStepBtn'\n    }); // 前进按钮\n\n    this.group.addShape('path', {\n      attrs: __assign({\n        path: this.getNextMarkerPath(width / 2 + 5 * r, realY + r + 5, r * 0.5)\n      }, nextBtnStyle),\n      name: 'nextStepBtn'\n    });\n    this.group.addShape('path', {\n      attrs: __assign({\n        path: this.getNextMarkerPath(width / 2 + 4.5 * r, realY + r + 5, r * 0.5)\n      }, nextBtnStyle),\n      name: 'nextStepBtn'\n    });\n    container.toBack(); // 调节speed的按钮\n\n    this.renderSpeedBtn();\n\n    if (!hiddleToggle) {\n      this.renderToggleTime();\n    }\n\n    this.bindEvent();\n  };\n\n  ControllerBtn.prototype.renderSpeedBtn = function () {\n    var _a = this.controllerCfg,\n        y = _a.y,\n        width = _a.width,\n        hiddleToggle = _a.hiddleToggle;\n    var speedGroup = this.group.addGroup({\n      name: 'speed-group'\n    });\n    this.speedGroup = speedGroup;\n    var count = 1;\n    var speedNum = [];\n    var maxSpeed = 9; // 增加speed刻度\n\n    for (var i = 0; i < 5; i++) {\n      var axisY = y + 15 + i * (i + 1) + count; // 灰色刻度\n\n      speedGroup.addShape('rect', {\n        attrs: {\n          x: width - (!hiddleToggle ? SPEED_CONTROLLER_OFFSET : TOGGLE_MODEL_OFFSET),\n          y: axisY,\n          width: 15,\n          height: 2,\n          fill: '#ccc'\n        },\n        speed: maxSpeed,\n        name: 'speed-rect'\n      });\n      this.speedAxisY.push(axisY);\n      speedNum.push(maxSpeed);\n      maxSpeed = maxSpeed - 2;\n      count++;\n    }\n\n    for (var i = 0; i < 4; i++) {\n      // 灰色刻度\n      speedGroup.addShape('rect', {\n        attrs: {\n          x: width - (!hiddleToggle ? SPEED_CONTROLLER_OFFSET : TOGGLE_MODEL_OFFSET),\n          y: this.speedAxisY[i] + 2,\n          width: 15,\n          height: 2 * i + 1,\n          fill: '#fff',\n          opacity: 0.3\n        },\n        speed: speedNum[i] - 1,\n        name: 'speed-rect'\n      });\n    } // 速度文本\n\n\n    this.speedText = speedGroup.addShape('text', {\n      attrs: {\n        x: width - (!hiddleToggle ? SPEED_CONTROLLER_OFFSET : TOGGLE_MODEL_OFFSET) + 20,\n        y: this.speedAxisY[1] + 15,\n        text: \"1.0X\",\n        fill: '#ccc'\n      }\n    });\n    this.speedPoint = speedGroup.addShape('path', {\n      attrs: {\n        path: this.getPath(width - (!hiddleToggle ? SPEED_CONTROLLER_OFFSET : TOGGLE_MODEL_OFFSET), this.speedAxisY[4]),\n        fill: '#ccc'\n      }\n    });\n  };\n\n  ControllerBtn.prototype.getPath = function (x, y) {\n    return [['M', x, y], ['L', x - 12, y - 6], ['L', x - 12, y + 6], ['Z']];\n  };\n\n  ControllerBtn.prototype.renderToggleTime = function () {\n    var width = this.controllerCfg.width;\n    this.toggleGroup = this.group.addGroup({\n      name: 'toggle-group'\n    });\n    this.toggleGroup.addShape('rect', {\n      attrs: {\n        width: 14,\n        height: 14,\n        x: width - TOGGLE_MODEL_OFFSET,\n        y: this.speedAxisY[1],\n        fill: '#fff',\n        stroke: '#ccc',\n        lineWidth: 2,\n        radius: 3\n      },\n      isChecked: false,\n      name: 'toggle-model'\n    });\n    this.checkedIcon = this.toggleGroup.addShape('path', {\n      attrs: {\n        path: [['M', width - TOGGLE_MODEL_OFFSET + 3, this.speedAxisY[1] + 6], ['L', width - TOGGLE_MODEL_OFFSET + 7, this.speedAxisY[1] + 10], ['L', width - TOGGLE_MODEL_OFFSET + 12, this.speedAxisY[1] + 4]],\n        stroke: 'green',\n        lineWidth: 3\n      },\n      capture: false\n    });\n    this.checkedIcon.hide();\n    this.checkedText = this.toggleGroup.addShape('text', {\n      attrs: {\n        text: '单一时间',\n        x: width - TOGGLE_MODEL_OFFSET + 20,\n        y: this.speedAxisY[1] + 15,\n        fill: '#ccc'\n      }\n    });\n  };\n\n  ControllerBtn.prototype.bindEvent = function () {\n    var _this = this;\n\n    var _a = this.controllerCfg,\n        width = _a.width,\n        hiddleToggle = _a.hiddleToggle;\n    this.speedGroup.on('speed-rect:click', function (evt) {\n      _this.speedPoint.attr('path', _this.getPath(width - (!hiddleToggle ? SPEED_CONTROLLER_OFFSET : TOGGLE_MODEL_OFFSET), evt.y));\n\n      _this.currentSpeed = evt.target.get('speed');\n\n      _this.speedText.attr('text', _this.currentSpeed + \".0X\");\n\n      _this.group.emit('timebarConfigChanged', {\n        speed: _this.currentSpeed,\n        type: _this.currentType\n      });\n    });\n\n    if (this.toggleGroup) {\n      this.toggleGroup.on('toggle-model:click', function (evt) {\n        var isChecked = evt.target.get('isChecked');\n\n        if (!isChecked) {\n          _this.checkedIcon.show();\n\n          _this.checkedText.attr('text', '时间范围');\n\n          _this.currentType = 'single';\n        } else {\n          _this.checkedIcon.hide();\n\n          _this.checkedText.attr('text', '单一时间');\n\n          _this.currentType = 'range';\n        }\n\n        evt.target.set('isChecked', !isChecked);\n\n        _this.group.emit('timebarConfigChanged', {\n          type: _this.currentType,\n          speed: _this.currentSpeed\n        });\n      });\n    }\n  };\n\n  ControllerBtn.prototype.destroy = function () {\n    this.speedGroup.off('speed-rect:click');\n\n    if (this.toggleGroup) {\n      this.toggleGroup.off('toggle-model:click');\n      this.toggleGroup.destroy();\n    }\n\n    this.speedGroup.destroy();\n  };\n\n  return ControllerBtn;\n}();\n\nexport default ControllerBtn;"]},"metadata":{},"sourceType":"module"}