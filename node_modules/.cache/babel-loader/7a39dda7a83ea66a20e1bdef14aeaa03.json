{"ast":null,"code":"var DEFAULT_TRIGGER = 'click';\nvar ALLOW_EVENTS = ['click', 'dblclick'];\nexport default {\n  getDefaultCfg: function getDefaultCfg() {\n    return {\n      /**\n       * 发生收缩/扩展变化时的回调\n       */\n      trigger: DEFAULT_TRIGGER,\n      onChange: function onChange() {}\n    };\n  },\n  getEvents: function getEvents() {\n    var _a;\n\n    var trigger; // 检测输入是否合法\n\n    if (ALLOW_EVENTS.includes(this.trigger)) {\n      trigger = this.trigger;\n    } else {\n      trigger = DEFAULT_TRIGGER; // eslint-disable-next-line no-console\n\n      console.warn(\"Behavior collapse-expand 的 trigger 参数不合法，请输入 'click' 或 'dblclick'\");\n    }\n\n    return _a = {}, _a[\"node:\" + trigger] = 'onNodeClick', // 支持移动端事件\n    _a['touchstart'] = 'onNodeClick', _a;\n  },\n  onNodeClick: function onNodeClick(e) {\n    var item = e.item; // 如果节点进行过更新，model 会进行 merge，直接改 model 就不能改布局，所以需要去改源数据\n\n    var sourceData = this.graph.findDataById(item.get('id'));\n\n    if (!sourceData) {\n      return;\n    }\n\n    var children = sourceData.children; // 叶子节点的收缩和展开没有意义\n\n    if (!children || children.length === 0) {\n      return;\n    }\n\n    var collapsed = !sourceData.collapsed;\n\n    if (!this.shouldBegin(e, collapsed)) {\n      return;\n    }\n\n    sourceData.collapsed = collapsed;\n    item.getModel().collapsed = collapsed;\n    this.graph.emit('itemcollapsed', {\n      item: e.item,\n      collapsed: collapsed\n    });\n\n    if (!this.shouldUpdate(e, collapsed)) {\n      return;\n    }\n\n    try {\n      this.onChange(item, collapsed);\n    } catch (err) {\n      // eslint-disable-next-line no-console\n      console.warn('G6 自 3.0.4 版本支持直接从 item.getModel() 获取源数据(临时通知，将在3.2.0版本中清除)', err);\n    }\n\n    this.graph.layout();\n  }\n};","map":{"version":3,"sources":["/Users/wanglijie/wanglijie/clover-defi-wallet/node_modules/@antv/g6/es/behavior/collapse-expand.js"],"names":["DEFAULT_TRIGGER","ALLOW_EVENTS","getDefaultCfg","trigger","onChange","getEvents","_a","includes","console","warn","onNodeClick","e","item","sourceData","graph","findDataById","get","children","length","collapsed","shouldBegin","getModel","emit","shouldUpdate","err","layout"],"mappings":"AAAA,IAAIA,eAAe,GAAG,OAAtB;AACA,IAAIC,YAAY,GAAG,CAAC,OAAD,EAAU,UAAV,CAAnB;AACA,eAAe;AACbC,EAAAA,aAAa,EAAE,SAASA,aAAT,GAAyB;AACtC,WAAO;AACL;AACN;AACA;AACMC,MAAAA,OAAO,EAAEH,eAJJ;AAKLI,MAAAA,QAAQ,EAAE,SAASA,QAAT,GAAoB,CAAE;AAL3B,KAAP;AAOD,GATY;AAUbC,EAAAA,SAAS,EAAE,SAASA,SAAT,GAAqB;AAC9B,QAAIC,EAAJ;;AAEA,QAAIH,OAAJ,CAH8B,CAGjB;;AAEb,QAAIF,YAAY,CAACM,QAAb,CAAsB,KAAKJ,OAA3B,CAAJ,EAAyC;AACvCA,MAAAA,OAAO,GAAG,KAAKA,OAAf;AACD,KAFD,MAEO;AACLA,MAAAA,OAAO,GAAGH,eAAV,CADK,CACsB;;AAE3BQ,MAAAA,OAAO,CAACC,IAAR,CAAa,mEAAb;AACD;;AAED,WAAOH,EAAE,GAAG,EAAL,EAASA,EAAE,CAAC,UAAUH,OAAX,CAAF,GAAwB,aAAjC,EAAgD;AACvDG,IAAAA,EAAE,CAAC,YAAD,CAAF,GAAmB,aADZ,EAC2BA,EADlC;AAED,GAzBY;AA0BbI,EAAAA,WAAW,EAAE,SAASA,WAAT,CAAqBC,CAArB,EAAwB;AACnC,QAAIC,IAAI,GAAGD,CAAC,CAACC,IAAb,CADmC,CAChB;;AAEnB,QAAIC,UAAU,GAAG,KAAKC,KAAL,CAAWC,YAAX,CAAwBH,IAAI,CAACI,GAAL,CAAS,IAAT,CAAxB,CAAjB;;AAEA,QAAI,CAACH,UAAL,EAAiB;AACf;AACD;;AAED,QAAII,QAAQ,GAAGJ,UAAU,CAACI,QAA1B,CATmC,CASC;;AAEpC,QAAI,CAACA,QAAD,IAAaA,QAAQ,CAACC,MAAT,KAAoB,CAArC,EAAwC;AACtC;AACD;;AAED,QAAIC,SAAS,GAAG,CAACN,UAAU,CAACM,SAA5B;;AAEA,QAAI,CAAC,KAAKC,WAAL,CAAiBT,CAAjB,EAAoBQ,SAApB,CAAL,EAAqC;AACnC;AACD;;AAEDN,IAAAA,UAAU,CAACM,SAAX,GAAuBA,SAAvB;AACAP,IAAAA,IAAI,CAACS,QAAL,GAAgBF,SAAhB,GAA4BA,SAA5B;AACA,SAAKL,KAAL,CAAWQ,IAAX,CAAgB,eAAhB,EAAiC;AAC/BV,MAAAA,IAAI,EAAED,CAAC,CAACC,IADuB;AAE/BO,MAAAA,SAAS,EAAEA;AAFoB,KAAjC;;AAKA,QAAI,CAAC,KAAKI,YAAL,CAAkBZ,CAAlB,EAAqBQ,SAArB,CAAL,EAAsC;AACpC;AACD;;AAED,QAAI;AACF,WAAKf,QAAL,CAAcQ,IAAd,EAAoBO,SAApB;AACD,KAFD,CAEE,OAAOK,GAAP,EAAY;AACZ;AACAhB,MAAAA,OAAO,CAACC,IAAR,CAAa,6DAAb,EAA4Ee,GAA5E;AACD;;AAED,SAAKV,KAAL,CAAWW,MAAX;AACD;AAlEY,CAAf","sourcesContent":["var DEFAULT_TRIGGER = 'click';\nvar ALLOW_EVENTS = ['click', 'dblclick'];\nexport default {\n  getDefaultCfg: function getDefaultCfg() {\n    return {\n      /**\n       * 发生收缩/扩展变化时的回调\n       */\n      trigger: DEFAULT_TRIGGER,\n      onChange: function onChange() {}\n    };\n  },\n  getEvents: function getEvents() {\n    var _a;\n\n    var trigger; // 检测输入是否合法\n\n    if (ALLOW_EVENTS.includes(this.trigger)) {\n      trigger = this.trigger;\n    } else {\n      trigger = DEFAULT_TRIGGER; // eslint-disable-next-line no-console\n\n      console.warn(\"Behavior collapse-expand 的 trigger 参数不合法，请输入 'click' 或 'dblclick'\");\n    }\n\n    return _a = {}, _a[\"node:\" + trigger] = 'onNodeClick', // 支持移动端事件\n    _a['touchstart'] = 'onNodeClick', _a;\n  },\n  onNodeClick: function onNodeClick(e) {\n    var item = e.item; // 如果节点进行过更新，model 会进行 merge，直接改 model 就不能改布局，所以需要去改源数据\n\n    var sourceData = this.graph.findDataById(item.get('id'));\n\n    if (!sourceData) {\n      return;\n    }\n\n    var children = sourceData.children; // 叶子节点的收缩和展开没有意义\n\n    if (!children || children.length === 0) {\n      return;\n    }\n\n    var collapsed = !sourceData.collapsed;\n\n    if (!this.shouldBegin(e, collapsed)) {\n      return;\n    }\n\n    sourceData.collapsed = collapsed;\n    item.getModel().collapsed = collapsed;\n    this.graph.emit('itemcollapsed', {\n      item: e.item,\n      collapsed: collapsed\n    });\n\n    if (!this.shouldUpdate(e, collapsed)) {\n      return;\n    }\n\n    try {\n      this.onChange(item, collapsed);\n    } catch (err) {\n      // eslint-disable-next-line no-console\n      console.warn('G6 自 3.0.4 版本支持直接从 item.getModel() 获取源数据(临时通知，将在3.2.0版本中清除)', err);\n    }\n\n    this.graph.layout();\n  }\n};"]},"metadata":{},"sourceType":"module"}