{"ast":null,"code":"import { __assign, __rest } from \"tslib\";\nimport { mix } from '@antv/util';\nimport Global from '../../global';\nimport Shape from '../shape'; // 五角星shape\n\nShape.registerNode('star', {\n  // 自定义节点时的配置\n  options: {\n    size: 60,\n    style: {\n      stroke: Global.defaultNode.style.stroke,\n      fill: Global.defaultNode.style.fill,\n      lineWidth: Global.defaultNode.style.lineWidth\n    },\n    labelCfg: {\n      style: {\n        fill: Global.nodeLabel.style.fill,\n        fontSize: Global.nodeLabel.style.fontSize\n      }\n    },\n    // 节点上左右上下四个方向上的链接circle配置\n    linkPoints: {\n      top: false,\n      right: false,\n      bottom: false,\n      left: false,\n      // circle的大小\n      size: Global.defaultNode.linkPoints.size,\n      lineWidth: Global.defaultNode.linkPoints.lineWidth,\n      fill: Global.defaultNode.linkPoints.fill,\n      stroke: Global.defaultNode.linkPoints.stroke\n    },\n    // 节点中icon配置\n    icon: {\n      // 是否显示icon，值为 false 则不渲染icon\n      show: false,\n      // icon的地址，字符串类型\n      img: 'https://gw.alipayobjects.com/zos/bmw-prod/5d015065-8505-4e7a-baec-976f81e3c41d.svg',\n      width: 20,\n      height: 20\n    },\n    stateStyles: __assign({}, Global.nodeStateStyles)\n  },\n  shapeType: 'star',\n  // 文本位置\n  labelPosition: 'center',\n  drawShape: function drawShape(cfg, group) {\n    var _a = this.getOptions(cfg).icon,\n        icon = _a === void 0 ? {} : _a;\n    var style = this.getShapeStyle(cfg);\n    var keyShape = group.addShape('path', {\n      attrs: style,\n      className: this.type + \"-keyShape\",\n      name: this.type + \"-keyShape\",\n      draggable: true\n    });\n    var w = icon.width,\n        h = icon.height,\n        show = icon.show;\n\n    if (show) {\n      var image = group.addShape('image', {\n        attrs: __assign({\n          x: -w / 2,\n          y: -h / 2\n        }, icon),\n        className: this.type + \"-icon\",\n        name: this.type + \"-icon\",\n        draggable: true\n      });\n    }\n\n    this.drawLinkPoints(cfg, group);\n    return keyShape;\n  },\n\n  /**\n   * 绘制节点上的LinkPoints\n   * @param {Object} cfg data数据配置项\n   * @param {Group} group Group实例\n   */\n  drawLinkPoints: function drawLinkPoints(cfg, group) {\n    var _a = this.getOptions(cfg).linkPoints,\n        linkPoints = _a === void 0 ? {} : _a;\n\n    var top = linkPoints.top,\n        left = linkPoints.left,\n        right = linkPoints.right,\n        leftBottom = linkPoints.leftBottom,\n        rightBottom = linkPoints.rightBottom,\n        markSize = linkPoints.size,\n        markR = linkPoints.r,\n        markStyle = __rest(linkPoints, [\"top\", \"left\", \"right\", \"leftBottom\", \"rightBottom\", \"size\", \"r\"]);\n\n    var size = this.getSize(cfg);\n    var outerR = size[0];\n\n    if (right) {\n      // right circle\n      // up down left right 四个方向的坐标均不相同\n      var x1 = Math.cos((18 + 72 * 0) / 180 * Math.PI) * outerR;\n      var y1 = Math.sin((18 + 72 * 0) / 180 * Math.PI) * outerR;\n      group.addShape('circle', {\n        attrs: __assign(__assign({}, markStyle), {\n          x: x1,\n          y: -y1,\n          r: markSize / 2 || markR || 5\n        }),\n        className: 'link-point-right',\n        name: 'link-point-right'\n      });\n    }\n\n    if (top) {\n      // up down left right 四个方向的坐标均不相同\n      var x1 = Math.cos((18 + 72 * 1) / 180 * Math.PI) * outerR;\n      var y1 = Math.sin((18 + 72 * 1) / 180 * Math.PI) * outerR; // top circle\n\n      group.addShape('circle', {\n        attrs: __assign(__assign({}, markStyle), {\n          x: x1,\n          y: -y1,\n          r: markSize / 2 || markR || 5\n        }),\n        className: 'link-point-top',\n        name: 'link-point-top'\n      });\n    }\n\n    if (left) {\n      // up down left right 四个方向的坐标均不相同\n      var x1 = Math.cos((18 + 72 * 2) / 180 * Math.PI) * outerR;\n      var y1 = Math.sin((18 + 72 * 2) / 180 * Math.PI) * outerR; // left circle\n\n      group.addShape('circle', {\n        attrs: __assign(__assign({}, markStyle), {\n          x: x1,\n          y: -y1,\n          r: markSize / 2 || markR || 5\n        }),\n        className: 'link-point-left',\n        name: 'link-point-left'\n      });\n    }\n\n    if (leftBottom) {\n      // up down left right 四个方向的坐标均不相同\n      var x1 = Math.cos((18 + 72 * 3) / 180 * Math.PI) * outerR;\n      var y1 = Math.sin((18 + 72 * 3) / 180 * Math.PI) * outerR; // left bottom circle\n\n      group.addShape('circle', {\n        attrs: __assign(__assign({}, markStyle), {\n          x: x1,\n          y: -y1,\n          r: markSize / 2 || markR || 5\n        }),\n        className: 'link-point-left-bottom',\n        name: 'link-point-left-bottom'\n      });\n    }\n\n    if (rightBottom) {\n      // up down left right 四个方向的坐标均不相同\n      var x1 = Math.cos((18 + 72 * 4) / 180 * Math.PI) * outerR;\n      var y1 = Math.sin((18 + 72 * 4) / 180 * Math.PI) * outerR; // left bottom circle\n\n      group.addShape('circle', {\n        attrs: __assign(__assign({}, markStyle), {\n          x: x1,\n          y: -y1,\n          r: markSize / 2 || markR || 5\n        }),\n        className: 'link-point-right-bottom',\n        name: 'link-point-right-bottom'\n      });\n    }\n  },\n  getPath: function getPath(cfg) {\n    var size = this.getSize(cfg);\n    var outerR = size[0];\n    var defaultInnerR = outerR * 3 / 8;\n    var innerR = cfg.innerR || defaultInnerR;\n    var path = [];\n\n    for (var i = 0; i < 5; i++) {\n      var x1 = Math.cos((18 + 72 * i) / 180 * Math.PI) * outerR;\n      var y1 = Math.sin((18 + 72 * i) / 180 * Math.PI) * outerR;\n      var x2 = Math.cos((54 + 72 * i) / 180 * Math.PI) * innerR;\n      var y2 = Math.sin((54 + 72 * i) / 180 * Math.PI) * innerR;\n\n      if (i === 0) {\n        path.push(['M', x1, -y1]);\n      } else {\n        path.push(['L', x1, -y1]);\n      }\n\n      path.push(['L', x2, -y2]);\n    }\n\n    path.push(['Z']);\n    return path;\n  },\n\n  /**\n   * 获取节点的样式，供基于该节点自定义时使用\n   * @param {Object} cfg 节点数据模型\n   * @return {Object} 节点的样式\n   */\n  getShapeStyle: function getShapeStyle(cfg) {\n    var defaultStyle = this.getOptions(cfg).style;\n    var strokeStyle = {\n      stroke: cfg.color\n    }; // 如果设置了color，则覆盖原来默认的 stroke 属性。但 cfg 中但 stroke 属性优先级更高\n\n    var style = mix({}, defaultStyle, strokeStyle);\n    var path = this.getPath(cfg);\n\n    var styles = __assign({\n      path: path\n    }, style);\n\n    return styles;\n  },\n  update: function update(cfg, item) {\n    var group = item.getContainer(); // 这里不传 cfg 参数是因为 cfg.style 需要最后覆盖样式\n\n    var defaultStyle = this.getOptions({}).style;\n    var path = this.getPath(cfg); // 下面这些属性需要覆盖默认样式与目前样式，但若在 cfg 中有指定则应该被 cfg 的相应配置覆盖。\n\n    var strokeStyle = {\n      stroke: cfg.color,\n      path: path\n    }; // 与 getShapeStyle 不同在于，update 时需要获取到当前的 style 进行融合。即新传入的配置项中没有涉及的属性，保留当前的配置。\n\n    var keyShape = item.get('keyShape');\n    var style = mix({}, defaultStyle, keyShape.attr(), strokeStyle);\n    style = mix(style, cfg.style);\n    this.updateShape(cfg, item, style, true);\n    this.updateLinkPoints(cfg, group);\n  },\n\n  /**\n   * 更新linkPoints\n   * @param {Object} cfg 节点数据配置项\n   * @param {Group} group Item所在的group\n   */\n  updateLinkPoints: function updateLinkPoints(cfg, group) {\n    var defaultLinkPoints = this.getOptions({}).linkPoints;\n    var markLeft = group.find(function (element) {\n      return element.get('className') === 'link-point-left';\n    });\n    var markRight = group.find(function (element) {\n      return element.get('className') === 'link-point-right';\n    });\n    var markTop = group.find(function (element) {\n      return element.get('className') === 'link-point-top';\n    });\n    var markLeftBottom = group.find(function (element) {\n      return element.get('className') === 'link-point-left-bottom';\n    });\n    var markRightBottom = group.find(function (element) {\n      return element.get('className') === 'link-point-right-bottom';\n    });\n    var currentLinkPoints = defaultLinkPoints;\n    var existLinkPoint = markLeft || markRight || markTop || markLeftBottom || markRightBottom;\n\n    if (existLinkPoint) {\n      currentLinkPoints = existLinkPoint.attr();\n    }\n\n    var linkPoints = mix({}, currentLinkPoints, cfg.linkPoints);\n    var markFill = linkPoints.fill,\n        markStroke = linkPoints.stroke,\n        borderWidth = linkPoints.lineWidth;\n    var markSize = linkPoints.size / 2;\n    if (!markSize) markSize = linkPoints.r;\n\n    var _a = cfg.linkPoints ? cfg.linkPoints : {\n      left: undefined,\n      right: undefined,\n      top: undefined,\n      leftBottom: undefined,\n      rightBottom: undefined\n    },\n        left = _a.left,\n        right = _a.right,\n        top = _a.top,\n        leftBottom = _a.leftBottom,\n        rightBottom = _a.rightBottom;\n\n    var size = this.getSize(cfg);\n    var outerR = size[0];\n    var styles = {\n      r: markSize,\n      fill: markFill,\n      stroke: markStroke,\n      lineWidth: borderWidth\n    };\n    var x = Math.cos((18 + 72 * 0) / 180 * Math.PI) * outerR;\n    var y = Math.sin((18 + 72 * 0) / 180 * Math.PI) * outerR;\n\n    if (markRight) {\n      if (!right && right !== undefined) {\n        markRight.remove();\n      } else {\n        markRight.attr(__assign(__assign({}, styles), {\n          x: x,\n          y: -y\n        }));\n      }\n    } else if (right) {\n      group.addShape('circle', {\n        attrs: __assign(__assign({}, styles), {\n          x: x,\n          y: -y\n        }),\n        className: 'link-point-right',\n        name: 'link-point-right',\n        isAnchorPoint: true\n      });\n    }\n\n    x = Math.cos((18 + 72 * 1) / 180 * Math.PI) * outerR;\n    y = Math.sin((18 + 72 * 1) / 180 * Math.PI) * outerR;\n\n    if (markTop) {\n      if (!top && top !== undefined) {\n        markTop.remove();\n      } else {\n        markTop.attr(__assign(__assign({}, styles), {\n          x: x,\n          y: -y\n        }));\n      }\n    } else if (top) {\n      group.addShape('circle', {\n        attrs: __assign(__assign({}, styles), {\n          x: x,\n          y: -y\n        }),\n        className: 'link-point-top',\n        name: 'link-point-top',\n        isAnchorPoint: true\n      });\n    }\n\n    x = Math.cos((18 + 72 * 2) / 180 * Math.PI) * outerR;\n    y = Math.sin((18 + 72 * 2) / 180 * Math.PI) * outerR;\n\n    if (markLeft) {\n      if (!left && left !== undefined) {\n        markLeft.remove();\n      } else {\n        markLeft.attr(__assign(__assign({}, styles), {\n          x: x,\n          y: -y\n        }));\n      }\n    } else if (left) {\n      group.addShape('circle', {\n        attrs: __assign(__assign({}, styles), {\n          x: x,\n          y: -y\n        }),\n        className: 'link-point-left',\n        name: 'link-point-left',\n        isAnchorPoint: true\n      });\n    }\n\n    x = Math.cos((18 + 72 * 3) / 180 * Math.PI) * outerR;\n    y = Math.sin((18 + 72 * 3) / 180 * Math.PI) * outerR;\n\n    if (markLeftBottom) {\n      if (!leftBottom && leftBottom !== undefined) {\n        markLeftBottom.remove();\n      } else {\n        markLeftBottom.attr(__assign(__assign({}, styles), {\n          x: x,\n          y: -y\n        }));\n      }\n    } else if (leftBottom) {\n      group.addShape('circle', {\n        attrs: __assign(__assign({}, styles), {\n          x: x,\n          y: -y\n        }),\n        className: 'link-point-left-bottom',\n        name: 'link-point-left-bottom',\n        isAnchorPoint: true\n      });\n    }\n\n    x = Math.cos((18 + 72 * 4) / 180 * Math.PI) * outerR;\n    y = Math.sin((18 + 72 * 4) / 180 * Math.PI) * outerR;\n\n    if (markRightBottom) {\n      if (!rightBottom && rightBottom !== undefined) {\n        markLeftBottom.remove();\n      } else {\n        markRightBottom.attr(__assign(__assign({}, styles), {\n          x: x,\n          y: -y\n        }));\n      }\n    } else if (rightBottom) {\n      group.addShape('circle', {\n        attrs: __assign(__assign({}, styles), {\n          x: x,\n          y: -y\n        }),\n        className: 'link-point-right-bottom',\n        name: 'link-point-right-bottom',\n        isAnchorPoint: true\n      });\n    }\n  }\n}, 'single-node');","map":{"version":3,"sources":["/Users/wanglijie/wanglijie/clover-defi-wallet/node_modules/@antv/g6/es/shape/nodes/star.js"],"names":["__assign","__rest","mix","Global","Shape","registerNode","options","size","style","stroke","defaultNode","fill","lineWidth","labelCfg","nodeLabel","fontSize","linkPoints","top","right","bottom","left","icon","show","img","width","height","stateStyles","nodeStateStyles","shapeType","labelPosition","drawShape","cfg","group","_a","getOptions","getShapeStyle","keyShape","addShape","attrs","className","type","name","draggable","w","h","image","x","y","drawLinkPoints","leftBottom","rightBottom","markSize","markR","r","markStyle","getSize","outerR","x1","Math","cos","PI","y1","sin","getPath","defaultInnerR","innerR","path","i","x2","y2","push","defaultStyle","strokeStyle","color","styles","update","item","getContainer","get","attr","updateShape","updateLinkPoints","defaultLinkPoints","markLeft","find","element","markRight","markTop","markLeftBottom","markRightBottom","currentLinkPoints","existLinkPoint","markFill","markStroke","borderWidth","undefined","remove","isAnchorPoint"],"mappings":"AAAA,SAASA,QAAT,EAAmBC,MAAnB,QAAiC,OAAjC;AACA,SAASC,GAAT,QAAoB,YAApB;AACA,OAAOC,MAAP,MAAmB,cAAnB;AACA,OAAOC,KAAP,MAAkB,UAAlB,C,CAA8B;;AAE9BA,KAAK,CAACC,YAAN,CAAmB,MAAnB,EAA2B;AACzB;AACAC,EAAAA,OAAO,EAAE;AACPC,IAAAA,IAAI,EAAE,EADC;AAEPC,IAAAA,KAAK,EAAE;AACLC,MAAAA,MAAM,EAAEN,MAAM,CAACO,WAAP,CAAmBF,KAAnB,CAAyBC,MAD5B;AAELE,MAAAA,IAAI,EAAER,MAAM,CAACO,WAAP,CAAmBF,KAAnB,CAAyBG,IAF1B;AAGLC,MAAAA,SAAS,EAAET,MAAM,CAACO,WAAP,CAAmBF,KAAnB,CAAyBI;AAH/B,KAFA;AAOPC,IAAAA,QAAQ,EAAE;AACRL,MAAAA,KAAK,EAAE;AACLG,QAAAA,IAAI,EAAER,MAAM,CAACW,SAAP,CAAiBN,KAAjB,CAAuBG,IADxB;AAELI,QAAAA,QAAQ,EAAEZ,MAAM,CAACW,SAAP,CAAiBN,KAAjB,CAAuBO;AAF5B;AADC,KAPH;AAaP;AACAC,IAAAA,UAAU,EAAE;AACVC,MAAAA,GAAG,EAAE,KADK;AAEVC,MAAAA,KAAK,EAAE,KAFG;AAGVC,MAAAA,MAAM,EAAE,KAHE;AAIVC,MAAAA,IAAI,EAAE,KAJI;AAKV;AACAb,MAAAA,IAAI,EAAEJ,MAAM,CAACO,WAAP,CAAmBM,UAAnB,CAA8BT,IAN1B;AAOVK,MAAAA,SAAS,EAAET,MAAM,CAACO,WAAP,CAAmBM,UAAnB,CAA8BJ,SAP/B;AAQVD,MAAAA,IAAI,EAAER,MAAM,CAACO,WAAP,CAAmBM,UAAnB,CAA8BL,IAR1B;AASVF,MAAAA,MAAM,EAAEN,MAAM,CAACO,WAAP,CAAmBM,UAAnB,CAA8BP;AAT5B,KAdL;AAyBP;AACAY,IAAAA,IAAI,EAAE;AACJ;AACAC,MAAAA,IAAI,EAAE,KAFF;AAGJ;AACAC,MAAAA,GAAG,EAAE,oFAJD;AAKJC,MAAAA,KAAK,EAAE,EALH;AAMJC,MAAAA,MAAM,EAAE;AANJ,KA1BC;AAkCPC,IAAAA,WAAW,EAAE1B,QAAQ,CAAC,EAAD,EAAKG,MAAM,CAACwB,eAAZ;AAlCd,GAFgB;AAsCzBC,EAAAA,SAAS,EAAE,MAtCc;AAuCzB;AACAC,EAAAA,aAAa,EAAE,QAxCU;AAyCzBC,EAAAA,SAAS,EAAE,SAASA,SAAT,CAAmBC,GAAnB,EAAwBC,KAAxB,EAA+B;AACxC,QAAIC,EAAE,GAAG,KAAKC,UAAL,CAAgBH,GAAhB,EAAqBV,IAA9B;AAAA,QACIA,IAAI,GAAGY,EAAE,KAAK,KAAK,CAAZ,GAAgB,EAAhB,GAAqBA,EADhC;AAEA,QAAIzB,KAAK,GAAG,KAAK2B,aAAL,CAAmBJ,GAAnB,CAAZ;AACA,QAAIK,QAAQ,GAAGJ,KAAK,CAACK,QAAN,CAAe,MAAf,EAAuB;AACpCC,MAAAA,KAAK,EAAE9B,KAD6B;AAEpC+B,MAAAA,SAAS,EAAE,KAAKC,IAAL,GAAY,WAFa;AAGpCC,MAAAA,IAAI,EAAE,KAAKD,IAAL,GAAY,WAHkB;AAIpCE,MAAAA,SAAS,EAAE;AAJyB,KAAvB,CAAf;AAMA,QAAIC,CAAC,GAAGtB,IAAI,CAACG,KAAb;AAAA,QACIoB,CAAC,GAAGvB,IAAI,CAACI,MADb;AAAA,QAEIH,IAAI,GAAGD,IAAI,CAACC,IAFhB;;AAIA,QAAIA,IAAJ,EAAU;AACR,UAAIuB,KAAK,GAAGb,KAAK,CAACK,QAAN,CAAe,OAAf,EAAwB;AAClCC,QAAAA,KAAK,EAAEtC,QAAQ,CAAC;AACd8C,UAAAA,CAAC,EAAE,CAACH,CAAD,GAAK,CADM;AAEdI,UAAAA,CAAC,EAAE,CAACH,CAAD,GAAK;AAFM,SAAD,EAGZvB,IAHY,CADmB;AAKlCkB,QAAAA,SAAS,EAAE,KAAKC,IAAL,GAAY,OALW;AAMlCC,QAAAA,IAAI,EAAE,KAAKD,IAAL,GAAY,OANgB;AAOlCE,QAAAA,SAAS,EAAE;AAPuB,OAAxB,CAAZ;AASD;;AAED,SAAKM,cAAL,CAAoBjB,GAApB,EAAyBC,KAAzB;AACA,WAAOI,QAAP;AACD,GArEwB;;AAuEzB;AACF;AACA;AACA;AACA;AACEY,EAAAA,cAAc,EAAE,SAASA,cAAT,CAAwBjB,GAAxB,EAA6BC,KAA7B,EAAoC;AAClD,QAAIC,EAAE,GAAG,KAAKC,UAAL,CAAgBH,GAAhB,EAAqBf,UAA9B;AAAA,QACIA,UAAU,GAAGiB,EAAE,KAAK,KAAK,CAAZ,GAAgB,EAAhB,GAAqBA,EADtC;;AAGA,QAAIhB,GAAG,GAAGD,UAAU,CAACC,GAArB;AAAA,QACIG,IAAI,GAAGJ,UAAU,CAACI,IADtB;AAAA,QAEIF,KAAK,GAAGF,UAAU,CAACE,KAFvB;AAAA,QAGI+B,UAAU,GAAGjC,UAAU,CAACiC,UAH5B;AAAA,QAIIC,WAAW,GAAGlC,UAAU,CAACkC,WAJ7B;AAAA,QAKIC,QAAQ,GAAGnC,UAAU,CAACT,IAL1B;AAAA,QAMI6C,KAAK,GAAGpC,UAAU,CAACqC,CANvB;AAAA,QAOIC,SAAS,GAAGrD,MAAM,CAACe,UAAD,EAAa,CAAC,KAAD,EAAQ,MAAR,EAAgB,OAAhB,EAAyB,YAAzB,EAAuC,aAAvC,EAAsD,MAAtD,EAA8D,GAA9D,CAAb,CAPtB;;AASA,QAAIT,IAAI,GAAG,KAAKgD,OAAL,CAAaxB,GAAb,CAAX;AACA,QAAIyB,MAAM,GAAGjD,IAAI,CAAC,CAAD,CAAjB;;AAEA,QAAIW,KAAJ,EAAW;AACT;AACA;AACA,UAAIuC,EAAE,GAAGC,IAAI,CAACC,GAAL,CAAS,CAAC,KAAK,KAAK,CAAX,IAAgB,GAAhB,GAAsBD,IAAI,CAACE,EAApC,IAA0CJ,MAAnD;AACA,UAAIK,EAAE,GAAGH,IAAI,CAACI,GAAL,CAAS,CAAC,KAAK,KAAK,CAAX,IAAgB,GAAhB,GAAsBJ,IAAI,CAACE,EAApC,IAA0CJ,MAAnD;AACAxB,MAAAA,KAAK,CAACK,QAAN,CAAe,QAAf,EAAyB;AACvBC,QAAAA,KAAK,EAAEtC,QAAQ,CAACA,QAAQ,CAAC,EAAD,EAAKsD,SAAL,CAAT,EAA0B;AACvCR,UAAAA,CAAC,EAAEW,EADoC;AAEvCV,UAAAA,CAAC,EAAE,CAACc,EAFmC;AAGvCR,UAAAA,CAAC,EAAEF,QAAQ,GAAG,CAAX,IAAgBC,KAAhB,IAAyB;AAHW,SAA1B,CADQ;AAMvBb,QAAAA,SAAS,EAAE,kBANY;AAOvBE,QAAAA,IAAI,EAAE;AAPiB,OAAzB;AASD;;AAED,QAAIxB,GAAJ,EAAS;AACP;AACA,UAAIwC,EAAE,GAAGC,IAAI,CAACC,GAAL,CAAS,CAAC,KAAK,KAAK,CAAX,IAAgB,GAAhB,GAAsBD,IAAI,CAACE,EAApC,IAA0CJ,MAAnD;AACA,UAAIK,EAAE,GAAGH,IAAI,CAACI,GAAL,CAAS,CAAC,KAAK,KAAK,CAAX,IAAgB,GAAhB,GAAsBJ,IAAI,CAACE,EAApC,IAA0CJ,MAAnD,CAHO,CAGoD;;AAE3DxB,MAAAA,KAAK,CAACK,QAAN,CAAe,QAAf,EAAyB;AACvBC,QAAAA,KAAK,EAAEtC,QAAQ,CAACA,QAAQ,CAAC,EAAD,EAAKsD,SAAL,CAAT,EAA0B;AACvCR,UAAAA,CAAC,EAAEW,EADoC;AAEvCV,UAAAA,CAAC,EAAE,CAACc,EAFmC;AAGvCR,UAAAA,CAAC,EAAEF,QAAQ,GAAG,CAAX,IAAgBC,KAAhB,IAAyB;AAHW,SAA1B,CADQ;AAMvBb,QAAAA,SAAS,EAAE,gBANY;AAOvBE,QAAAA,IAAI,EAAE;AAPiB,OAAzB;AASD;;AAED,QAAIrB,IAAJ,EAAU;AACR;AACA,UAAIqC,EAAE,GAAGC,IAAI,CAACC,GAAL,CAAS,CAAC,KAAK,KAAK,CAAX,IAAgB,GAAhB,GAAsBD,IAAI,CAACE,EAApC,IAA0CJ,MAAnD;AACA,UAAIK,EAAE,GAAGH,IAAI,CAACI,GAAL,CAAS,CAAC,KAAK,KAAK,CAAX,IAAgB,GAAhB,GAAsBJ,IAAI,CAACE,EAApC,IAA0CJ,MAAnD,CAHQ,CAGmD;;AAE3DxB,MAAAA,KAAK,CAACK,QAAN,CAAe,QAAf,EAAyB;AACvBC,QAAAA,KAAK,EAAEtC,QAAQ,CAACA,QAAQ,CAAC,EAAD,EAAKsD,SAAL,CAAT,EAA0B;AACvCR,UAAAA,CAAC,EAAEW,EADoC;AAEvCV,UAAAA,CAAC,EAAE,CAACc,EAFmC;AAGvCR,UAAAA,CAAC,EAAEF,QAAQ,GAAG,CAAX,IAAgBC,KAAhB,IAAyB;AAHW,SAA1B,CADQ;AAMvBb,QAAAA,SAAS,EAAE,iBANY;AAOvBE,QAAAA,IAAI,EAAE;AAPiB,OAAzB;AASD;;AAED,QAAIQ,UAAJ,EAAgB;AACd;AACA,UAAIQ,EAAE,GAAGC,IAAI,CAACC,GAAL,CAAS,CAAC,KAAK,KAAK,CAAX,IAAgB,GAAhB,GAAsBD,IAAI,CAACE,EAApC,IAA0CJ,MAAnD;AACA,UAAIK,EAAE,GAAGH,IAAI,CAACI,GAAL,CAAS,CAAC,KAAK,KAAK,CAAX,IAAgB,GAAhB,GAAsBJ,IAAI,CAACE,EAApC,IAA0CJ,MAAnD,CAHc,CAG6C;;AAE3DxB,MAAAA,KAAK,CAACK,QAAN,CAAe,QAAf,EAAyB;AACvBC,QAAAA,KAAK,EAAEtC,QAAQ,CAACA,QAAQ,CAAC,EAAD,EAAKsD,SAAL,CAAT,EAA0B;AACvCR,UAAAA,CAAC,EAAEW,EADoC;AAEvCV,UAAAA,CAAC,EAAE,CAACc,EAFmC;AAGvCR,UAAAA,CAAC,EAAEF,QAAQ,GAAG,CAAX,IAAgBC,KAAhB,IAAyB;AAHW,SAA1B,CADQ;AAMvBb,QAAAA,SAAS,EAAE,wBANY;AAOvBE,QAAAA,IAAI,EAAE;AAPiB,OAAzB;AASD;;AAED,QAAIS,WAAJ,EAAiB;AACf;AACA,UAAIO,EAAE,GAAGC,IAAI,CAACC,GAAL,CAAS,CAAC,KAAK,KAAK,CAAX,IAAgB,GAAhB,GAAsBD,IAAI,CAACE,EAApC,IAA0CJ,MAAnD;AACA,UAAIK,EAAE,GAAGH,IAAI,CAACI,GAAL,CAAS,CAAC,KAAK,KAAK,CAAX,IAAgB,GAAhB,GAAsBJ,IAAI,CAACE,EAApC,IAA0CJ,MAAnD,CAHe,CAG4C;;AAE3DxB,MAAAA,KAAK,CAACK,QAAN,CAAe,QAAf,EAAyB;AACvBC,QAAAA,KAAK,EAAEtC,QAAQ,CAACA,QAAQ,CAAC,EAAD,EAAKsD,SAAL,CAAT,EAA0B;AACvCR,UAAAA,CAAC,EAAEW,EADoC;AAEvCV,UAAAA,CAAC,EAAE,CAACc,EAFmC;AAGvCR,UAAAA,CAAC,EAAEF,QAAQ,GAAG,CAAX,IAAgBC,KAAhB,IAAyB;AAHW,SAA1B,CADQ;AAMvBb,QAAAA,SAAS,EAAE,yBANY;AAOvBE,QAAAA,IAAI,EAAE;AAPiB,OAAzB;AASD;AACF,GA3KwB;AA4KzBsB,EAAAA,OAAO,EAAE,SAASA,OAAT,CAAiBhC,GAAjB,EAAsB;AAC7B,QAAIxB,IAAI,GAAG,KAAKgD,OAAL,CAAaxB,GAAb,CAAX;AACA,QAAIyB,MAAM,GAAGjD,IAAI,CAAC,CAAD,CAAjB;AACA,QAAIyD,aAAa,GAAGR,MAAM,GAAG,CAAT,GAAa,CAAjC;AACA,QAAIS,MAAM,GAAGlC,GAAG,CAACkC,MAAJ,IAAcD,aAA3B;AACA,QAAIE,IAAI,GAAG,EAAX;;AAEA,SAAK,IAAIC,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG,CAApB,EAAuBA,CAAC,EAAxB,EAA4B;AAC1B,UAAIV,EAAE,GAAGC,IAAI,CAACC,GAAL,CAAS,CAAC,KAAK,KAAKQ,CAAX,IAAgB,GAAhB,GAAsBT,IAAI,CAACE,EAApC,IAA0CJ,MAAnD;AACA,UAAIK,EAAE,GAAGH,IAAI,CAACI,GAAL,CAAS,CAAC,KAAK,KAAKK,CAAX,IAAgB,GAAhB,GAAsBT,IAAI,CAACE,EAApC,IAA0CJ,MAAnD;AACA,UAAIY,EAAE,GAAGV,IAAI,CAACC,GAAL,CAAS,CAAC,KAAK,KAAKQ,CAAX,IAAgB,GAAhB,GAAsBT,IAAI,CAACE,EAApC,IAA0CK,MAAnD;AACA,UAAII,EAAE,GAAGX,IAAI,CAACI,GAAL,CAAS,CAAC,KAAK,KAAKK,CAAX,IAAgB,GAAhB,GAAsBT,IAAI,CAACE,EAApC,IAA0CK,MAAnD;;AAEA,UAAIE,CAAC,KAAK,CAAV,EAAa;AACXD,QAAAA,IAAI,CAACI,IAAL,CAAU,CAAC,GAAD,EAAMb,EAAN,EAAU,CAACI,EAAX,CAAV;AACD,OAFD,MAEO;AACLK,QAAAA,IAAI,CAACI,IAAL,CAAU,CAAC,GAAD,EAAMb,EAAN,EAAU,CAACI,EAAX,CAAV;AACD;;AAEDK,MAAAA,IAAI,CAACI,IAAL,CAAU,CAAC,GAAD,EAAMF,EAAN,EAAU,CAACC,EAAX,CAAV;AACD;;AAEDH,IAAAA,IAAI,CAACI,IAAL,CAAU,CAAC,GAAD,CAAV;AACA,WAAOJ,IAAP;AACD,GApMwB;;AAsMzB;AACF;AACA;AACA;AACA;AACE/B,EAAAA,aAAa,EAAE,SAASA,aAAT,CAAuBJ,GAAvB,EAA4B;AACzC,QAAIwC,YAAY,GAAG,KAAKrC,UAAL,CAAgBH,GAAhB,EAAqBvB,KAAxC;AACA,QAAIgE,WAAW,GAAG;AAChB/D,MAAAA,MAAM,EAAEsB,GAAG,CAAC0C;AADI,KAAlB,CAFyC,CAItC;;AAEH,QAAIjE,KAAK,GAAGN,GAAG,CAAC,EAAD,EAAKqE,YAAL,EAAmBC,WAAnB,CAAf;AACA,QAAIN,IAAI,GAAG,KAAKH,OAAL,CAAahC,GAAb,CAAX;;AAEA,QAAI2C,MAAM,GAAG1E,QAAQ,CAAC;AACpBkE,MAAAA,IAAI,EAAEA;AADc,KAAD,EAElB1D,KAFkB,CAArB;;AAIA,WAAOkE,MAAP;AACD,GAzNwB;AA0NzBC,EAAAA,MAAM,EAAE,SAASA,MAAT,CAAgB5C,GAAhB,EAAqB6C,IAArB,EAA2B;AACjC,QAAI5C,KAAK,GAAG4C,IAAI,CAACC,YAAL,EAAZ,CADiC,CACA;;AAEjC,QAAIN,YAAY,GAAG,KAAKrC,UAAL,CAAgB,EAAhB,EAAoB1B,KAAvC;AACA,QAAI0D,IAAI,GAAG,KAAKH,OAAL,CAAahC,GAAb,CAAX,CAJiC,CAIH;;AAE9B,QAAIyC,WAAW,GAAG;AAChB/D,MAAAA,MAAM,EAAEsB,GAAG,CAAC0C,KADI;AAEhBP,MAAAA,IAAI,EAAEA;AAFU,KAAlB,CANiC,CAS9B;;AAEH,QAAI9B,QAAQ,GAAGwC,IAAI,CAACE,GAAL,CAAS,UAAT,CAAf;AACA,QAAItE,KAAK,GAAGN,GAAG,CAAC,EAAD,EAAKqE,YAAL,EAAmBnC,QAAQ,CAAC2C,IAAT,EAAnB,EAAoCP,WAApC,CAAf;AACAhE,IAAAA,KAAK,GAAGN,GAAG,CAACM,KAAD,EAAQuB,GAAG,CAACvB,KAAZ,CAAX;AACA,SAAKwE,WAAL,CAAiBjD,GAAjB,EAAsB6C,IAAtB,EAA4BpE,KAA5B,EAAmC,IAAnC;AACA,SAAKyE,gBAAL,CAAsBlD,GAAtB,EAA2BC,KAA3B;AACD,GA1OwB;;AA4OzB;AACF;AACA;AACA;AACA;AACEiD,EAAAA,gBAAgB,EAAE,SAASA,gBAAT,CAA0BlD,GAA1B,EAA+BC,KAA/B,EAAsC;AACtD,QAAIkD,iBAAiB,GAAG,KAAKhD,UAAL,CAAgB,EAAhB,EAAoBlB,UAA5C;AACA,QAAImE,QAAQ,GAAGnD,KAAK,CAACoD,IAAN,CAAW,UAAUC,OAAV,EAAmB;AAC3C,aAAOA,OAAO,CAACP,GAAR,CAAY,WAAZ,MAA6B,iBAApC;AACD,KAFc,CAAf;AAGA,QAAIQ,SAAS,GAAGtD,KAAK,CAACoD,IAAN,CAAW,UAAUC,OAAV,EAAmB;AAC5C,aAAOA,OAAO,CAACP,GAAR,CAAY,WAAZ,MAA6B,kBAApC;AACD,KAFe,CAAhB;AAGA,QAAIS,OAAO,GAAGvD,KAAK,CAACoD,IAAN,CAAW,UAAUC,OAAV,EAAmB;AAC1C,aAAOA,OAAO,CAACP,GAAR,CAAY,WAAZ,MAA6B,gBAApC;AACD,KAFa,CAAd;AAGA,QAAIU,cAAc,GAAGxD,KAAK,CAACoD,IAAN,CAAW,UAAUC,OAAV,EAAmB;AACjD,aAAOA,OAAO,CAACP,GAAR,CAAY,WAAZ,MAA6B,wBAApC;AACD,KAFoB,CAArB;AAGA,QAAIW,eAAe,GAAGzD,KAAK,CAACoD,IAAN,CAAW,UAAUC,OAAV,EAAmB;AAClD,aAAOA,OAAO,CAACP,GAAR,CAAY,WAAZ,MAA6B,yBAApC;AACD,KAFqB,CAAtB;AAGA,QAAIY,iBAAiB,GAAGR,iBAAxB;AACA,QAAIS,cAAc,GAAGR,QAAQ,IAAIG,SAAZ,IAAyBC,OAAzB,IAAoCC,cAApC,IAAsDC,eAA3E;;AAEA,QAAIE,cAAJ,EAAoB;AAClBD,MAAAA,iBAAiB,GAAGC,cAAc,CAACZ,IAAf,EAApB;AACD;;AAED,QAAI/D,UAAU,GAAGd,GAAG,CAAC,EAAD,EAAKwF,iBAAL,EAAwB3D,GAAG,CAACf,UAA5B,CAApB;AACA,QAAI4E,QAAQ,GAAG5E,UAAU,CAACL,IAA1B;AAAA,QACIkF,UAAU,GAAG7E,UAAU,CAACP,MAD5B;AAAA,QAEIqF,WAAW,GAAG9E,UAAU,CAACJ,SAF7B;AAGA,QAAIuC,QAAQ,GAAGnC,UAAU,CAACT,IAAX,GAAkB,CAAjC;AACA,QAAI,CAAC4C,QAAL,EAAeA,QAAQ,GAAGnC,UAAU,CAACqC,CAAtB;;AAEf,QAAIpB,EAAE,GAAGF,GAAG,CAACf,UAAJ,GAAiBe,GAAG,CAACf,UAArB,GAAkC;AACzCI,MAAAA,IAAI,EAAE2E,SADmC;AAEzC7E,MAAAA,KAAK,EAAE6E,SAFkC;AAGzC9E,MAAAA,GAAG,EAAE8E,SAHoC;AAIzC9C,MAAAA,UAAU,EAAE8C,SAJ6B;AAKzC7C,MAAAA,WAAW,EAAE6C;AAL4B,KAA3C;AAAA,QAOI3E,IAAI,GAAGa,EAAE,CAACb,IAPd;AAAA,QAQIF,KAAK,GAAGe,EAAE,CAACf,KARf;AAAA,QASID,GAAG,GAAGgB,EAAE,CAAChB,GATb;AAAA,QAUIgC,UAAU,GAAGhB,EAAE,CAACgB,UAVpB;AAAA,QAWIC,WAAW,GAAGjB,EAAE,CAACiB,WAXrB;;AAaA,QAAI3C,IAAI,GAAG,KAAKgD,OAAL,CAAaxB,GAAb,CAAX;AACA,QAAIyB,MAAM,GAAGjD,IAAI,CAAC,CAAD,CAAjB;AACA,QAAImE,MAAM,GAAG;AACXrB,MAAAA,CAAC,EAAEF,QADQ;AAEXxC,MAAAA,IAAI,EAAEiF,QAFK;AAGXnF,MAAAA,MAAM,EAAEoF,UAHG;AAIXjF,MAAAA,SAAS,EAAEkF;AAJA,KAAb;AAMA,QAAIhD,CAAC,GAAGY,IAAI,CAACC,GAAL,CAAS,CAAC,KAAK,KAAK,CAAX,IAAgB,GAAhB,GAAsBD,IAAI,CAACE,EAApC,IAA0CJ,MAAlD;AACA,QAAIT,CAAC,GAAGW,IAAI,CAACI,GAAL,CAAS,CAAC,KAAK,KAAK,CAAX,IAAgB,GAAhB,GAAsBJ,IAAI,CAACE,EAApC,IAA0CJ,MAAlD;;AAEA,QAAI8B,SAAJ,EAAe;AACb,UAAI,CAACpE,KAAD,IAAUA,KAAK,KAAK6E,SAAxB,EAAmC;AACjCT,QAAAA,SAAS,CAACU,MAAV;AACD,OAFD,MAEO;AACLV,QAAAA,SAAS,CAACP,IAAV,CAAe/E,QAAQ,CAACA,QAAQ,CAAC,EAAD,EAAK0E,MAAL,CAAT,EAAuB;AAC5C5B,UAAAA,CAAC,EAAEA,CADyC;AAE5CC,UAAAA,CAAC,EAAE,CAACA;AAFwC,SAAvB,CAAvB;AAID;AACF,KATD,MASO,IAAI7B,KAAJ,EAAW;AAChBc,MAAAA,KAAK,CAACK,QAAN,CAAe,QAAf,EAAyB;AACvBC,QAAAA,KAAK,EAAEtC,QAAQ,CAACA,QAAQ,CAAC,EAAD,EAAK0E,MAAL,CAAT,EAAuB;AACpC5B,UAAAA,CAAC,EAAEA,CADiC;AAEpCC,UAAAA,CAAC,EAAE,CAACA;AAFgC,SAAvB,CADQ;AAKvBR,QAAAA,SAAS,EAAE,kBALY;AAMvBE,QAAAA,IAAI,EAAE,kBANiB;AAOvBwD,QAAAA,aAAa,EAAE;AAPQ,OAAzB;AASD;;AAEDnD,IAAAA,CAAC,GAAGY,IAAI,CAACC,GAAL,CAAS,CAAC,KAAK,KAAK,CAAX,IAAgB,GAAhB,GAAsBD,IAAI,CAACE,EAApC,IAA0CJ,MAA9C;AACAT,IAAAA,CAAC,GAAGW,IAAI,CAACI,GAAL,CAAS,CAAC,KAAK,KAAK,CAAX,IAAgB,GAAhB,GAAsBJ,IAAI,CAACE,EAApC,IAA0CJ,MAA9C;;AAEA,QAAI+B,OAAJ,EAAa;AACX,UAAI,CAACtE,GAAD,IAAQA,GAAG,KAAK8E,SAApB,EAA+B;AAC7BR,QAAAA,OAAO,CAACS,MAAR;AACD,OAFD,MAEO;AACLT,QAAAA,OAAO,CAACR,IAAR,CAAa/E,QAAQ,CAACA,QAAQ,CAAC,EAAD,EAAK0E,MAAL,CAAT,EAAuB;AAC1C5B,UAAAA,CAAC,EAAEA,CADuC;AAE1CC,UAAAA,CAAC,EAAE,CAACA;AAFsC,SAAvB,CAArB;AAID;AACF,KATD,MASO,IAAI9B,GAAJ,EAAS;AACde,MAAAA,KAAK,CAACK,QAAN,CAAe,QAAf,EAAyB;AACvBC,QAAAA,KAAK,EAAEtC,QAAQ,CAACA,QAAQ,CAAC,EAAD,EAAK0E,MAAL,CAAT,EAAuB;AACpC5B,UAAAA,CAAC,EAAEA,CADiC;AAEpCC,UAAAA,CAAC,EAAE,CAACA;AAFgC,SAAvB,CADQ;AAKvBR,QAAAA,SAAS,EAAE,gBALY;AAMvBE,QAAAA,IAAI,EAAE,gBANiB;AAOvBwD,QAAAA,aAAa,EAAE;AAPQ,OAAzB;AASD;;AAEDnD,IAAAA,CAAC,GAAGY,IAAI,CAACC,GAAL,CAAS,CAAC,KAAK,KAAK,CAAX,IAAgB,GAAhB,GAAsBD,IAAI,CAACE,EAApC,IAA0CJ,MAA9C;AACAT,IAAAA,CAAC,GAAGW,IAAI,CAACI,GAAL,CAAS,CAAC,KAAK,KAAK,CAAX,IAAgB,GAAhB,GAAsBJ,IAAI,CAACE,EAApC,IAA0CJ,MAA9C;;AAEA,QAAI2B,QAAJ,EAAc;AACZ,UAAI,CAAC/D,IAAD,IAASA,IAAI,KAAK2E,SAAtB,EAAiC;AAC/BZ,QAAAA,QAAQ,CAACa,MAAT;AACD,OAFD,MAEO;AACLb,QAAAA,QAAQ,CAACJ,IAAT,CAAc/E,QAAQ,CAACA,QAAQ,CAAC,EAAD,EAAK0E,MAAL,CAAT,EAAuB;AAC3C5B,UAAAA,CAAC,EAAEA,CADwC;AAE3CC,UAAAA,CAAC,EAAE,CAACA;AAFuC,SAAvB,CAAtB;AAID;AACF,KATD,MASO,IAAI3B,IAAJ,EAAU;AACfY,MAAAA,KAAK,CAACK,QAAN,CAAe,QAAf,EAAyB;AACvBC,QAAAA,KAAK,EAAEtC,QAAQ,CAACA,QAAQ,CAAC,EAAD,EAAK0E,MAAL,CAAT,EAAuB;AACpC5B,UAAAA,CAAC,EAAEA,CADiC;AAEpCC,UAAAA,CAAC,EAAE,CAACA;AAFgC,SAAvB,CADQ;AAKvBR,QAAAA,SAAS,EAAE,iBALY;AAMvBE,QAAAA,IAAI,EAAE,iBANiB;AAOvBwD,QAAAA,aAAa,EAAE;AAPQ,OAAzB;AASD;;AAEDnD,IAAAA,CAAC,GAAGY,IAAI,CAACC,GAAL,CAAS,CAAC,KAAK,KAAK,CAAX,IAAgB,GAAhB,GAAsBD,IAAI,CAACE,EAApC,IAA0CJ,MAA9C;AACAT,IAAAA,CAAC,GAAGW,IAAI,CAACI,GAAL,CAAS,CAAC,KAAK,KAAK,CAAX,IAAgB,GAAhB,GAAsBJ,IAAI,CAACE,EAApC,IAA0CJ,MAA9C;;AAEA,QAAIgC,cAAJ,EAAoB;AAClB,UAAI,CAACvC,UAAD,IAAeA,UAAU,KAAK8C,SAAlC,EAA6C;AAC3CP,QAAAA,cAAc,CAACQ,MAAf;AACD,OAFD,MAEO;AACLR,QAAAA,cAAc,CAACT,IAAf,CAAoB/E,QAAQ,CAACA,QAAQ,CAAC,EAAD,EAAK0E,MAAL,CAAT,EAAuB;AACjD5B,UAAAA,CAAC,EAAEA,CAD8C;AAEjDC,UAAAA,CAAC,EAAE,CAACA;AAF6C,SAAvB,CAA5B;AAID;AACF,KATD,MASO,IAAIE,UAAJ,EAAgB;AACrBjB,MAAAA,KAAK,CAACK,QAAN,CAAe,QAAf,EAAyB;AACvBC,QAAAA,KAAK,EAAEtC,QAAQ,CAACA,QAAQ,CAAC,EAAD,EAAK0E,MAAL,CAAT,EAAuB;AACpC5B,UAAAA,CAAC,EAAEA,CADiC;AAEpCC,UAAAA,CAAC,EAAE,CAACA;AAFgC,SAAvB,CADQ;AAKvBR,QAAAA,SAAS,EAAE,wBALY;AAMvBE,QAAAA,IAAI,EAAE,wBANiB;AAOvBwD,QAAAA,aAAa,EAAE;AAPQ,OAAzB;AASD;;AAEDnD,IAAAA,CAAC,GAAGY,IAAI,CAACC,GAAL,CAAS,CAAC,KAAK,KAAK,CAAX,IAAgB,GAAhB,GAAsBD,IAAI,CAACE,EAApC,IAA0CJ,MAA9C;AACAT,IAAAA,CAAC,GAAGW,IAAI,CAACI,GAAL,CAAS,CAAC,KAAK,KAAK,CAAX,IAAgB,GAAhB,GAAsBJ,IAAI,CAACE,EAApC,IAA0CJ,MAA9C;;AAEA,QAAIiC,eAAJ,EAAqB;AACnB,UAAI,CAACvC,WAAD,IAAgBA,WAAW,KAAK6C,SAApC,EAA+C;AAC7CP,QAAAA,cAAc,CAACQ,MAAf;AACD,OAFD,MAEO;AACLP,QAAAA,eAAe,CAACV,IAAhB,CAAqB/E,QAAQ,CAACA,QAAQ,CAAC,EAAD,EAAK0E,MAAL,CAAT,EAAuB;AAClD5B,UAAAA,CAAC,EAAEA,CAD+C;AAElDC,UAAAA,CAAC,EAAE,CAACA;AAF8C,SAAvB,CAA7B;AAID;AACF,KATD,MASO,IAAIG,WAAJ,EAAiB;AACtBlB,MAAAA,KAAK,CAACK,QAAN,CAAe,QAAf,EAAyB;AACvBC,QAAAA,KAAK,EAAEtC,QAAQ,CAACA,QAAQ,CAAC,EAAD,EAAK0E,MAAL,CAAT,EAAuB;AACpC5B,UAAAA,CAAC,EAAEA,CADiC;AAEpCC,UAAAA,CAAC,EAAE,CAACA;AAFgC,SAAvB,CADQ;AAKvBR,QAAAA,SAAS,EAAE,yBALY;AAMvBE,QAAAA,IAAI,EAAE,yBANiB;AAOvBwD,QAAAA,aAAa,EAAE;AAPQ,OAAzB;AASD;AACF;AA5ZwB,CAA3B,EA6ZG,aA7ZH","sourcesContent":["import { __assign, __rest } from \"tslib\";\nimport { mix } from '@antv/util';\nimport Global from '../../global';\nimport Shape from '../shape'; // 五角星shape\n\nShape.registerNode('star', {\n  // 自定义节点时的配置\n  options: {\n    size: 60,\n    style: {\n      stroke: Global.defaultNode.style.stroke,\n      fill: Global.defaultNode.style.fill,\n      lineWidth: Global.defaultNode.style.lineWidth\n    },\n    labelCfg: {\n      style: {\n        fill: Global.nodeLabel.style.fill,\n        fontSize: Global.nodeLabel.style.fontSize\n      }\n    },\n    // 节点上左右上下四个方向上的链接circle配置\n    linkPoints: {\n      top: false,\n      right: false,\n      bottom: false,\n      left: false,\n      // circle的大小\n      size: Global.defaultNode.linkPoints.size,\n      lineWidth: Global.defaultNode.linkPoints.lineWidth,\n      fill: Global.defaultNode.linkPoints.fill,\n      stroke: Global.defaultNode.linkPoints.stroke\n    },\n    // 节点中icon配置\n    icon: {\n      // 是否显示icon，值为 false 则不渲染icon\n      show: false,\n      // icon的地址，字符串类型\n      img: 'https://gw.alipayobjects.com/zos/bmw-prod/5d015065-8505-4e7a-baec-976f81e3c41d.svg',\n      width: 20,\n      height: 20\n    },\n    stateStyles: __assign({}, Global.nodeStateStyles)\n  },\n  shapeType: 'star',\n  // 文本位置\n  labelPosition: 'center',\n  drawShape: function drawShape(cfg, group) {\n    var _a = this.getOptions(cfg).icon,\n        icon = _a === void 0 ? {} : _a;\n    var style = this.getShapeStyle(cfg);\n    var keyShape = group.addShape('path', {\n      attrs: style,\n      className: this.type + \"-keyShape\",\n      name: this.type + \"-keyShape\",\n      draggable: true\n    });\n    var w = icon.width,\n        h = icon.height,\n        show = icon.show;\n\n    if (show) {\n      var image = group.addShape('image', {\n        attrs: __assign({\n          x: -w / 2,\n          y: -h / 2\n        }, icon),\n        className: this.type + \"-icon\",\n        name: this.type + \"-icon\",\n        draggable: true\n      });\n    }\n\n    this.drawLinkPoints(cfg, group);\n    return keyShape;\n  },\n\n  /**\n   * 绘制节点上的LinkPoints\n   * @param {Object} cfg data数据配置项\n   * @param {Group} group Group实例\n   */\n  drawLinkPoints: function drawLinkPoints(cfg, group) {\n    var _a = this.getOptions(cfg).linkPoints,\n        linkPoints = _a === void 0 ? {} : _a;\n\n    var top = linkPoints.top,\n        left = linkPoints.left,\n        right = linkPoints.right,\n        leftBottom = linkPoints.leftBottom,\n        rightBottom = linkPoints.rightBottom,\n        markSize = linkPoints.size,\n        markR = linkPoints.r,\n        markStyle = __rest(linkPoints, [\"top\", \"left\", \"right\", \"leftBottom\", \"rightBottom\", \"size\", \"r\"]);\n\n    var size = this.getSize(cfg);\n    var outerR = size[0];\n\n    if (right) {\n      // right circle\n      // up down left right 四个方向的坐标均不相同\n      var x1 = Math.cos((18 + 72 * 0) / 180 * Math.PI) * outerR;\n      var y1 = Math.sin((18 + 72 * 0) / 180 * Math.PI) * outerR;\n      group.addShape('circle', {\n        attrs: __assign(__assign({}, markStyle), {\n          x: x1,\n          y: -y1,\n          r: markSize / 2 || markR || 5\n        }),\n        className: 'link-point-right',\n        name: 'link-point-right'\n      });\n    }\n\n    if (top) {\n      // up down left right 四个方向的坐标均不相同\n      var x1 = Math.cos((18 + 72 * 1) / 180 * Math.PI) * outerR;\n      var y1 = Math.sin((18 + 72 * 1) / 180 * Math.PI) * outerR; // top circle\n\n      group.addShape('circle', {\n        attrs: __assign(__assign({}, markStyle), {\n          x: x1,\n          y: -y1,\n          r: markSize / 2 || markR || 5\n        }),\n        className: 'link-point-top',\n        name: 'link-point-top'\n      });\n    }\n\n    if (left) {\n      // up down left right 四个方向的坐标均不相同\n      var x1 = Math.cos((18 + 72 * 2) / 180 * Math.PI) * outerR;\n      var y1 = Math.sin((18 + 72 * 2) / 180 * Math.PI) * outerR; // left circle\n\n      group.addShape('circle', {\n        attrs: __assign(__assign({}, markStyle), {\n          x: x1,\n          y: -y1,\n          r: markSize / 2 || markR || 5\n        }),\n        className: 'link-point-left',\n        name: 'link-point-left'\n      });\n    }\n\n    if (leftBottom) {\n      // up down left right 四个方向的坐标均不相同\n      var x1 = Math.cos((18 + 72 * 3) / 180 * Math.PI) * outerR;\n      var y1 = Math.sin((18 + 72 * 3) / 180 * Math.PI) * outerR; // left bottom circle\n\n      group.addShape('circle', {\n        attrs: __assign(__assign({}, markStyle), {\n          x: x1,\n          y: -y1,\n          r: markSize / 2 || markR || 5\n        }),\n        className: 'link-point-left-bottom',\n        name: 'link-point-left-bottom'\n      });\n    }\n\n    if (rightBottom) {\n      // up down left right 四个方向的坐标均不相同\n      var x1 = Math.cos((18 + 72 * 4) / 180 * Math.PI) * outerR;\n      var y1 = Math.sin((18 + 72 * 4) / 180 * Math.PI) * outerR; // left bottom circle\n\n      group.addShape('circle', {\n        attrs: __assign(__assign({}, markStyle), {\n          x: x1,\n          y: -y1,\n          r: markSize / 2 || markR || 5\n        }),\n        className: 'link-point-right-bottom',\n        name: 'link-point-right-bottom'\n      });\n    }\n  },\n  getPath: function getPath(cfg) {\n    var size = this.getSize(cfg);\n    var outerR = size[0];\n    var defaultInnerR = outerR * 3 / 8;\n    var innerR = cfg.innerR || defaultInnerR;\n    var path = [];\n\n    for (var i = 0; i < 5; i++) {\n      var x1 = Math.cos((18 + 72 * i) / 180 * Math.PI) * outerR;\n      var y1 = Math.sin((18 + 72 * i) / 180 * Math.PI) * outerR;\n      var x2 = Math.cos((54 + 72 * i) / 180 * Math.PI) * innerR;\n      var y2 = Math.sin((54 + 72 * i) / 180 * Math.PI) * innerR;\n\n      if (i === 0) {\n        path.push(['M', x1, -y1]);\n      } else {\n        path.push(['L', x1, -y1]);\n      }\n\n      path.push(['L', x2, -y2]);\n    }\n\n    path.push(['Z']);\n    return path;\n  },\n\n  /**\n   * 获取节点的样式，供基于该节点自定义时使用\n   * @param {Object} cfg 节点数据模型\n   * @return {Object} 节点的样式\n   */\n  getShapeStyle: function getShapeStyle(cfg) {\n    var defaultStyle = this.getOptions(cfg).style;\n    var strokeStyle = {\n      stroke: cfg.color\n    }; // 如果设置了color，则覆盖原来默认的 stroke 属性。但 cfg 中但 stroke 属性优先级更高\n\n    var style = mix({}, defaultStyle, strokeStyle);\n    var path = this.getPath(cfg);\n\n    var styles = __assign({\n      path: path\n    }, style);\n\n    return styles;\n  },\n  update: function update(cfg, item) {\n    var group = item.getContainer(); // 这里不传 cfg 参数是因为 cfg.style 需要最后覆盖样式\n\n    var defaultStyle = this.getOptions({}).style;\n    var path = this.getPath(cfg); // 下面这些属性需要覆盖默认样式与目前样式，但若在 cfg 中有指定则应该被 cfg 的相应配置覆盖。\n\n    var strokeStyle = {\n      stroke: cfg.color,\n      path: path\n    }; // 与 getShapeStyle 不同在于，update 时需要获取到当前的 style 进行融合。即新传入的配置项中没有涉及的属性，保留当前的配置。\n\n    var keyShape = item.get('keyShape');\n    var style = mix({}, defaultStyle, keyShape.attr(), strokeStyle);\n    style = mix(style, cfg.style);\n    this.updateShape(cfg, item, style, true);\n    this.updateLinkPoints(cfg, group);\n  },\n\n  /**\n   * 更新linkPoints\n   * @param {Object} cfg 节点数据配置项\n   * @param {Group} group Item所在的group\n   */\n  updateLinkPoints: function updateLinkPoints(cfg, group) {\n    var defaultLinkPoints = this.getOptions({}).linkPoints;\n    var markLeft = group.find(function (element) {\n      return element.get('className') === 'link-point-left';\n    });\n    var markRight = group.find(function (element) {\n      return element.get('className') === 'link-point-right';\n    });\n    var markTop = group.find(function (element) {\n      return element.get('className') === 'link-point-top';\n    });\n    var markLeftBottom = group.find(function (element) {\n      return element.get('className') === 'link-point-left-bottom';\n    });\n    var markRightBottom = group.find(function (element) {\n      return element.get('className') === 'link-point-right-bottom';\n    });\n    var currentLinkPoints = defaultLinkPoints;\n    var existLinkPoint = markLeft || markRight || markTop || markLeftBottom || markRightBottom;\n\n    if (existLinkPoint) {\n      currentLinkPoints = existLinkPoint.attr();\n    }\n\n    var linkPoints = mix({}, currentLinkPoints, cfg.linkPoints);\n    var markFill = linkPoints.fill,\n        markStroke = linkPoints.stroke,\n        borderWidth = linkPoints.lineWidth;\n    var markSize = linkPoints.size / 2;\n    if (!markSize) markSize = linkPoints.r;\n\n    var _a = cfg.linkPoints ? cfg.linkPoints : {\n      left: undefined,\n      right: undefined,\n      top: undefined,\n      leftBottom: undefined,\n      rightBottom: undefined\n    },\n        left = _a.left,\n        right = _a.right,\n        top = _a.top,\n        leftBottom = _a.leftBottom,\n        rightBottom = _a.rightBottom;\n\n    var size = this.getSize(cfg);\n    var outerR = size[0];\n    var styles = {\n      r: markSize,\n      fill: markFill,\n      stroke: markStroke,\n      lineWidth: borderWidth\n    };\n    var x = Math.cos((18 + 72 * 0) / 180 * Math.PI) * outerR;\n    var y = Math.sin((18 + 72 * 0) / 180 * Math.PI) * outerR;\n\n    if (markRight) {\n      if (!right && right !== undefined) {\n        markRight.remove();\n      } else {\n        markRight.attr(__assign(__assign({}, styles), {\n          x: x,\n          y: -y\n        }));\n      }\n    } else if (right) {\n      group.addShape('circle', {\n        attrs: __assign(__assign({}, styles), {\n          x: x,\n          y: -y\n        }),\n        className: 'link-point-right',\n        name: 'link-point-right',\n        isAnchorPoint: true\n      });\n    }\n\n    x = Math.cos((18 + 72 * 1) / 180 * Math.PI) * outerR;\n    y = Math.sin((18 + 72 * 1) / 180 * Math.PI) * outerR;\n\n    if (markTop) {\n      if (!top && top !== undefined) {\n        markTop.remove();\n      } else {\n        markTop.attr(__assign(__assign({}, styles), {\n          x: x,\n          y: -y\n        }));\n      }\n    } else if (top) {\n      group.addShape('circle', {\n        attrs: __assign(__assign({}, styles), {\n          x: x,\n          y: -y\n        }),\n        className: 'link-point-top',\n        name: 'link-point-top',\n        isAnchorPoint: true\n      });\n    }\n\n    x = Math.cos((18 + 72 * 2) / 180 * Math.PI) * outerR;\n    y = Math.sin((18 + 72 * 2) / 180 * Math.PI) * outerR;\n\n    if (markLeft) {\n      if (!left && left !== undefined) {\n        markLeft.remove();\n      } else {\n        markLeft.attr(__assign(__assign({}, styles), {\n          x: x,\n          y: -y\n        }));\n      }\n    } else if (left) {\n      group.addShape('circle', {\n        attrs: __assign(__assign({}, styles), {\n          x: x,\n          y: -y\n        }),\n        className: 'link-point-left',\n        name: 'link-point-left',\n        isAnchorPoint: true\n      });\n    }\n\n    x = Math.cos((18 + 72 * 3) / 180 * Math.PI) * outerR;\n    y = Math.sin((18 + 72 * 3) / 180 * Math.PI) * outerR;\n\n    if (markLeftBottom) {\n      if (!leftBottom && leftBottom !== undefined) {\n        markLeftBottom.remove();\n      } else {\n        markLeftBottom.attr(__assign(__assign({}, styles), {\n          x: x,\n          y: -y\n        }));\n      }\n    } else if (leftBottom) {\n      group.addShape('circle', {\n        attrs: __assign(__assign({}, styles), {\n          x: x,\n          y: -y\n        }),\n        className: 'link-point-left-bottom',\n        name: 'link-point-left-bottom',\n        isAnchorPoint: true\n      });\n    }\n\n    x = Math.cos((18 + 72 * 4) / 180 * Math.PI) * outerR;\n    y = Math.sin((18 + 72 * 4) / 180 * Math.PI) * outerR;\n\n    if (markRightBottom) {\n      if (!rightBottom && rightBottom !== undefined) {\n        markLeftBottom.remove();\n      } else {\n        markRightBottom.attr(__assign(__assign({}, styles), {\n          x: x,\n          y: -y\n        }));\n      }\n    } else if (rightBottom) {\n      group.addShape('circle', {\n        attrs: __assign(__assign({}, styles), {\n          x: x,\n          y: -y\n        }),\n        className: 'link-point-right-bottom',\n        name: 'link-point-right-bottom',\n        isAnchorPoint: true\n      });\n    }\n  }\n}, 'single-node');"]},"metadata":{},"sourceType":"module"}