{"ast":null,"code":"\"use strict\";\n\nexports.__esModule = true;\n\nvar Transformable_1 = require(\"./core/Transformable\");\n\nvar Animator_1 = require(\"./animation/Animator\");\n\nvar BoundingRect_1 = require(\"./core/BoundingRect\");\n\nvar Eventful_1 = require(\"./core/Eventful\");\n\nvar text_1 = require(\"./contain/text\");\n\nvar util_1 = require(\"./core/util\");\n\nvar config_1 = require(\"./config\");\n\nvar color_1 = require(\"./tool/color\");\n\nvar env_1 = require(\"./core/env\");\n\nexports.PRESERVED_NORMAL_STATE = '__zr_normal__';\nvar PRIMARY_STATES_KEYS = ['x', 'y', 'scaleX', 'scaleY', 'originX', 'originY', 'rotation', 'ignore'];\nvar DEFAULT_ANIMATABLE_MAP = {\n  x: true,\n  y: true,\n  scaleX: true,\n  scaleY: true,\n  originX: true,\n  originY: true,\n  rotation: true,\n  ignore: false\n};\nvar tmpTextPosCalcRes = {};\nvar tmpBoundingRect = new BoundingRect_1[\"default\"](0, 0, 0, 0);\n\nvar Element = function () {\n  function Element(props) {\n    this.id = util_1.guid();\n    this.animators = [];\n    this.currentStates = [];\n    this.states = {};\n\n    this._init(props);\n  }\n\n  Element.prototype._init = function (props) {\n    this.attr(props);\n  };\n\n  Element.prototype.drift = function (dx, dy, e) {\n    switch (this.draggable) {\n      case 'horizontal':\n        dy = 0;\n        break;\n\n      case 'vertical':\n        dx = 0;\n        break;\n    }\n\n    var m = this.transform;\n\n    if (!m) {\n      m = this.transform = [1, 0, 0, 1, 0, 0];\n    }\n\n    m[4] += dx;\n    m[5] += dy;\n    this.decomposeTransform();\n    this.markRedraw();\n  };\n\n  Element.prototype.beforeUpdate = function () {};\n\n  Element.prototype.afterUpdate = function () {};\n\n  Element.prototype.update = function () {\n    this.updateTransform();\n\n    if (this.__dirty) {\n      this.updateInnerText();\n    }\n  };\n\n  Element.prototype.updateInnerText = function (forceUpdate) {\n    var textEl = this._textContent;\n\n    if (textEl && (!textEl.ignore || forceUpdate)) {\n      if (!this.textConfig) {\n        this.textConfig = {};\n      }\n\n      var textConfig = this.textConfig;\n      var isLocal = textConfig.local;\n      var attachedTransform = textEl.attachedTransform;\n      var textAlign = void 0;\n      var textVerticalAlign = void 0;\n      var textStyleChanged = false;\n\n      if (isLocal) {\n        attachedTransform.parent = this;\n      } else {\n        attachedTransform.parent = null;\n      }\n\n      var innerOrigin = false;\n      attachedTransform.x = textEl.x;\n      attachedTransform.y = textEl.y;\n      attachedTransform.originX = textEl.originX;\n      attachedTransform.originY = textEl.originY;\n      attachedTransform.rotation = textEl.rotation;\n      attachedTransform.scaleX = textEl.scaleX;\n      attachedTransform.scaleY = textEl.scaleY;\n\n      if (textConfig.position != null) {\n        var layoutRect = tmpBoundingRect;\n\n        if (textConfig.layoutRect) {\n          layoutRect.copy(textConfig.layoutRect);\n        } else {\n          layoutRect.copy(this.getBoundingRect());\n        }\n\n        if (!isLocal) {\n          layoutRect.applyTransform(this.transform);\n        }\n\n        if (this.calculateTextPosition) {\n          this.calculateTextPosition(tmpTextPosCalcRes, textConfig, layoutRect);\n        } else {\n          text_1.calculateTextPosition(tmpTextPosCalcRes, textConfig, layoutRect);\n        }\n\n        attachedTransform.x = tmpTextPosCalcRes.x;\n        attachedTransform.y = tmpTextPosCalcRes.y;\n        textAlign = tmpTextPosCalcRes.align;\n        textVerticalAlign = tmpTextPosCalcRes.verticalAlign;\n        var textOrigin = textConfig.origin;\n\n        if (textOrigin && textConfig.rotation != null) {\n          var relOriginX = void 0;\n          var relOriginY = void 0;\n\n          if (textOrigin === 'center') {\n            relOriginX = layoutRect.width * 0.5;\n            relOriginY = layoutRect.height * 0.5;\n          } else {\n            relOriginX = text_1.parsePercent(textOrigin[0], layoutRect.width);\n            relOriginY = text_1.parsePercent(textOrigin[1], layoutRect.height);\n          }\n\n          innerOrigin = true;\n          attachedTransform.originX = -attachedTransform.x + relOriginX + (isLocal ? 0 : layoutRect.x);\n          attachedTransform.originY = -attachedTransform.y + relOriginY + (isLocal ? 0 : layoutRect.y);\n        }\n      }\n\n      if (textConfig.rotation != null) {\n        attachedTransform.rotation = textConfig.rotation;\n      }\n\n      var textOffset = textConfig.offset;\n\n      if (textOffset) {\n        attachedTransform.x += textOffset[0];\n        attachedTransform.y += textOffset[1];\n\n        if (!innerOrigin) {\n          attachedTransform.originX = -textOffset[0];\n          attachedTransform.originY = -textOffset[1];\n        }\n      }\n\n      var isInside = textConfig.inside == null ? typeof textConfig.position === 'string' && textConfig.position.indexOf('inside') >= 0 : textConfig.inside;\n      var innerTextDefaultStyle = this._innerTextDefaultStyle || (this._innerTextDefaultStyle = {});\n      var textFill = void 0;\n      var textStroke = void 0;\n      var autoStroke = void 0;\n\n      if (isInside && this.canBeInsideText()) {\n        textFill = textConfig.insideFill;\n        textStroke = textConfig.insideStroke;\n\n        if (textFill == null || textFill === 'auto') {\n          textFill = this.getInsideTextFill();\n        }\n\n        if (textStroke == null || textStroke === 'auto') {\n          textStroke = this.getInsideTextStroke(textFill);\n          autoStroke = true;\n        }\n      } else {\n        textFill = textConfig.outsideFill;\n        textStroke = textConfig.outsideStroke;\n\n        if (textFill == null || textFill === 'auto') {\n          textFill = this.getOutsideFill();\n        }\n\n        if (textStroke == null || textStroke === 'auto') {\n          textStroke = this.getOutsideStroke(textFill);\n          autoStroke = true;\n        }\n      }\n\n      textFill = textFill || '#000';\n\n      if (textFill !== innerTextDefaultStyle.fill || textStroke !== innerTextDefaultStyle.stroke || autoStroke !== innerTextDefaultStyle.autoStroke || textAlign !== innerTextDefaultStyle.align || textVerticalAlign !== innerTextDefaultStyle.verticalAlign) {\n        textStyleChanged = true;\n        innerTextDefaultStyle.fill = textFill;\n        innerTextDefaultStyle.stroke = textStroke;\n        innerTextDefaultStyle.autoStroke = autoStroke;\n        innerTextDefaultStyle.align = textAlign;\n        innerTextDefaultStyle.verticalAlign = textVerticalAlign;\n        textEl.setDefaultTextStyle(innerTextDefaultStyle);\n      }\n\n      if (textStyleChanged) {\n        textEl.dirtyStyle();\n      }\n\n      textEl.markRedraw();\n    }\n  };\n\n  Element.prototype.canBeInsideText = function () {\n    return true;\n  };\n\n  Element.prototype.getInsideTextFill = function () {\n    return '#fff';\n  };\n\n  Element.prototype.getInsideTextStroke = function (textFill) {\n    return '#000';\n  };\n\n  Element.prototype.getOutsideFill = function () {\n    return this.__zr && this.__zr.isDarkMode() ? config_1.LIGHT_LABEL_COLOR : config_1.DARK_LABEL_COLOR;\n  };\n\n  Element.prototype.getOutsideStroke = function (textFill) {\n    var backgroundColor = this.__zr && this.__zr.getBackgroundColor();\n\n    var colorArr = typeof backgroundColor === 'string' && color_1.parse(backgroundColor);\n\n    if (!colorArr) {\n      colorArr = [255, 255, 255, 1];\n    }\n\n    var alpha = colorArr[3];\n\n    var isDark = this.__zr.isDarkMode();\n\n    for (var i = 0; i < 3; i++) {\n      colorArr[i] = colorArr[i] * alpha + (isDark ? 0 : 255) * (1 - alpha);\n    }\n\n    colorArr[3] = 1;\n    return color_1.stringify(colorArr, 'rgba');\n  };\n\n  Element.prototype.traverse = function (cb, context) {};\n\n  Element.prototype.attrKV = function (key, value) {\n    if (key === 'textConfig') {\n      this.setTextConfig(value);\n    } else if (key === 'textContent') {\n      this.setTextContent(value);\n    } else if (key === 'clipPath') {\n      this.setClipPath(value);\n    } else if (key === 'extra') {\n      this.extra = this.extra || {};\n      util_1.extend(this.extra, value);\n    } else {\n      this[key] = value;\n    }\n  };\n\n  Element.prototype.hide = function () {\n    this.ignore = true;\n    this.markRedraw();\n  };\n\n  Element.prototype.show = function () {\n    this.ignore = false;\n    this.markRedraw();\n  };\n\n  Element.prototype.attr = function (keyOrObj, value) {\n    if (typeof keyOrObj === 'string') {\n      this.attrKV(keyOrObj, value);\n    } else if (util_1.isObject(keyOrObj)) {\n      var obj = keyOrObj;\n      var keysArr = util_1.keys(obj);\n\n      for (var i = 0; i < keysArr.length; i++) {\n        var key = keysArr[i];\n        this.attrKV(key, keyOrObj[key]);\n      }\n    }\n\n    this.markRedraw();\n    return this;\n  };\n\n  Element.prototype.saveCurrentToNormalState = function (toState) {\n    this._innerSaveToNormal(toState);\n\n    var normalState = this._normalState;\n\n    for (var i = 0; i < this.animators.length; i++) {\n      var animator = this.animators[i];\n      var fromStateTransition = animator.__fromStateTransition;\n\n      if (fromStateTransition && fromStateTransition !== exports.PRESERVED_NORMAL_STATE) {\n        continue;\n      }\n\n      var targetName = animator.targetName;\n      var target = targetName ? normalState[targetName] : normalState;\n      animator.saveFinalToTarget(target);\n    }\n  };\n\n  Element.prototype._innerSaveToNormal = function (toState) {\n    var normalState = this._normalState;\n\n    if (!normalState) {\n      normalState = this._normalState = {};\n    }\n\n    if (toState.textConfig && !normalState.textConfig) {\n      normalState.textConfig = this.textConfig;\n    }\n\n    this._savePrimaryToNormal(toState, normalState, PRIMARY_STATES_KEYS);\n  };\n\n  Element.prototype._savePrimaryToNormal = function (toState, normalState, primaryKeys) {\n    for (var i = 0; i < primaryKeys.length; i++) {\n      var key = primaryKeys[i];\n\n      if (toState[key] != null && !(key in normalState)) {\n        normalState[key] = this[key];\n      }\n    }\n  };\n\n  Element.prototype.hasState = function () {\n    return this.currentStates.length > 0;\n  };\n\n  Element.prototype.getState = function (name) {\n    return this.states[name];\n  };\n\n  Element.prototype.ensureState = function (name) {\n    var states = this.states;\n\n    if (!states[name]) {\n      states[name] = {};\n    }\n\n    return states[name];\n  };\n\n  Element.prototype.clearStates = function (noAnimation) {\n    this.useState(exports.PRESERVED_NORMAL_STATE, false, noAnimation);\n  };\n\n  Element.prototype.useState = function (stateName, keepCurrentStates, noAnimation) {\n    var toNormalState = stateName === exports.PRESERVED_NORMAL_STATE;\n    var hasStates = this.hasState();\n\n    if (!hasStates && toNormalState) {\n      return;\n    }\n\n    var currentStates = this.currentStates;\n    var animationCfg = this.stateTransition;\n\n    if (util_1.indexOf(currentStates, stateName) >= 0 && (keepCurrentStates || currentStates.length === 1)) {\n      return;\n    }\n\n    var state;\n\n    if (this.stateProxy && !toNormalState) {\n      state = this.stateProxy(stateName);\n    }\n\n    if (!state) {\n      state = this.states && this.states[stateName];\n    }\n\n    if (!state && !toNormalState) {\n      util_1.logError(\"State \" + stateName + \" not exists.\");\n      return;\n    }\n\n    if (!toNormalState) {\n      this.saveCurrentToNormalState(state);\n    }\n\n    var useHoverLayer = !!(state && state.hoverLayer);\n\n    if (useHoverLayer) {\n      this._toggleHoverLayerFlag(true);\n    }\n\n    this._applyStateObj(stateName, state, this._normalState, keepCurrentStates, !noAnimation && !this.__inHover && animationCfg && animationCfg.duration > 0, animationCfg);\n\n    if (this._textContent) {\n      this._textContent.useState(stateName, keepCurrentStates);\n    }\n\n    if (this._textGuide) {\n      this._textGuide.useState(stateName, keepCurrentStates);\n    }\n\n    if (toNormalState) {\n      this.currentStates = [];\n      this._normalState = {};\n    } else {\n      if (!keepCurrentStates) {\n        this.currentStates = [stateName];\n      } else {\n        this.currentStates.push(stateName);\n      }\n    }\n\n    this._updateAnimationTargets();\n\n    this.markRedraw();\n\n    if (!useHoverLayer && this.__inHover) {\n      this._toggleHoverLayerFlag(false);\n\n      this.__dirty &= ~Element.REDARAW_BIT;\n    }\n\n    return state;\n  };\n\n  Element.prototype.useStates = function (states, noAnimation) {\n    if (!states.length) {\n      this.clearStates();\n    } else {\n      var stateObjects = [];\n      var currentStates = this.currentStates;\n      var len = states.length;\n      var notChange = len === currentStates.length;\n\n      if (notChange) {\n        for (var i = 0; i < len; i++) {\n          if (states[i] !== currentStates[i]) {\n            notChange = false;\n            break;\n          }\n        }\n      }\n\n      if (notChange) {\n        return;\n      }\n\n      for (var i = 0; i < len; i++) {\n        var stateName = states[i];\n        var stateObj = void 0;\n\n        if (this.stateProxy) {\n          stateObj = this.stateProxy(stateName, states);\n        }\n\n        if (!stateObj) {\n          stateObj = this.states[stateName];\n        }\n\n        if (stateObj) {\n          stateObjects.push(stateObj);\n        }\n      }\n\n      var useHoverLayer = !!(stateObjects[len - 1] && stateObjects[len - 1].hoverLayer);\n\n      if (useHoverLayer) {\n        this._toggleHoverLayerFlag(true);\n      }\n\n      var mergedState = this._mergeStates(stateObjects);\n\n      var animationCfg = this.stateTransition;\n      this.saveCurrentToNormalState(mergedState);\n\n      this._applyStateObj(states.join(','), mergedState, this._normalState, false, !noAnimation && !this.__inHover && animationCfg && animationCfg.duration > 0, animationCfg);\n\n      if (this._textContent) {\n        this._textContent.useStates(states);\n      }\n\n      if (this._textGuide) {\n        this._textGuide.useStates(states);\n      }\n\n      this._updateAnimationTargets();\n\n      this.currentStates = states.slice();\n      this.markRedraw();\n\n      if (!useHoverLayer && this.__inHover) {\n        this._toggleHoverLayerFlag(false);\n\n        this.__dirty &= ~Element.REDARAW_BIT;\n      }\n    }\n  };\n\n  Element.prototype._updateAnimationTargets = function () {\n    for (var i = 0; i < this.animators.length; i++) {\n      var animator = this.animators[i];\n\n      if (animator.targetName) {\n        animator.changeTarget(this[animator.targetName]);\n      }\n    }\n  };\n\n  Element.prototype.removeState = function (state) {\n    var idx = util_1.indexOf(this.currentStates, state);\n\n    if (idx >= 0) {\n      var currentStates = this.currentStates.slice();\n      currentStates.splice(idx, 1);\n      this.useStates(currentStates);\n    }\n  };\n\n  Element.prototype.replaceState = function (oldState, newState, forceAdd) {\n    var currentStates = this.currentStates.slice();\n    var idx = util_1.indexOf(currentStates, oldState);\n    var newStateExists = util_1.indexOf(currentStates, newState) >= 0;\n\n    if (idx >= 0) {\n      if (!newStateExists) {\n        currentStates[idx] = newState;\n      } else {\n        currentStates.splice(idx, 1);\n      }\n    } else if (forceAdd && !newStateExists) {\n      currentStates.push(newState);\n    }\n\n    this.useStates(currentStates);\n  };\n\n  Element.prototype.toggleState = function (state, enable) {\n    if (enable) {\n      this.useState(state, true);\n    } else {\n      this.removeState(state);\n    }\n  };\n\n  Element.prototype._mergeStates = function (states) {\n    var mergedState = {};\n    var mergedTextConfig;\n\n    for (var i = 0; i < states.length; i++) {\n      var state = states[i];\n      util_1.extend(mergedState, state);\n\n      if (state.textConfig) {\n        mergedTextConfig = mergedTextConfig || {};\n        util_1.extend(mergedTextConfig, state.textConfig);\n      }\n    }\n\n    if (mergedTextConfig) {\n      mergedState.textConfig = mergedTextConfig;\n    }\n\n    return mergedState;\n  };\n\n  Element.prototype._applyStateObj = function (stateName, state, normalState, keepCurrentStates, transition, animationCfg) {\n    var needsRestoreToNormal = !(state && keepCurrentStates);\n\n    if (state && state.textConfig) {\n      this.textConfig = util_1.extend({}, keepCurrentStates ? this.textConfig : normalState.textConfig);\n      util_1.extend(this.textConfig, state.textConfig);\n    } else if (needsRestoreToNormal) {\n      if (normalState.textConfig) {\n        this.textConfig = normalState.textConfig;\n      }\n    }\n\n    var transitionTarget = {};\n    var hasTransition = false;\n\n    for (var i = 0; i < PRIMARY_STATES_KEYS.length; i++) {\n      var key = PRIMARY_STATES_KEYS[i];\n      var propNeedsTransition = transition && DEFAULT_ANIMATABLE_MAP[key];\n\n      if (state && state[key] != null) {\n        if (propNeedsTransition) {\n          hasTransition = true;\n          transitionTarget[key] = state[key];\n        } else {\n          this[key] = state[key];\n        }\n      } else if (needsRestoreToNormal) {\n        if (normalState[key] != null) {\n          if (propNeedsTransition) {\n            hasTransition = true;\n            transitionTarget[key] = normalState[key];\n          } else {\n            this[key] = normalState[key];\n          }\n        }\n      }\n    }\n\n    if (!transition) {\n      for (var i = 0; i < this.animators.length; i++) {\n        var animator = this.animators[i];\n        var targetName = animator.targetName;\n\n        animator.__changeFinalValue(targetName ? (state || normalState)[targetName] : state || normalState);\n      }\n    }\n\n    if (hasTransition) {\n      this._transitionState(stateName, transitionTarget, animationCfg);\n    }\n  };\n\n  Element.prototype._attachComponent = function (componentEl) {\n    if (componentEl.__zr && !componentEl.__hostTarget) {\n      throw new Error('Text element has been added to zrender.');\n    }\n\n    if (componentEl === this) {\n      throw new Error('Recursive component attachment.');\n    }\n\n    var zr = this.__zr;\n\n    if (zr) {\n      componentEl.addSelfToZr(zr);\n    }\n\n    componentEl.__zr = zr;\n    componentEl.__hostTarget = this;\n  };\n\n  Element.prototype._detachComponent = function (componentEl) {\n    if (componentEl.__zr) {\n      componentEl.removeSelfFromZr(componentEl.__zr);\n    }\n\n    componentEl.__zr = null;\n    componentEl.__hostTarget = null;\n  };\n\n  Element.prototype.getClipPath = function () {\n    return this._clipPath;\n  };\n\n  Element.prototype.setClipPath = function (clipPath) {\n    if (this._clipPath && this._clipPath !== clipPath) {\n      this.removeClipPath();\n    }\n\n    this._attachComponent(clipPath);\n\n    this._clipPath = clipPath;\n    this.markRedraw();\n  };\n\n  Element.prototype.removeClipPath = function () {\n    var clipPath = this._clipPath;\n\n    if (clipPath) {\n      this._detachComponent(clipPath);\n\n      this._clipPath = null;\n      this.markRedraw();\n    }\n  };\n\n  Element.prototype.getTextContent = function () {\n    return this._textContent;\n  };\n\n  Element.prototype.setTextContent = function (textEl) {\n    var previousTextContent = this._textContent;\n\n    if (previousTextContent === textEl) {\n      return;\n    }\n\n    if (previousTextContent && previousTextContent !== textEl) {\n      this.removeTextContent();\n    }\n\n    if (textEl.__zr && !textEl.__hostTarget) {\n      throw new Error('Text element has been added to zrender.');\n    }\n\n    textEl.attachedTransform = new Transformable_1[\"default\"]();\n\n    this._attachComponent(textEl);\n\n    this._textContent = textEl;\n    this.markRedraw();\n  };\n\n  Element.prototype.setTextConfig = function (cfg) {\n    if (!this.textConfig) {\n      this.textConfig = {};\n    }\n\n    util_1.extend(this.textConfig, cfg);\n    this.markRedraw();\n  };\n\n  Element.prototype.removeTextContent = function () {\n    var textEl = this._textContent;\n\n    if (textEl) {\n      textEl.attachedTransform = null;\n\n      this._detachComponent(textEl);\n\n      this._textContent = null;\n      this._innerTextDefaultStyle = null;\n      this.markRedraw();\n    }\n  };\n\n  Element.prototype.getTextGuideLine = function () {\n    return this._textGuide;\n  };\n\n  Element.prototype.setTextGuideLine = function (guideLine) {\n    if (this._textGuide && this._textGuide !== guideLine) {\n      this.removeTextGuideLine();\n    }\n\n    this._attachComponent(guideLine);\n\n    this._textGuide = guideLine;\n    this.markRedraw();\n  };\n\n  Element.prototype.removeTextGuideLine = function () {\n    var textGuide = this._textGuide;\n\n    if (textGuide) {\n      this._detachComponent(textGuide);\n\n      this._textGuide = null;\n      this.markRedraw();\n    }\n  };\n\n  Element.prototype.markRedraw = function () {\n    this.__dirty |= Element.REDARAW_BIT;\n    var zr = this.__zr;\n\n    if (zr) {\n      if (this.__inHover) {\n        zr.refreshHover();\n      } else {\n        zr.refresh();\n      }\n    }\n\n    if (this.__hostTarget) {\n      this.__hostTarget.markRedraw();\n    }\n  };\n\n  Element.prototype.dirty = function () {\n    this.markRedraw();\n  };\n\n  Element.prototype._toggleHoverLayerFlag = function (inHover) {\n    this.__inHover = inHover;\n    var textContent = this._textContent;\n    var textGuide = this._textGuide;\n\n    if (textContent) {\n      textContent.__inHover = inHover;\n    }\n\n    if (textGuide) {\n      textGuide.__inHover = inHover;\n    }\n  };\n\n  Element.prototype.addSelfToZr = function (zr) {\n    this.__zr = zr;\n    var animators = this.animators;\n\n    if (animators) {\n      for (var i = 0; i < animators.length; i++) {\n        zr.animation.addAnimator(animators[i]);\n      }\n    }\n\n    if (this._clipPath) {\n      this._clipPath.addSelfToZr(zr);\n    }\n\n    if (this._textContent) {\n      this._textContent.addSelfToZr(zr);\n    }\n\n    if (this._textGuide) {\n      this._textGuide.addSelfToZr(zr);\n    }\n  };\n\n  Element.prototype.removeSelfFromZr = function (zr) {\n    this.__zr = null;\n    var animators = this.animators;\n\n    if (animators) {\n      for (var i = 0; i < animators.length; i++) {\n        zr.animation.removeAnimator(animators[i]);\n      }\n    }\n\n    if (this._clipPath) {\n      this._clipPath.removeSelfFromZr(zr);\n    }\n\n    if (this._textContent) {\n      this._textContent.removeSelfFromZr(zr);\n    }\n\n    if (this._textGuide) {\n      this._textGuide.removeSelfFromZr(zr);\n    }\n  };\n\n  Element.prototype.animate = function (key, loop) {\n    var target = key ? this[key] : this;\n\n    if (!target) {\n      util_1.logError('Property \"' + key + '\" is not existed in element ' + this.id);\n      return;\n    }\n\n    var animator = new Animator_1[\"default\"](target, loop);\n    this.addAnimator(animator, key);\n    return animator;\n  };\n\n  Element.prototype.addAnimator = function (animator, key) {\n    var zr = this.__zr;\n    var el = this;\n    animator.during(function () {\n      el.updateDuringAnimation(key);\n    }).done(function () {\n      var animators = el.animators;\n      var idx = util_1.indexOf(animators, animator);\n\n      if (idx >= 0) {\n        animators.splice(idx, 1);\n      }\n    });\n    this.animators.push(animator);\n\n    if (zr) {\n      zr.animation.addAnimator(animator);\n    }\n\n    zr && zr.wakeUp();\n  };\n\n  Element.prototype.updateDuringAnimation = function (key) {\n    this.markRedraw();\n  };\n\n  Element.prototype.stopAnimation = function (scope, forwardToLast) {\n    var animators = this.animators;\n    var len = animators.length;\n    var leftAnimators = [];\n\n    for (var i = 0; i < len; i++) {\n      var animator = animators[i];\n\n      if (!scope || scope === animator.scope) {\n        animator.stop(forwardToLast);\n      } else {\n        leftAnimators.push(animator);\n      }\n    }\n\n    this.animators = leftAnimators;\n    return this;\n  };\n\n  Element.prototype.animateTo = function (target, cfg, animationProps) {\n    animateTo(this, target, cfg, animationProps);\n  };\n\n  Element.prototype.animateFrom = function (target, cfg, animationProps) {\n    animateTo(this, target, cfg, animationProps, true);\n  };\n\n  Element.prototype._transitionState = function (stateName, target, cfg, animationProps) {\n    var animators = animateTo(this, target, cfg, animationProps);\n\n    for (var i = 0; i < animators.length; i++) {\n      animators[i].__fromStateTransition = stateName;\n    }\n  };\n\n  Element.prototype.getBoundingRect = function () {\n    return null;\n  };\n\n  Element.prototype.getPaintRect = function () {\n    return null;\n  };\n\n  Element.REDARAW_BIT = 1;\n\n  Element.initDefaultProps = function () {\n    var elProto = Element.prototype;\n    elProto.type = 'element';\n    elProto.name = '';\n    elProto.ignore = false;\n    elProto.silent = false;\n    elProto.isGroup = false;\n    elProto.draggable = false;\n    elProto.dragging = false;\n    elProto.ignoreClip = false;\n    elProto.__inHover = false;\n    elProto.__dirty = Element.REDARAW_BIT;\n    var logs = {};\n\n    function logDeprecatedError(key, xKey, yKey) {\n      if (!logs[key + xKey + yKey]) {\n        console.warn(\"DEPRECATED: '\" + key + \"' has been deprecated. use '\" + xKey + \"', '\" + yKey + \"' instead\");\n        logs[key + xKey + yKey] = true;\n      }\n    }\n\n    function createLegacyProperty(key, privateKey, xKey, yKey) {\n      Object.defineProperty(elProto, key, {\n        get: function () {\n          logDeprecatedError(key, xKey, yKey);\n\n          if (!this[privateKey]) {\n            var pos = this[privateKey] = [];\n            enhanceArray(this, pos);\n          }\n\n          return this[privateKey];\n        },\n        set: function (pos) {\n          logDeprecatedError(key, xKey, yKey);\n          this[xKey] = pos[0];\n          this[yKey] = pos[1];\n          this[privateKey] = pos;\n          enhanceArray(this, pos);\n        }\n      });\n\n      function enhanceArray(self, pos) {\n        Object.defineProperty(pos, 0, {\n          get: function () {\n            return self[xKey];\n          },\n          set: function (val) {\n            self[xKey] = val;\n          }\n        });\n        Object.defineProperty(pos, 1, {\n          get: function () {\n            return self[yKey];\n          },\n          set: function (val) {\n            self[yKey] = val;\n          }\n        });\n      }\n    }\n\n    if (Object.defineProperty && (!env_1[\"default\"].browser.ie || env_1[\"default\"].browser.version > 8)) {\n      createLegacyProperty('position', '_legacyPos', 'x', 'y');\n      createLegacyProperty('scale', '_legacyScale', 'scaleX', 'scaleY');\n      createLegacyProperty('origin', '_legacyOrigin', 'originX', 'originY');\n    }\n  }();\n\n  return Element;\n}();\n\nutil_1.mixin(Element, Eventful_1[\"default\"]);\nutil_1.mixin(Element, Transformable_1[\"default\"]);\n\nfunction animateTo(animatable, target, cfg, animationProps, reverse) {\n  cfg = cfg || {};\n  var animators = [];\n  animateToShallow(animatable, '', animatable, target, cfg, animationProps, animators, reverse);\n  var finishCount = animators.length;\n  var doneHappened = false;\n  var cfgDone = cfg.done;\n  var cfgAborted = cfg.aborted;\n\n  var doneCb = function () {\n    doneHappened = true;\n    finishCount--;\n\n    if (finishCount <= 0) {\n      doneHappened ? cfgDone && cfgDone() : cfgAborted && cfgAborted();\n    }\n  };\n\n  var abortedCb = function () {\n    finishCount--;\n\n    if (finishCount <= 0) {\n      doneHappened ? cfgDone && cfgDone() : cfgAborted && cfgAborted();\n    }\n  };\n\n  if (!finishCount) {\n    cfgDone && cfgDone();\n  }\n\n  if (animators.length > 0 && cfg.during) {\n    animators[0].during(function (target, percent) {\n      cfg.during(percent);\n    });\n  }\n\n  for (var i = 0; i < animators.length; i++) {\n    var animator = animators[i];\n\n    if (doneCb) {\n      animator.done(doneCb);\n    }\n\n    if (abortedCb) {\n      animator.aborted(abortedCb);\n    }\n\n    animator.start(cfg.easing, cfg.force);\n  }\n\n  return animators;\n}\n\nfunction copyArrShallow(source, target, len) {\n  for (var i = 0; i < len; i++) {\n    source[i] = target[i];\n  }\n}\n\nfunction is2DArray(value) {\n  return util_1.isArrayLike(value[0]);\n}\n\nfunction copyValue(target, source, key) {\n  if (util_1.isArrayLike(source[key])) {\n    if (!util_1.isArrayLike(target[key])) {\n      target[key] = [];\n    }\n\n    if (util_1.isTypedArray(source[key])) {\n      var len = source[key].length;\n\n      if (target[key].length !== len) {\n        target[key] = new source[key].constructor(len);\n        copyArrShallow(target[key], source[key], len);\n      }\n    } else {\n      var sourceArr = source[key];\n      var targetArr = target[key];\n      var len0 = sourceArr.length;\n\n      if (is2DArray(sourceArr)) {\n        var len1 = sourceArr[0].length;\n\n        for (var i = 0; i < len0; i++) {\n          if (!targetArr[i]) {\n            targetArr[i] = Array.prototype.slice.call(sourceArr[i]);\n          } else {\n            copyArrShallow(targetArr[i], sourceArr[i], len1);\n          }\n        }\n      } else {\n        copyArrShallow(targetArr, sourceArr, len0);\n      }\n\n      targetArr.length = sourceArr.length;\n    }\n  } else {\n    target[key] = source[key];\n  }\n}\n\nfunction animateToShallow(animatable, topKey, source, target, cfg, animationProps, animators, reverse) {\n  var animatableKeys = [];\n  var changedKeys = [];\n  var targetKeys = util_1.keys(target);\n  var duration = cfg.duration;\n  var delay = cfg.delay;\n  var additive = cfg.additive;\n  var setToFinal = cfg.setToFinal;\n  var animateAll = !util_1.isObject(animationProps);\n\n  for (var k = 0; k < targetKeys.length; k++) {\n    var innerKey = targetKeys[k];\n\n    if (source[innerKey] != null && target[innerKey] != null && (animateAll || animationProps[innerKey])) {\n      if (util_1.isObject(target[innerKey]) && !util_1.isArrayLike(target[innerKey])) {\n        if (topKey) {\n          if (!reverse) {\n            source[innerKey] = target[innerKey];\n            animatable.updateDuringAnimation(topKey);\n          }\n\n          continue;\n        }\n\n        animateToShallow(animatable, innerKey, source[innerKey], target[innerKey], cfg, animationProps && animationProps[innerKey], animators, reverse);\n      } else {\n        animatableKeys.push(innerKey);\n        changedKeys.push(innerKey);\n      }\n    } else if (!reverse) {\n      source[innerKey] = target[innerKey];\n      animatable.updateDuringAnimation(topKey);\n      changedKeys.push(innerKey);\n    }\n  }\n\n  var keyLen = animatableKeys.length;\n\n  if (keyLen > 0 || cfg.force && !animators.length) {\n    var existsAnimators = animatable.animators;\n    var existsAnimatorsOnSameTarget = [];\n\n    for (var i = 0; i < existsAnimators.length; i++) {\n      if (existsAnimators[i].targetName === topKey) {\n        existsAnimatorsOnSameTarget.push(existsAnimators[i]);\n      }\n    }\n\n    if (!additive && existsAnimatorsOnSameTarget.length) {\n      for (var i = 0; i < existsAnimatorsOnSameTarget.length; i++) {\n        var allAborted = existsAnimatorsOnSameTarget[i].stopTracks(changedKeys);\n\n        if (allAborted) {\n          var idx = util_1.indexOf(existsAnimators, existsAnimatorsOnSameTarget[i]);\n          existsAnimators.splice(idx, 1);\n        }\n      }\n    }\n\n    var revertedSource = void 0;\n    var reversedTarget = void 0;\n    var sourceClone = void 0;\n\n    if (reverse) {\n      reversedTarget = {};\n\n      if (setToFinal) {\n        revertedSource = {};\n      }\n\n      for (var i = 0; i < keyLen; i++) {\n        var innerKey = animatableKeys[i];\n        reversedTarget[innerKey] = source[innerKey];\n\n        if (setToFinal) {\n          revertedSource[innerKey] = target[innerKey];\n        } else {\n          source[innerKey] = target[innerKey];\n        }\n      }\n    } else if (setToFinal) {\n      sourceClone = {};\n\n      for (var i = 0; i < keyLen; i++) {\n        var innerKey = animatableKeys[i];\n        sourceClone[innerKey] = Animator_1.cloneValue(source[innerKey]);\n        copyValue(source, target, innerKey);\n      }\n    }\n\n    var animator = new Animator_1[\"default\"](source, false, additive ? existsAnimatorsOnSameTarget : null);\n    animator.targetName = topKey;\n\n    if (cfg.scope) {\n      animator.scope = cfg.scope;\n    }\n\n    if (setToFinal && revertedSource) {\n      animator.whenWithKeys(0, revertedSource, animatableKeys);\n    }\n\n    if (sourceClone) {\n      animator.whenWithKeys(0, sourceClone, animatableKeys);\n    }\n\n    animator.whenWithKeys(duration == null ? 500 : duration, reverse ? reversedTarget : target, animatableKeys).delay(delay || 0);\n    animatable.addAnimator(animator, topKey);\n    animators.push(animator);\n  }\n}\n\nexports[\"default\"] = Element;","map":{"version":3,"sources":["/Users/wanglijie/wanglijie/clover-defi-wallet/node_modules/zrender/lib/Element.js"],"names":["exports","__esModule","Transformable_1","require","Animator_1","BoundingRect_1","Eventful_1","text_1","util_1","config_1","color_1","env_1","PRESERVED_NORMAL_STATE","PRIMARY_STATES_KEYS","DEFAULT_ANIMATABLE_MAP","x","y","scaleX","scaleY","originX","originY","rotation","ignore","tmpTextPosCalcRes","tmpBoundingRect","Element","props","id","guid","animators","currentStates","states","_init","prototype","attr","drift","dx","dy","e","draggable","m","transform","decomposeTransform","markRedraw","beforeUpdate","afterUpdate","update","updateTransform","__dirty","updateInnerText","forceUpdate","textEl","_textContent","textConfig","isLocal","local","attachedTransform","textAlign","textVerticalAlign","textStyleChanged","parent","innerOrigin","position","layoutRect","copy","getBoundingRect","applyTransform","calculateTextPosition","align","verticalAlign","textOrigin","origin","relOriginX","relOriginY","width","height","parsePercent","textOffset","offset","isInside","inside","indexOf","innerTextDefaultStyle","_innerTextDefaultStyle","textFill","textStroke","autoStroke","canBeInsideText","insideFill","insideStroke","getInsideTextFill","getInsideTextStroke","outsideFill","outsideStroke","getOutsideFill","getOutsideStroke","fill","stroke","setDefaultTextStyle","dirtyStyle","__zr","isDarkMode","LIGHT_LABEL_COLOR","DARK_LABEL_COLOR","backgroundColor","getBackgroundColor","colorArr","parse","alpha","isDark","i","stringify","traverse","cb","context","attrKV","key","value","setTextConfig","setTextContent","setClipPath","extra","extend","hide","show","keyOrObj","isObject","obj","keysArr","keys","length","saveCurrentToNormalState","toState","_innerSaveToNormal","normalState","_normalState","animator","fromStateTransition","__fromStateTransition","targetName","target","saveFinalToTarget","_savePrimaryToNormal","primaryKeys","hasState","getState","name","ensureState","clearStates","noAnimation","useState","stateName","keepCurrentStates","toNormalState","hasStates","animationCfg","stateTransition","state","stateProxy","logError","useHoverLayer","hoverLayer","_toggleHoverLayerFlag","_applyStateObj","__inHover","duration","_textGuide","push","_updateAnimationTargets","REDARAW_BIT","useStates","stateObjects","len","notChange","stateObj","mergedState","_mergeStates","join","slice","changeTarget","removeState","idx","splice","replaceState","oldState","newState","forceAdd","newStateExists","toggleState","enable","mergedTextConfig","transition","needsRestoreToNormal","transitionTarget","hasTransition","propNeedsTransition","__changeFinalValue","_transitionState","_attachComponent","componentEl","__hostTarget","Error","zr","addSelfToZr","_detachComponent","removeSelfFromZr","getClipPath","_clipPath","clipPath","removeClipPath","getTextContent","previousTextContent","removeTextContent","cfg","getTextGuideLine","setTextGuideLine","guideLine","removeTextGuideLine","textGuide","refreshHover","refresh","dirty","inHover","textContent","animation","addAnimator","removeAnimator","animate","loop","el","during","updateDuringAnimation","done","wakeUp","stopAnimation","scope","forwardToLast","leftAnimators","stop","animateTo","animationProps","animateFrom","getPaintRect","initDefaultProps","elProto","type","silent","isGroup","dragging","ignoreClip","logs","logDeprecatedError","xKey","yKey","console","warn","createLegacyProperty","privateKey","Object","defineProperty","get","pos","enhanceArray","set","self","val","browser","ie","version","mixin","animatable","reverse","animateToShallow","finishCount","doneHappened","cfgDone","cfgAborted","aborted","doneCb","abortedCb","percent","start","easing","force","copyArrShallow","source","is2DArray","isArrayLike","copyValue","isTypedArray","constructor","sourceArr","targetArr","len0","len1","Array","call","topKey","animatableKeys","changedKeys","targetKeys","delay","additive","setToFinal","animateAll","k","innerKey","keyLen","existsAnimators","existsAnimatorsOnSameTarget","allAborted","stopTracks","revertedSource","reversedTarget","sourceClone","cloneValue","whenWithKeys"],"mappings":"AAAA;;AACAA,OAAO,CAACC,UAAR,GAAqB,IAArB;;AACA,IAAIC,eAAe,GAAGC,OAAO,CAAC,sBAAD,CAA7B;;AACA,IAAIC,UAAU,GAAGD,OAAO,CAAC,sBAAD,CAAxB;;AACA,IAAIE,cAAc,GAAGF,OAAO,CAAC,qBAAD,CAA5B;;AACA,IAAIG,UAAU,GAAGH,OAAO,CAAC,iBAAD,CAAxB;;AACA,IAAII,MAAM,GAAGJ,OAAO,CAAC,gBAAD,CAApB;;AACA,IAAIK,MAAM,GAAGL,OAAO,CAAC,aAAD,CAApB;;AACA,IAAIM,QAAQ,GAAGN,OAAO,CAAC,UAAD,CAAtB;;AACA,IAAIO,OAAO,GAAGP,OAAO,CAAC,cAAD,CAArB;;AACA,IAAIQ,KAAK,GAAGR,OAAO,CAAC,YAAD,CAAnB;;AACAH,OAAO,CAACY,sBAAR,GAAiC,eAAjC;AACA,IAAIC,mBAAmB,GAAG,CAAC,GAAD,EAAM,GAAN,EAAW,QAAX,EAAqB,QAArB,EAA+B,SAA/B,EAA0C,SAA1C,EAAqD,UAArD,EAAiE,QAAjE,CAA1B;AACA,IAAIC,sBAAsB,GAAG;AACzBC,EAAAA,CAAC,EAAE,IADsB;AAEzBC,EAAAA,CAAC,EAAE,IAFsB;AAGzBC,EAAAA,MAAM,EAAE,IAHiB;AAIzBC,EAAAA,MAAM,EAAE,IAJiB;AAKzBC,EAAAA,OAAO,EAAE,IALgB;AAMzBC,EAAAA,OAAO,EAAE,IANgB;AAOzBC,EAAAA,QAAQ,EAAE,IAPe;AAQzBC,EAAAA,MAAM,EAAE;AARiB,CAA7B;AAUA,IAAIC,iBAAiB,GAAG,EAAxB;AACA,IAAIC,eAAe,GAAG,IAAInB,cAAc,CAAC,SAAD,CAAlB,CAA8B,CAA9B,EAAiC,CAAjC,EAAoC,CAApC,EAAuC,CAAvC,CAAtB;;AACA,IAAIoB,OAAO,GAAI,YAAY;AACvB,WAASA,OAAT,CAAiBC,KAAjB,EAAwB;AACpB,SAAKC,EAAL,GAAUnB,MAAM,CAACoB,IAAP,EAAV;AACA,SAAKC,SAAL,GAAiB,EAAjB;AACA,SAAKC,aAAL,GAAqB,EAArB;AACA,SAAKC,MAAL,GAAc,EAAd;;AACA,SAAKC,KAAL,CAAWN,KAAX;AACH;;AACDD,EAAAA,OAAO,CAACQ,SAAR,CAAkBD,KAAlB,GAA0B,UAAUN,KAAV,EAAiB;AACvC,SAAKQ,IAAL,CAAUR,KAAV;AACH,GAFD;;AAGAD,EAAAA,OAAO,CAACQ,SAAR,CAAkBE,KAAlB,GAA0B,UAAUC,EAAV,EAAcC,EAAd,EAAkBC,CAAlB,EAAqB;AAC3C,YAAQ,KAAKC,SAAb;AACI,WAAK,YAAL;AACIF,QAAAA,EAAE,GAAG,CAAL;AACA;;AACJ,WAAK,UAAL;AACID,QAAAA,EAAE,GAAG,CAAL;AACA;AANR;;AAQA,QAAII,CAAC,GAAG,KAAKC,SAAb;;AACA,QAAI,CAACD,CAAL,EAAQ;AACJA,MAAAA,CAAC,GAAG,KAAKC,SAAL,GAAiB,CAAC,CAAD,EAAI,CAAJ,EAAO,CAAP,EAAU,CAAV,EAAa,CAAb,EAAgB,CAAhB,CAArB;AACH;;AACDD,IAAAA,CAAC,CAAC,CAAD,CAAD,IAAQJ,EAAR;AACAI,IAAAA,CAAC,CAAC,CAAD,CAAD,IAAQH,EAAR;AACA,SAAKK,kBAAL;AACA,SAAKC,UAAL;AACH,GAjBD;;AAkBAlB,EAAAA,OAAO,CAACQ,SAAR,CAAkBW,YAAlB,GAAiC,YAAY,CAAG,CAAhD;;AACAnB,EAAAA,OAAO,CAACQ,SAAR,CAAkBY,WAAlB,GAAgC,YAAY,CAAG,CAA/C;;AACApB,EAAAA,OAAO,CAACQ,SAAR,CAAkBa,MAAlB,GAA2B,YAAY;AACnC,SAAKC,eAAL;;AACA,QAAI,KAAKC,OAAT,EAAkB;AACd,WAAKC,eAAL;AACH;AACJ,GALD;;AAMAxB,EAAAA,OAAO,CAACQ,SAAR,CAAkBgB,eAAlB,GAAoC,UAAUC,WAAV,EAAuB;AACvD,QAAIC,MAAM,GAAG,KAAKC,YAAlB;;AACA,QAAID,MAAM,KAAK,CAACA,MAAM,CAAC7B,MAAR,IAAkB4B,WAAvB,CAAV,EAA+C;AAC3C,UAAI,CAAC,KAAKG,UAAV,EAAsB;AAClB,aAAKA,UAAL,GAAkB,EAAlB;AACH;;AACD,UAAIA,UAAU,GAAG,KAAKA,UAAtB;AACA,UAAIC,OAAO,GAAGD,UAAU,CAACE,KAAzB;AACA,UAAIC,iBAAiB,GAAGL,MAAM,CAACK,iBAA/B;AACA,UAAIC,SAAS,GAAG,KAAK,CAArB;AACA,UAAIC,iBAAiB,GAAG,KAAK,CAA7B;AACA,UAAIC,gBAAgB,GAAG,KAAvB;;AACA,UAAIL,OAAJ,EAAa;AACTE,QAAAA,iBAAiB,CAACI,MAAlB,GAA2B,IAA3B;AACH,OAFD,MAGK;AACDJ,QAAAA,iBAAiB,CAACI,MAAlB,GAA2B,IAA3B;AACH;;AACD,UAAIC,WAAW,GAAG,KAAlB;AACAL,MAAAA,iBAAiB,CAACzC,CAAlB,GAAsBoC,MAAM,CAACpC,CAA7B;AACAyC,MAAAA,iBAAiB,CAACxC,CAAlB,GAAsBmC,MAAM,CAACnC,CAA7B;AACAwC,MAAAA,iBAAiB,CAACrC,OAAlB,GAA4BgC,MAAM,CAAChC,OAAnC;AACAqC,MAAAA,iBAAiB,CAACpC,OAAlB,GAA4B+B,MAAM,CAAC/B,OAAnC;AACAoC,MAAAA,iBAAiB,CAACnC,QAAlB,GAA6B8B,MAAM,CAAC9B,QAApC;AACAmC,MAAAA,iBAAiB,CAACvC,MAAlB,GAA2BkC,MAAM,CAAClC,MAAlC;AACAuC,MAAAA,iBAAiB,CAACtC,MAAlB,GAA2BiC,MAAM,CAACjC,MAAlC;;AACA,UAAImC,UAAU,CAACS,QAAX,IAAuB,IAA3B,EAAiC;AAC7B,YAAIC,UAAU,GAAGvC,eAAjB;;AACA,YAAI6B,UAAU,CAACU,UAAf,EAA2B;AACvBA,UAAAA,UAAU,CAACC,IAAX,CAAgBX,UAAU,CAACU,UAA3B;AACH,SAFD,MAGK;AACDA,UAAAA,UAAU,CAACC,IAAX,CAAgB,KAAKC,eAAL,EAAhB;AACH;;AACD,YAAI,CAACX,OAAL,EAAc;AACVS,UAAAA,UAAU,CAACG,cAAX,CAA0B,KAAKzB,SAA/B;AACH;;AACD,YAAI,KAAK0B,qBAAT,EAAgC;AAC5B,eAAKA,qBAAL,CAA2B5C,iBAA3B,EAA8C8B,UAA9C,EAA0DU,UAA1D;AACH,SAFD,MAGK;AACDxD,UAAAA,MAAM,CAAC4D,qBAAP,CAA6B5C,iBAA7B,EAAgD8B,UAAhD,EAA4DU,UAA5D;AACH;;AACDP,QAAAA,iBAAiB,CAACzC,CAAlB,GAAsBQ,iBAAiB,CAACR,CAAxC;AACAyC,QAAAA,iBAAiB,CAACxC,CAAlB,GAAsBO,iBAAiB,CAACP,CAAxC;AACAyC,QAAAA,SAAS,GAAGlC,iBAAiB,CAAC6C,KAA9B;AACAV,QAAAA,iBAAiB,GAAGnC,iBAAiB,CAAC8C,aAAtC;AACA,YAAIC,UAAU,GAAGjB,UAAU,CAACkB,MAA5B;;AACA,YAAID,UAAU,IAAIjB,UAAU,CAAChC,QAAX,IAAuB,IAAzC,EAA+C;AAC3C,cAAImD,UAAU,GAAG,KAAK,CAAtB;AACA,cAAIC,UAAU,GAAG,KAAK,CAAtB;;AACA,cAAIH,UAAU,KAAK,QAAnB,EAA6B;AACzBE,YAAAA,UAAU,GAAGT,UAAU,CAACW,KAAX,GAAmB,GAAhC;AACAD,YAAAA,UAAU,GAAGV,UAAU,CAACY,MAAX,GAAoB,GAAjC;AACH,WAHD,MAIK;AACDH,YAAAA,UAAU,GAAGjE,MAAM,CAACqE,YAAP,CAAoBN,UAAU,CAAC,CAAD,CAA9B,EAAmCP,UAAU,CAACW,KAA9C,CAAb;AACAD,YAAAA,UAAU,GAAGlE,MAAM,CAACqE,YAAP,CAAoBN,UAAU,CAAC,CAAD,CAA9B,EAAmCP,UAAU,CAACY,MAA9C,CAAb;AACH;;AACDd,UAAAA,WAAW,GAAG,IAAd;AACAL,UAAAA,iBAAiB,CAACrC,OAAlB,GAA4B,CAACqC,iBAAiB,CAACzC,CAAnB,GAAuByD,UAAvB,IAAqClB,OAAO,GAAG,CAAH,GAAOS,UAAU,CAAChD,CAA9D,CAA5B;AACAyC,UAAAA,iBAAiB,CAACpC,OAAlB,GAA4B,CAACoC,iBAAiB,CAACxC,CAAnB,GAAuByD,UAAvB,IAAqCnB,OAAO,GAAG,CAAH,GAAOS,UAAU,CAAC/C,CAA9D,CAA5B;AACH;AACJ;;AACD,UAAIqC,UAAU,CAAChC,QAAX,IAAuB,IAA3B,EAAiC;AAC7BmC,QAAAA,iBAAiB,CAACnC,QAAlB,GAA6BgC,UAAU,CAAChC,QAAxC;AACH;;AACD,UAAIwD,UAAU,GAAGxB,UAAU,CAACyB,MAA5B;;AACA,UAAID,UAAJ,EAAgB;AACZrB,QAAAA,iBAAiB,CAACzC,CAAlB,IAAuB8D,UAAU,CAAC,CAAD,CAAjC;AACArB,QAAAA,iBAAiB,CAACxC,CAAlB,IAAuB6D,UAAU,CAAC,CAAD,CAAjC;;AACA,YAAI,CAAChB,WAAL,EAAkB;AACdL,UAAAA,iBAAiB,CAACrC,OAAlB,GAA4B,CAAC0D,UAAU,CAAC,CAAD,CAAvC;AACArB,UAAAA,iBAAiB,CAACpC,OAAlB,GAA4B,CAACyD,UAAU,CAAC,CAAD,CAAvC;AACH;AACJ;;AACD,UAAIE,QAAQ,GAAG1B,UAAU,CAAC2B,MAAX,IAAqB,IAArB,GACR,OAAO3B,UAAU,CAACS,QAAlB,KAA+B,QAA/B,IAA2CT,UAAU,CAACS,QAAX,CAAoBmB,OAApB,CAA4B,QAA5B,KAAyC,CAD5E,GAET5B,UAAU,CAAC2B,MAFjB;AAGA,UAAIE,qBAAqB,GAAG,KAAKC,sBAAL,KAAgC,KAAKA,sBAAL,GAA8B,EAA9D,CAA5B;AACA,UAAIC,QAAQ,GAAG,KAAK,CAApB;AACA,UAAIC,UAAU,GAAG,KAAK,CAAtB;AACA,UAAIC,UAAU,GAAG,KAAK,CAAtB;;AACA,UAAIP,QAAQ,IAAI,KAAKQ,eAAL,EAAhB,EAAwC;AACpCH,QAAAA,QAAQ,GAAG/B,UAAU,CAACmC,UAAtB;AACAH,QAAAA,UAAU,GAAGhC,UAAU,CAACoC,YAAxB;;AACA,YAAIL,QAAQ,IAAI,IAAZ,IAAoBA,QAAQ,KAAK,MAArC,EAA6C;AACzCA,UAAAA,QAAQ,GAAG,KAAKM,iBAAL,EAAX;AACH;;AACD,YAAIL,UAAU,IAAI,IAAd,IAAsBA,UAAU,KAAK,MAAzC,EAAiD;AAC7CA,UAAAA,UAAU,GAAG,KAAKM,mBAAL,CAAyBP,QAAzB,CAAb;AACAE,UAAAA,UAAU,GAAG,IAAb;AACH;AACJ,OAVD,MAWK;AACDF,QAAAA,QAAQ,GAAG/B,UAAU,CAACuC,WAAtB;AACAP,QAAAA,UAAU,GAAGhC,UAAU,CAACwC,aAAxB;;AACA,YAAIT,QAAQ,IAAI,IAAZ,IAAoBA,QAAQ,KAAK,MAArC,EAA6C;AACzCA,UAAAA,QAAQ,GAAG,KAAKU,cAAL,EAAX;AACH;;AACD,YAAIT,UAAU,IAAI,IAAd,IAAsBA,UAAU,KAAK,MAAzC,EAAiD;AAC7CA,UAAAA,UAAU,GAAG,KAAKU,gBAAL,CAAsBX,QAAtB,CAAb;AACAE,UAAAA,UAAU,GAAG,IAAb;AACH;AACJ;;AACDF,MAAAA,QAAQ,GAAGA,QAAQ,IAAI,MAAvB;;AACA,UAAIA,QAAQ,KAAKF,qBAAqB,CAACc,IAAnC,IACGX,UAAU,KAAKH,qBAAqB,CAACe,MADxC,IAEGX,UAAU,KAAKJ,qBAAqB,CAACI,UAFxC,IAGG7B,SAAS,KAAKyB,qBAAqB,CAACd,KAHvC,IAIGV,iBAAiB,KAAKwB,qBAAqB,CAACb,aAJnD,EAIkE;AAC9DV,QAAAA,gBAAgB,GAAG,IAAnB;AACAuB,QAAAA,qBAAqB,CAACc,IAAtB,GAA6BZ,QAA7B;AACAF,QAAAA,qBAAqB,CAACe,MAAtB,GAA+BZ,UAA/B;AACAH,QAAAA,qBAAqB,CAACI,UAAtB,GAAmCA,UAAnC;AACAJ,QAAAA,qBAAqB,CAACd,KAAtB,GAA8BX,SAA9B;AACAyB,QAAAA,qBAAqB,CAACb,aAAtB,GAAsCX,iBAAtC;AACAP,QAAAA,MAAM,CAAC+C,mBAAP,CAA2BhB,qBAA3B;AACH;;AACD,UAAIvB,gBAAJ,EAAsB;AAClBR,QAAAA,MAAM,CAACgD,UAAP;AACH;;AACDhD,MAAAA,MAAM,CAACR,UAAP;AACH;AACJ,GA5HD;;AA6HAlB,EAAAA,OAAO,CAACQ,SAAR,CAAkBsD,eAAlB,GAAoC,YAAY;AAC5C,WAAO,IAAP;AACH,GAFD;;AAGA9D,EAAAA,OAAO,CAACQ,SAAR,CAAkByD,iBAAlB,GAAsC,YAAY;AAC9C,WAAO,MAAP;AACH,GAFD;;AAGAjE,EAAAA,OAAO,CAACQ,SAAR,CAAkB0D,mBAAlB,GAAwC,UAAUP,QAAV,EAAoB;AACxD,WAAO,MAAP;AACH,GAFD;;AAGA3D,EAAAA,OAAO,CAACQ,SAAR,CAAkB6D,cAAlB,GAAmC,YAAY;AAC3C,WAAO,KAAKM,IAAL,IAAa,KAAKA,IAAL,CAAUC,UAAV,EAAb,GAAsC5F,QAAQ,CAAC6F,iBAA/C,GAAmE7F,QAAQ,CAAC8F,gBAAnF;AACH,GAFD;;AAGA9E,EAAAA,OAAO,CAACQ,SAAR,CAAkB8D,gBAAlB,GAAqC,UAAUX,QAAV,EAAoB;AACrD,QAAIoB,eAAe,GAAG,KAAKJ,IAAL,IAAa,KAAKA,IAAL,CAAUK,kBAAV,EAAnC;;AACA,QAAIC,QAAQ,GAAG,OAAOF,eAAP,KAA2B,QAA3B,IAAuC9F,OAAO,CAACiG,KAAR,CAAcH,eAAd,CAAtD;;AACA,QAAI,CAACE,QAAL,EAAe;AACXA,MAAAA,QAAQ,GAAG,CAAC,GAAD,EAAM,GAAN,EAAW,GAAX,EAAgB,CAAhB,CAAX;AACH;;AACD,QAAIE,KAAK,GAAGF,QAAQ,CAAC,CAAD,CAApB;;AACA,QAAIG,MAAM,GAAG,KAAKT,IAAL,CAAUC,UAAV,EAAb;;AACA,SAAK,IAAIS,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG,CAApB,EAAuBA,CAAC,EAAxB,EAA4B;AACxBJ,MAAAA,QAAQ,CAACI,CAAD,CAAR,GAAcJ,QAAQ,CAACI,CAAD,CAAR,GAAcF,KAAd,GAAsB,CAACC,MAAM,GAAG,CAAH,GAAO,GAAd,KAAsB,IAAID,KAA1B,CAApC;AACH;;AACDF,IAAAA,QAAQ,CAAC,CAAD,CAAR,GAAc,CAAd;AACA,WAAOhG,OAAO,CAACqG,SAAR,CAAkBL,QAAlB,EAA4B,MAA5B,CAAP;AACH,GAbD;;AAcAjF,EAAAA,OAAO,CAACQ,SAAR,CAAkB+E,QAAlB,GAA6B,UAAUC,EAAV,EAAcC,OAAd,EAAuB,CAAG,CAAvD;;AACAzF,EAAAA,OAAO,CAACQ,SAAR,CAAkBkF,MAAlB,GAA2B,UAAUC,GAAV,EAAeC,KAAf,EAAsB;AAC7C,QAAID,GAAG,KAAK,YAAZ,EAA0B;AACtB,WAAKE,aAAL,CAAmBD,KAAnB;AACH,KAFD,MAGK,IAAID,GAAG,KAAK,aAAZ,EAA2B;AAC5B,WAAKG,cAAL,CAAoBF,KAApB;AACH,KAFI,MAGA,IAAID,GAAG,KAAK,UAAZ,EAAwB;AACzB,WAAKI,WAAL,CAAiBH,KAAjB;AACH,KAFI,MAGA,IAAID,GAAG,KAAK,OAAZ,EAAqB;AACtB,WAAKK,KAAL,GAAa,KAAKA,KAAL,IAAc,EAA3B;AACAjH,MAAAA,MAAM,CAACkH,MAAP,CAAc,KAAKD,KAAnB,EAA0BJ,KAA1B;AACH,KAHI,MAIA;AACD,WAAKD,GAAL,IAAYC,KAAZ;AACH;AACJ,GAjBD;;AAkBA5F,EAAAA,OAAO,CAACQ,SAAR,CAAkB0F,IAAlB,GAAyB,YAAY;AACjC,SAAKrG,MAAL,GAAc,IAAd;AACA,SAAKqB,UAAL;AACH,GAHD;;AAIAlB,EAAAA,OAAO,CAACQ,SAAR,CAAkB2F,IAAlB,GAAyB,YAAY;AACjC,SAAKtG,MAAL,GAAc,KAAd;AACA,SAAKqB,UAAL;AACH,GAHD;;AAIAlB,EAAAA,OAAO,CAACQ,SAAR,CAAkBC,IAAlB,GAAyB,UAAU2F,QAAV,EAAoBR,KAApB,EAA2B;AAChD,QAAI,OAAOQ,QAAP,KAAoB,QAAxB,EAAkC;AAC9B,WAAKV,MAAL,CAAYU,QAAZ,EAAsBR,KAAtB;AACH,KAFD,MAGK,IAAI7G,MAAM,CAACsH,QAAP,CAAgBD,QAAhB,CAAJ,EAA+B;AAChC,UAAIE,GAAG,GAAGF,QAAV;AACA,UAAIG,OAAO,GAAGxH,MAAM,CAACyH,IAAP,CAAYF,GAAZ,CAAd;;AACA,WAAK,IAAIjB,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGkB,OAAO,CAACE,MAA5B,EAAoCpB,CAAC,EAArC,EAAyC;AACrC,YAAIM,GAAG,GAAGY,OAAO,CAAClB,CAAD,CAAjB;AACA,aAAKK,MAAL,CAAYC,GAAZ,EAAiBS,QAAQ,CAACT,GAAD,CAAzB;AACH;AACJ;;AACD,SAAKzE,UAAL;AACA,WAAO,IAAP;AACH,GAdD;;AAeAlB,EAAAA,OAAO,CAACQ,SAAR,CAAkBkG,wBAAlB,GAA6C,UAAUC,OAAV,EAAmB;AAC5D,SAAKC,kBAAL,CAAwBD,OAAxB;;AACA,QAAIE,WAAW,GAAG,KAAKC,YAAvB;;AACA,SAAK,IAAIzB,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG,KAAKjF,SAAL,CAAeqG,MAAnC,EAA2CpB,CAAC,EAA5C,EAAgD;AAC5C,UAAI0B,QAAQ,GAAG,KAAK3G,SAAL,CAAeiF,CAAf,CAAf;AACA,UAAI2B,mBAAmB,GAAGD,QAAQ,CAACE,qBAAnC;;AACA,UAAID,mBAAmB,IAAIA,mBAAmB,KAAKzI,OAAO,CAACY,sBAA3D,EAAmF;AAC/E;AACH;;AACD,UAAI+H,UAAU,GAAGH,QAAQ,CAACG,UAA1B;AACA,UAAIC,MAAM,GAAGD,UAAU,GACjBL,WAAW,CAACK,UAAD,CADM,GACSL,WADhC;AAEAE,MAAAA,QAAQ,CAACK,iBAAT,CAA2BD,MAA3B;AACH;AACJ,GAdD;;AAeAnH,EAAAA,OAAO,CAACQ,SAAR,CAAkBoG,kBAAlB,GAAuC,UAAUD,OAAV,EAAmB;AACtD,QAAIE,WAAW,GAAG,KAAKC,YAAvB;;AACA,QAAI,CAACD,WAAL,EAAkB;AACdA,MAAAA,WAAW,GAAG,KAAKC,YAAL,GAAoB,EAAlC;AACH;;AACD,QAAIH,OAAO,CAAC/E,UAAR,IAAsB,CAACiF,WAAW,CAACjF,UAAvC,EAAmD;AAC/CiF,MAAAA,WAAW,CAACjF,UAAZ,GAAyB,KAAKA,UAA9B;AACH;;AACD,SAAKyF,oBAAL,CAA0BV,OAA1B,EAAmCE,WAAnC,EAAgDzH,mBAAhD;AACH,GATD;;AAUAY,EAAAA,OAAO,CAACQ,SAAR,CAAkB6G,oBAAlB,GAAyC,UAAUV,OAAV,EAAmBE,WAAnB,EAAgCS,WAAhC,EAA6C;AAClF,SAAK,IAAIjC,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGiC,WAAW,CAACb,MAAhC,EAAwCpB,CAAC,EAAzC,EAA6C;AACzC,UAAIM,GAAG,GAAG2B,WAAW,CAACjC,CAAD,CAArB;;AACA,UAAIsB,OAAO,CAAChB,GAAD,CAAP,IAAgB,IAAhB,IAAwB,EAAEA,GAAG,IAAIkB,WAAT,CAA5B,EAAmD;AAC/CA,QAAAA,WAAW,CAAClB,GAAD,CAAX,GAAmB,KAAKA,GAAL,CAAnB;AACH;AACJ;AACJ,GAPD;;AAQA3F,EAAAA,OAAO,CAACQ,SAAR,CAAkB+G,QAAlB,GAA6B,YAAY;AACrC,WAAO,KAAKlH,aAAL,CAAmBoG,MAAnB,GAA4B,CAAnC;AACH,GAFD;;AAGAzG,EAAAA,OAAO,CAACQ,SAAR,CAAkBgH,QAAlB,GAA6B,UAAUC,IAAV,EAAgB;AACzC,WAAO,KAAKnH,MAAL,CAAYmH,IAAZ,CAAP;AACH,GAFD;;AAGAzH,EAAAA,OAAO,CAACQ,SAAR,CAAkBkH,WAAlB,GAAgC,UAAUD,IAAV,EAAgB;AAC5C,QAAInH,MAAM,GAAG,KAAKA,MAAlB;;AACA,QAAI,CAACA,MAAM,CAACmH,IAAD,CAAX,EAAmB;AACfnH,MAAAA,MAAM,CAACmH,IAAD,CAAN,GAAe,EAAf;AACH;;AACD,WAAOnH,MAAM,CAACmH,IAAD,CAAb;AACH,GAND;;AAOAzH,EAAAA,OAAO,CAACQ,SAAR,CAAkBmH,WAAlB,GAAgC,UAAUC,WAAV,EAAuB;AACnD,SAAKC,QAAL,CAActJ,OAAO,CAACY,sBAAtB,EAA8C,KAA9C,EAAqDyI,WAArD;AACH,GAFD;;AAGA5H,EAAAA,OAAO,CAACQ,SAAR,CAAkBqH,QAAlB,GAA6B,UAAUC,SAAV,EAAqBC,iBAArB,EAAwCH,WAAxC,EAAqD;AAC9E,QAAII,aAAa,GAAGF,SAAS,KAAKvJ,OAAO,CAACY,sBAA1C;AACA,QAAI8I,SAAS,GAAG,KAAKV,QAAL,EAAhB;;AACA,QAAI,CAACU,SAAD,IAAcD,aAAlB,EAAiC;AAC7B;AACH;;AACD,QAAI3H,aAAa,GAAG,KAAKA,aAAzB;AACA,QAAI6H,YAAY,GAAG,KAAKC,eAAxB;;AACA,QAAIpJ,MAAM,CAACyE,OAAP,CAAenD,aAAf,EAA8ByH,SAA9B,KAA4C,CAA5C,KAAkDC,iBAAiB,IAAI1H,aAAa,CAACoG,MAAd,KAAyB,CAAhG,CAAJ,EAAwG;AACpG;AACH;;AACD,QAAI2B,KAAJ;;AACA,QAAI,KAAKC,UAAL,IAAmB,CAACL,aAAxB,EAAuC;AACnCI,MAAAA,KAAK,GAAG,KAAKC,UAAL,CAAgBP,SAAhB,CAAR;AACH;;AACD,QAAI,CAACM,KAAL,EAAY;AACRA,MAAAA,KAAK,GAAI,KAAK9H,MAAL,IAAe,KAAKA,MAAL,CAAYwH,SAAZ,CAAxB;AACH;;AACD,QAAI,CAACM,KAAD,IAAU,CAACJ,aAAf,EAA8B;AAC1BjJ,MAAAA,MAAM,CAACuJ,QAAP,CAAgB,WAAWR,SAAX,GAAuB,cAAvC;AACA;AACH;;AACD,QAAI,CAACE,aAAL,EAAoB;AAChB,WAAKtB,wBAAL,CAA8B0B,KAA9B;AACH;;AACD,QAAIG,aAAa,GAAG,CAAC,EAAEH,KAAK,IAAIA,KAAK,CAACI,UAAjB,CAArB;;AACA,QAAID,aAAJ,EAAmB;AACf,WAAKE,qBAAL,CAA2B,IAA3B;AACH;;AACD,SAAKC,cAAL,CAAoBZ,SAApB,EAA+BM,KAA/B,EAAsC,KAAKtB,YAA3C,EAAyDiB,iBAAzD,EAA4E,CAACH,WAAD,IAAgB,CAAC,KAAKe,SAAtB,IAAmCT,YAAnC,IAAmDA,YAAY,CAACU,QAAb,GAAwB,CAAvJ,EAA0JV,YAA1J;;AACA,QAAI,KAAKvG,YAAT,EAAuB;AACnB,WAAKA,YAAL,CAAkBkG,QAAlB,CAA2BC,SAA3B,EAAsCC,iBAAtC;AACH;;AACD,QAAI,KAAKc,UAAT,EAAqB;AACjB,WAAKA,UAAL,CAAgBhB,QAAhB,CAAyBC,SAAzB,EAAoCC,iBAApC;AACH;;AACD,QAAIC,aAAJ,EAAmB;AACf,WAAK3H,aAAL,GAAqB,EAArB;AACA,WAAKyG,YAAL,GAAoB,EAApB;AACH,KAHD,MAIK;AACD,UAAI,CAACiB,iBAAL,EAAwB;AACpB,aAAK1H,aAAL,GAAqB,CAACyH,SAAD,CAArB;AACH,OAFD,MAGK;AACD,aAAKzH,aAAL,CAAmByI,IAAnB,CAAwBhB,SAAxB;AACH;AACJ;;AACD,SAAKiB,uBAAL;;AACA,SAAK7H,UAAL;;AACA,QAAI,CAACqH,aAAD,IAAkB,KAAKI,SAA3B,EAAsC;AAClC,WAAKF,qBAAL,CAA2B,KAA3B;;AACA,WAAKlH,OAAL,IAAgB,CAACvB,OAAO,CAACgJ,WAAzB;AACH;;AACD,WAAOZ,KAAP;AACH,GAvDD;;AAwDApI,EAAAA,OAAO,CAACQ,SAAR,CAAkByI,SAAlB,GAA8B,UAAU3I,MAAV,EAAkBsH,WAAlB,EAA+B;AACzD,QAAI,CAACtH,MAAM,CAACmG,MAAZ,EAAoB;AAChB,WAAKkB,WAAL;AACH,KAFD,MAGK;AACD,UAAIuB,YAAY,GAAG,EAAnB;AACA,UAAI7I,aAAa,GAAG,KAAKA,aAAzB;AACA,UAAI8I,GAAG,GAAG7I,MAAM,CAACmG,MAAjB;AACA,UAAI2C,SAAS,GAAGD,GAAG,KAAK9I,aAAa,CAACoG,MAAtC;;AACA,UAAI2C,SAAJ,EAAe;AACX,aAAK,IAAI/D,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG8D,GAApB,EAAyB9D,CAAC,EAA1B,EAA8B;AAC1B,cAAI/E,MAAM,CAAC+E,CAAD,CAAN,KAAchF,aAAa,CAACgF,CAAD,CAA/B,EAAoC;AAChC+D,YAAAA,SAAS,GAAG,KAAZ;AACA;AACH;AACJ;AACJ;;AACD,UAAIA,SAAJ,EAAe;AACX;AACH;;AACD,WAAK,IAAI/D,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG8D,GAApB,EAAyB9D,CAAC,EAA1B,EAA8B;AAC1B,YAAIyC,SAAS,GAAGxH,MAAM,CAAC+E,CAAD,CAAtB;AACA,YAAIgE,QAAQ,GAAG,KAAK,CAApB;;AACA,YAAI,KAAKhB,UAAT,EAAqB;AACjBgB,UAAAA,QAAQ,GAAG,KAAKhB,UAAL,CAAgBP,SAAhB,EAA2BxH,MAA3B,CAAX;AACH;;AACD,YAAI,CAAC+I,QAAL,EAAe;AACXA,UAAAA,QAAQ,GAAG,KAAK/I,MAAL,CAAYwH,SAAZ,CAAX;AACH;;AACD,YAAIuB,QAAJ,EAAc;AACVH,UAAAA,YAAY,CAACJ,IAAb,CAAkBO,QAAlB;AACH;AACJ;;AACD,UAAId,aAAa,GAAG,CAAC,EAAEW,YAAY,CAACC,GAAG,GAAG,CAAP,CAAZ,IAAyBD,YAAY,CAACC,GAAG,GAAG,CAAP,CAAZ,CAAsBX,UAAjD,CAArB;;AACA,UAAID,aAAJ,EAAmB;AACf,aAAKE,qBAAL,CAA2B,IAA3B;AACH;;AACD,UAAIa,WAAW,GAAG,KAAKC,YAAL,CAAkBL,YAAlB,CAAlB;;AACA,UAAIhB,YAAY,GAAG,KAAKC,eAAxB;AACA,WAAKzB,wBAAL,CAA8B4C,WAA9B;;AACA,WAAKZ,cAAL,CAAoBpI,MAAM,CAACkJ,IAAP,CAAY,GAAZ,CAApB,EAAsCF,WAAtC,EAAmD,KAAKxC,YAAxD,EAAsE,KAAtE,EAA6E,CAACc,WAAD,IAAgB,CAAC,KAAKe,SAAtB,IAAmCT,YAAnC,IAAmDA,YAAY,CAACU,QAAb,GAAwB,CAAxJ,EAA2JV,YAA3J;;AACA,UAAI,KAAKvG,YAAT,EAAuB;AACnB,aAAKA,YAAL,CAAkBsH,SAAlB,CAA4B3I,MAA5B;AACH;;AACD,UAAI,KAAKuI,UAAT,EAAqB;AACjB,aAAKA,UAAL,CAAgBI,SAAhB,CAA0B3I,MAA1B;AACH;;AACD,WAAKyI,uBAAL;;AACA,WAAK1I,aAAL,GAAqBC,MAAM,CAACmJ,KAAP,EAArB;AACA,WAAKvI,UAAL;;AACA,UAAI,CAACqH,aAAD,IAAkB,KAAKI,SAA3B,EAAsC;AAClC,aAAKF,qBAAL,CAA2B,KAA3B;;AACA,aAAKlH,OAAL,IAAgB,CAACvB,OAAO,CAACgJ,WAAzB;AACH;AACJ;AACJ,GAvDD;;AAwDAhJ,EAAAA,OAAO,CAACQ,SAAR,CAAkBuI,uBAAlB,GAA4C,YAAY;AACpD,SAAK,IAAI1D,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG,KAAKjF,SAAL,CAAeqG,MAAnC,EAA2CpB,CAAC,EAA5C,EAAgD;AAC5C,UAAI0B,QAAQ,GAAG,KAAK3G,SAAL,CAAeiF,CAAf,CAAf;;AACA,UAAI0B,QAAQ,CAACG,UAAb,EAAyB;AACrBH,QAAAA,QAAQ,CAAC2C,YAAT,CAAsB,KAAK3C,QAAQ,CAACG,UAAd,CAAtB;AACH;AACJ;AACJ,GAPD;;AAQAlH,EAAAA,OAAO,CAACQ,SAAR,CAAkBmJ,WAAlB,GAAgC,UAAUvB,KAAV,EAAiB;AAC7C,QAAIwB,GAAG,GAAG7K,MAAM,CAACyE,OAAP,CAAe,KAAKnD,aAApB,EAAmC+H,KAAnC,CAAV;;AACA,QAAIwB,GAAG,IAAI,CAAX,EAAc;AACV,UAAIvJ,aAAa,GAAG,KAAKA,aAAL,CAAmBoJ,KAAnB,EAApB;AACApJ,MAAAA,aAAa,CAACwJ,MAAd,CAAqBD,GAArB,EAA0B,CAA1B;AACA,WAAKX,SAAL,CAAe5I,aAAf;AACH;AACJ,GAPD;;AAQAL,EAAAA,OAAO,CAACQ,SAAR,CAAkBsJ,YAAlB,GAAiC,UAAUC,QAAV,EAAoBC,QAApB,EAA8BC,QAA9B,EAAwC;AACrE,QAAI5J,aAAa,GAAG,KAAKA,aAAL,CAAmBoJ,KAAnB,EAApB;AACA,QAAIG,GAAG,GAAG7K,MAAM,CAACyE,OAAP,CAAenD,aAAf,EAA8B0J,QAA9B,CAAV;AACA,QAAIG,cAAc,GAAGnL,MAAM,CAACyE,OAAP,CAAenD,aAAf,EAA8B2J,QAA9B,KAA2C,CAAhE;;AACA,QAAIJ,GAAG,IAAI,CAAX,EAAc;AACV,UAAI,CAACM,cAAL,EAAqB;AACjB7J,QAAAA,aAAa,CAACuJ,GAAD,CAAb,GAAqBI,QAArB;AACH,OAFD,MAGK;AACD3J,QAAAA,aAAa,CAACwJ,MAAd,CAAqBD,GAArB,EAA0B,CAA1B;AACH;AACJ,KAPD,MAQK,IAAIK,QAAQ,IAAI,CAACC,cAAjB,EAAiC;AAClC7J,MAAAA,aAAa,CAACyI,IAAd,CAAmBkB,QAAnB;AACH;;AACD,SAAKf,SAAL,CAAe5I,aAAf;AACH,GAhBD;;AAiBAL,EAAAA,OAAO,CAACQ,SAAR,CAAkB2J,WAAlB,GAAgC,UAAU/B,KAAV,EAAiBgC,MAAjB,EAAyB;AACrD,QAAIA,MAAJ,EAAY;AACR,WAAKvC,QAAL,CAAcO,KAAd,EAAqB,IAArB;AACH,KAFD,MAGK;AACD,WAAKuB,WAAL,CAAiBvB,KAAjB;AACH;AACJ,GAPD;;AAQApI,EAAAA,OAAO,CAACQ,SAAR,CAAkB+I,YAAlB,GAAiC,UAAUjJ,MAAV,EAAkB;AAC/C,QAAIgJ,WAAW,GAAG,EAAlB;AACA,QAAIe,gBAAJ;;AACA,SAAK,IAAIhF,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG/E,MAAM,CAACmG,MAA3B,EAAmCpB,CAAC,EAApC,EAAwC;AACpC,UAAI+C,KAAK,GAAG9H,MAAM,CAAC+E,CAAD,CAAlB;AACAtG,MAAAA,MAAM,CAACkH,MAAP,CAAcqD,WAAd,EAA2BlB,KAA3B;;AACA,UAAIA,KAAK,CAACxG,UAAV,EAAsB;AAClByI,QAAAA,gBAAgB,GAAGA,gBAAgB,IAAI,EAAvC;AACAtL,QAAAA,MAAM,CAACkH,MAAP,CAAcoE,gBAAd,EAAgCjC,KAAK,CAACxG,UAAtC;AACH;AACJ;;AACD,QAAIyI,gBAAJ,EAAsB;AAClBf,MAAAA,WAAW,CAAC1H,UAAZ,GAAyByI,gBAAzB;AACH;;AACD,WAAOf,WAAP;AACH,GAfD;;AAgBAtJ,EAAAA,OAAO,CAACQ,SAAR,CAAkBkI,cAAlB,GAAmC,UAAUZ,SAAV,EAAqBM,KAArB,EAA4BvB,WAA5B,EAAyCkB,iBAAzC,EAA4DuC,UAA5D,EAAwEpC,YAAxE,EAAsF;AACrH,QAAIqC,oBAAoB,GAAG,EAAEnC,KAAK,IAAIL,iBAAX,CAA3B;;AACA,QAAIK,KAAK,IAAIA,KAAK,CAACxG,UAAnB,EAA+B;AAC3B,WAAKA,UAAL,GAAkB7C,MAAM,CAACkH,MAAP,CAAc,EAAd,EAAkB8B,iBAAiB,GAAG,KAAKnG,UAAR,GAAqBiF,WAAW,CAACjF,UAApE,CAAlB;AACA7C,MAAAA,MAAM,CAACkH,MAAP,CAAc,KAAKrE,UAAnB,EAA+BwG,KAAK,CAACxG,UAArC;AACH,KAHD,MAIK,IAAI2I,oBAAJ,EAA0B;AAC3B,UAAI1D,WAAW,CAACjF,UAAhB,EAA4B;AACxB,aAAKA,UAAL,GAAkBiF,WAAW,CAACjF,UAA9B;AACH;AACJ;;AACD,QAAI4I,gBAAgB,GAAG,EAAvB;AACA,QAAIC,aAAa,GAAG,KAApB;;AACA,SAAK,IAAIpF,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGjG,mBAAmB,CAACqH,MAAxC,EAAgDpB,CAAC,EAAjD,EAAqD;AACjD,UAAIM,GAAG,GAAGvG,mBAAmB,CAACiG,CAAD,CAA7B;AACA,UAAIqF,mBAAmB,GAAGJ,UAAU,IAAIjL,sBAAsB,CAACsG,GAAD,CAA9D;;AACA,UAAIyC,KAAK,IAAIA,KAAK,CAACzC,GAAD,CAAL,IAAc,IAA3B,EAAiC;AAC7B,YAAI+E,mBAAJ,EAAyB;AACrBD,UAAAA,aAAa,GAAG,IAAhB;AACAD,UAAAA,gBAAgB,CAAC7E,GAAD,CAAhB,GAAwByC,KAAK,CAACzC,GAAD,CAA7B;AACH,SAHD,MAIK;AACD,eAAKA,GAAL,IAAYyC,KAAK,CAACzC,GAAD,CAAjB;AACH;AACJ,OARD,MASK,IAAI4E,oBAAJ,EAA0B;AAC3B,YAAI1D,WAAW,CAAClB,GAAD,CAAX,IAAoB,IAAxB,EAA8B;AAC1B,cAAI+E,mBAAJ,EAAyB;AACrBD,YAAAA,aAAa,GAAG,IAAhB;AACAD,YAAAA,gBAAgB,CAAC7E,GAAD,CAAhB,GAAwBkB,WAAW,CAAClB,GAAD,CAAnC;AACH,WAHD,MAIK;AACD,iBAAKA,GAAL,IAAYkB,WAAW,CAAClB,GAAD,CAAvB;AACH;AACJ;AACJ;AACJ;;AACD,QAAI,CAAC2E,UAAL,EAAiB;AACb,WAAK,IAAIjF,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG,KAAKjF,SAAL,CAAeqG,MAAnC,EAA2CpB,CAAC,EAA5C,EAAgD;AAC5C,YAAI0B,QAAQ,GAAG,KAAK3G,SAAL,CAAeiF,CAAf,CAAf;AACA,YAAI6B,UAAU,GAAGH,QAAQ,CAACG,UAA1B;;AACAH,QAAAA,QAAQ,CAAC4D,kBAAT,CAA4BzD,UAAU,GAChC,CAACkB,KAAK,IAAIvB,WAAV,EAAuBK,UAAvB,CADgC,GAE/BkB,KAAK,IAAIvB,WAFhB;AAGH;AACJ;;AACD,QAAI4D,aAAJ,EAAmB;AACf,WAAKG,gBAAL,CAAsB9C,SAAtB,EAAiC0C,gBAAjC,EAAmDtC,YAAnD;AACH;AACJ,GAjDD;;AAkDAlI,EAAAA,OAAO,CAACQ,SAAR,CAAkBqK,gBAAlB,GAAqC,UAAUC,WAAV,EAAuB;AACxD,QAAIA,WAAW,CAACnG,IAAZ,IAAoB,CAACmG,WAAW,CAACC,YAArC,EAAmD;AAC/C,YAAM,IAAIC,KAAJ,CAAU,yCAAV,CAAN;AACH;;AACD,QAAIF,WAAW,KAAK,IAApB,EAA0B;AACtB,YAAM,IAAIE,KAAJ,CAAU,iCAAV,CAAN;AACH;;AACD,QAAIC,EAAE,GAAG,KAAKtG,IAAd;;AACA,QAAIsG,EAAJ,EAAQ;AACJH,MAAAA,WAAW,CAACI,WAAZ,CAAwBD,EAAxB;AACH;;AACDH,IAAAA,WAAW,CAACnG,IAAZ,GAAmBsG,EAAnB;AACAH,IAAAA,WAAW,CAACC,YAAZ,GAA2B,IAA3B;AACH,GAbD;;AAcA/K,EAAAA,OAAO,CAACQ,SAAR,CAAkB2K,gBAAlB,GAAqC,UAAUL,WAAV,EAAuB;AACxD,QAAIA,WAAW,CAACnG,IAAhB,EAAsB;AAClBmG,MAAAA,WAAW,CAACM,gBAAZ,CAA6BN,WAAW,CAACnG,IAAzC;AACH;;AACDmG,IAAAA,WAAW,CAACnG,IAAZ,GAAmB,IAAnB;AACAmG,IAAAA,WAAW,CAACC,YAAZ,GAA2B,IAA3B;AACH,GAND;;AAOA/K,EAAAA,OAAO,CAACQ,SAAR,CAAkB6K,WAAlB,GAAgC,YAAY;AACxC,WAAO,KAAKC,SAAZ;AACH,GAFD;;AAGAtL,EAAAA,OAAO,CAACQ,SAAR,CAAkBuF,WAAlB,GAAgC,UAAUwF,QAAV,EAAoB;AAChD,QAAI,KAAKD,SAAL,IAAkB,KAAKA,SAAL,KAAmBC,QAAzC,EAAmD;AAC/C,WAAKC,cAAL;AACH;;AACD,SAAKX,gBAAL,CAAsBU,QAAtB;;AACA,SAAKD,SAAL,GAAiBC,QAAjB;AACA,SAAKrK,UAAL;AACH,GAPD;;AAQAlB,EAAAA,OAAO,CAACQ,SAAR,CAAkBgL,cAAlB,GAAmC,YAAY;AAC3C,QAAID,QAAQ,GAAG,KAAKD,SAApB;;AACA,QAAIC,QAAJ,EAAc;AACV,WAAKJ,gBAAL,CAAsBI,QAAtB;;AACA,WAAKD,SAAL,GAAiB,IAAjB;AACA,WAAKpK,UAAL;AACH;AACJ,GAPD;;AAQAlB,EAAAA,OAAO,CAACQ,SAAR,CAAkBiL,cAAlB,GAAmC,YAAY;AAC3C,WAAO,KAAK9J,YAAZ;AACH,GAFD;;AAGA3B,EAAAA,OAAO,CAACQ,SAAR,CAAkBsF,cAAlB,GAAmC,UAAUpE,MAAV,EAAkB;AACjD,QAAIgK,mBAAmB,GAAG,KAAK/J,YAA/B;;AACA,QAAI+J,mBAAmB,KAAKhK,MAA5B,EAAoC;AAChC;AACH;;AACD,QAAIgK,mBAAmB,IAAIA,mBAAmB,KAAKhK,MAAnD,EAA2D;AACvD,WAAKiK,iBAAL;AACH;;AACD,QAAIjK,MAAM,CAACiD,IAAP,IAAe,CAACjD,MAAM,CAACqJ,YAA3B,EAAyC;AACrC,YAAM,IAAIC,KAAJ,CAAU,yCAAV,CAAN;AACH;;AACDtJ,IAAAA,MAAM,CAACK,iBAAP,GAA2B,IAAItD,eAAe,CAAC,SAAD,CAAnB,EAA3B;;AACA,SAAKoM,gBAAL,CAAsBnJ,MAAtB;;AACA,SAAKC,YAAL,GAAoBD,MAApB;AACA,SAAKR,UAAL;AACH,GAfD;;AAgBAlB,EAAAA,OAAO,CAACQ,SAAR,CAAkBqF,aAAlB,GAAkC,UAAU+F,GAAV,EAAe;AAC7C,QAAI,CAAC,KAAKhK,UAAV,EAAsB;AAClB,WAAKA,UAAL,GAAkB,EAAlB;AACH;;AACD7C,IAAAA,MAAM,CAACkH,MAAP,CAAc,KAAKrE,UAAnB,EAA+BgK,GAA/B;AACA,SAAK1K,UAAL;AACH,GAND;;AAOAlB,EAAAA,OAAO,CAACQ,SAAR,CAAkBmL,iBAAlB,GAAsC,YAAY;AAC9C,QAAIjK,MAAM,GAAG,KAAKC,YAAlB;;AACA,QAAID,MAAJ,EAAY;AACRA,MAAAA,MAAM,CAACK,iBAAP,GAA2B,IAA3B;;AACA,WAAKoJ,gBAAL,CAAsBzJ,MAAtB;;AACA,WAAKC,YAAL,GAAoB,IAApB;AACA,WAAK+B,sBAAL,GAA8B,IAA9B;AACA,WAAKxC,UAAL;AACH;AACJ,GATD;;AAUAlB,EAAAA,OAAO,CAACQ,SAAR,CAAkBqL,gBAAlB,GAAqC,YAAY;AAC7C,WAAO,KAAKhD,UAAZ;AACH,GAFD;;AAGA7I,EAAAA,OAAO,CAACQ,SAAR,CAAkBsL,gBAAlB,GAAqC,UAAUC,SAAV,EAAqB;AACtD,QAAI,KAAKlD,UAAL,IAAmB,KAAKA,UAAL,KAAoBkD,SAA3C,EAAsD;AAClD,WAAKC,mBAAL;AACH;;AACD,SAAKnB,gBAAL,CAAsBkB,SAAtB;;AACA,SAAKlD,UAAL,GAAkBkD,SAAlB;AACA,SAAK7K,UAAL;AACH,GAPD;;AAQAlB,EAAAA,OAAO,CAACQ,SAAR,CAAkBwL,mBAAlB,GAAwC,YAAY;AAChD,QAAIC,SAAS,GAAG,KAAKpD,UAArB;;AACA,QAAIoD,SAAJ,EAAe;AACX,WAAKd,gBAAL,CAAsBc,SAAtB;;AACA,WAAKpD,UAAL,GAAkB,IAAlB;AACA,WAAK3H,UAAL;AACH;AACJ,GAPD;;AAQAlB,EAAAA,OAAO,CAACQ,SAAR,CAAkBU,UAAlB,GAA+B,YAAY;AACvC,SAAKK,OAAL,IAAgBvB,OAAO,CAACgJ,WAAxB;AACA,QAAIiC,EAAE,GAAG,KAAKtG,IAAd;;AACA,QAAIsG,EAAJ,EAAQ;AACJ,UAAI,KAAKtC,SAAT,EAAoB;AAChBsC,QAAAA,EAAE,CAACiB,YAAH;AACH,OAFD,MAGK;AACDjB,QAAAA,EAAE,CAACkB,OAAH;AACH;AACJ;;AACD,QAAI,KAAKpB,YAAT,EAAuB;AACnB,WAAKA,YAAL,CAAkB7J,UAAlB;AACH;AACJ,GAdD;;AAeAlB,EAAAA,OAAO,CAACQ,SAAR,CAAkB4L,KAAlB,GAA0B,YAAY;AAClC,SAAKlL,UAAL;AACH,GAFD;;AAGAlB,EAAAA,OAAO,CAACQ,SAAR,CAAkBiI,qBAAlB,GAA0C,UAAU4D,OAAV,EAAmB;AACzD,SAAK1D,SAAL,GAAiB0D,OAAjB;AACA,QAAIC,WAAW,GAAG,KAAK3K,YAAvB;AACA,QAAIsK,SAAS,GAAG,KAAKpD,UAArB;;AACA,QAAIyD,WAAJ,EAAiB;AACbA,MAAAA,WAAW,CAAC3D,SAAZ,GAAwB0D,OAAxB;AACH;;AACD,QAAIJ,SAAJ,EAAe;AACXA,MAAAA,SAAS,CAACtD,SAAV,GAAsB0D,OAAtB;AACH;AACJ,GAVD;;AAWArM,EAAAA,OAAO,CAACQ,SAAR,CAAkB0K,WAAlB,GAAgC,UAAUD,EAAV,EAAc;AAC1C,SAAKtG,IAAL,GAAYsG,EAAZ;AACA,QAAI7K,SAAS,GAAG,KAAKA,SAArB;;AACA,QAAIA,SAAJ,EAAe;AACX,WAAK,IAAIiF,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGjF,SAAS,CAACqG,MAA9B,EAAsCpB,CAAC,EAAvC,EAA2C;AACvC4F,QAAAA,EAAE,CAACsB,SAAH,CAAaC,WAAb,CAAyBpM,SAAS,CAACiF,CAAD,CAAlC;AACH;AACJ;;AACD,QAAI,KAAKiG,SAAT,EAAoB;AAChB,WAAKA,SAAL,CAAeJ,WAAf,CAA2BD,EAA3B;AACH;;AACD,QAAI,KAAKtJ,YAAT,EAAuB;AACnB,WAAKA,YAAL,CAAkBuJ,WAAlB,CAA8BD,EAA9B;AACH;;AACD,QAAI,KAAKpC,UAAT,EAAqB;AACjB,WAAKA,UAAL,CAAgBqC,WAAhB,CAA4BD,EAA5B;AACH;AACJ,GAjBD;;AAkBAjL,EAAAA,OAAO,CAACQ,SAAR,CAAkB4K,gBAAlB,GAAqC,UAAUH,EAAV,EAAc;AAC/C,SAAKtG,IAAL,GAAY,IAAZ;AACA,QAAIvE,SAAS,GAAG,KAAKA,SAArB;;AACA,QAAIA,SAAJ,EAAe;AACX,WAAK,IAAIiF,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGjF,SAAS,CAACqG,MAA9B,EAAsCpB,CAAC,EAAvC,EAA2C;AACvC4F,QAAAA,EAAE,CAACsB,SAAH,CAAaE,cAAb,CAA4BrM,SAAS,CAACiF,CAAD,CAArC;AACH;AACJ;;AACD,QAAI,KAAKiG,SAAT,EAAoB;AAChB,WAAKA,SAAL,CAAeF,gBAAf,CAAgCH,EAAhC;AACH;;AACD,QAAI,KAAKtJ,YAAT,EAAuB;AACnB,WAAKA,YAAL,CAAkByJ,gBAAlB,CAAmCH,EAAnC;AACH;;AACD,QAAI,KAAKpC,UAAT,EAAqB;AACjB,WAAKA,UAAL,CAAgBuC,gBAAhB,CAAiCH,EAAjC;AACH;AACJ,GAjBD;;AAkBAjL,EAAAA,OAAO,CAACQ,SAAR,CAAkBkM,OAAlB,GAA4B,UAAU/G,GAAV,EAAegH,IAAf,EAAqB;AAC7C,QAAIxF,MAAM,GAAGxB,GAAG,GAAG,KAAKA,GAAL,CAAH,GAAe,IAA/B;;AACA,QAAI,CAACwB,MAAL,EAAa;AACTpI,MAAAA,MAAM,CAACuJ,QAAP,CAAgB,eACV3C,GADU,GAEV,8BAFU,GAGV,KAAKzF,EAHX;AAIA;AACH;;AACD,QAAI6G,QAAQ,GAAG,IAAIpI,UAAU,CAAC,SAAD,CAAd,CAA0BwI,MAA1B,EAAkCwF,IAAlC,CAAf;AACA,SAAKH,WAAL,CAAiBzF,QAAjB,EAA2BpB,GAA3B;AACA,WAAOoB,QAAP;AACH,GAZD;;AAaA/G,EAAAA,OAAO,CAACQ,SAAR,CAAkBgM,WAAlB,GAAgC,UAAUzF,QAAV,EAAoBpB,GAApB,EAAyB;AACrD,QAAIsF,EAAE,GAAG,KAAKtG,IAAd;AACA,QAAIiI,EAAE,GAAG,IAAT;AACA7F,IAAAA,QAAQ,CAAC8F,MAAT,CAAgB,YAAY;AACxBD,MAAAA,EAAE,CAACE,qBAAH,CAAyBnH,GAAzB;AACH,KAFD,EAEGoH,IAFH,CAEQ,YAAY;AAChB,UAAI3M,SAAS,GAAGwM,EAAE,CAACxM,SAAnB;AACA,UAAIwJ,GAAG,GAAG7K,MAAM,CAACyE,OAAP,CAAepD,SAAf,EAA0B2G,QAA1B,CAAV;;AACA,UAAI6C,GAAG,IAAI,CAAX,EAAc;AACVxJ,QAAAA,SAAS,CAACyJ,MAAV,CAAiBD,GAAjB,EAAsB,CAAtB;AACH;AACJ,KARD;AASA,SAAKxJ,SAAL,CAAe0I,IAAf,CAAoB/B,QAApB;;AACA,QAAIkE,EAAJ,EAAQ;AACJA,MAAAA,EAAE,CAACsB,SAAH,CAAaC,WAAb,CAAyBzF,QAAzB;AACH;;AACDkE,IAAAA,EAAE,IAAIA,EAAE,CAAC+B,MAAH,EAAN;AACH,GAjBD;;AAkBAhN,EAAAA,OAAO,CAACQ,SAAR,CAAkBsM,qBAAlB,GAA0C,UAAUnH,GAAV,EAAe;AACrD,SAAKzE,UAAL;AACH,GAFD;;AAGAlB,EAAAA,OAAO,CAACQ,SAAR,CAAkByM,aAAlB,GAAkC,UAAUC,KAAV,EAAiBC,aAAjB,EAAgC;AAC9D,QAAI/M,SAAS,GAAG,KAAKA,SAArB;AACA,QAAI+I,GAAG,GAAG/I,SAAS,CAACqG,MAApB;AACA,QAAI2G,aAAa,GAAG,EAApB;;AACA,SAAK,IAAI/H,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG8D,GAApB,EAAyB9D,CAAC,EAA1B,EAA8B;AAC1B,UAAI0B,QAAQ,GAAG3G,SAAS,CAACiF,CAAD,CAAxB;;AACA,UAAI,CAAC6H,KAAD,IAAUA,KAAK,KAAKnG,QAAQ,CAACmG,KAAjC,EAAwC;AACpCnG,QAAAA,QAAQ,CAACsG,IAAT,CAAcF,aAAd;AACH,OAFD,MAGK;AACDC,QAAAA,aAAa,CAACtE,IAAd,CAAmB/B,QAAnB;AACH;AACJ;;AACD,SAAK3G,SAAL,GAAiBgN,aAAjB;AACA,WAAO,IAAP;AACH,GAfD;;AAgBApN,EAAAA,OAAO,CAACQ,SAAR,CAAkB8M,SAAlB,GAA8B,UAAUnG,MAAV,EAAkByE,GAAlB,EAAuB2B,cAAvB,EAAuC;AACjED,IAAAA,SAAS,CAAC,IAAD,EAAOnG,MAAP,EAAeyE,GAAf,EAAoB2B,cAApB,CAAT;AACH,GAFD;;AAGAvN,EAAAA,OAAO,CAACQ,SAAR,CAAkBgN,WAAlB,GAAgC,UAAUrG,MAAV,EAAkByE,GAAlB,EAAuB2B,cAAvB,EAAuC;AACnED,IAAAA,SAAS,CAAC,IAAD,EAAOnG,MAAP,EAAeyE,GAAf,EAAoB2B,cAApB,EAAoC,IAApC,CAAT;AACH,GAFD;;AAGAvN,EAAAA,OAAO,CAACQ,SAAR,CAAkBoK,gBAAlB,GAAqC,UAAU9C,SAAV,EAAqBX,MAArB,EAA6ByE,GAA7B,EAAkC2B,cAAlC,EAAkD;AACnF,QAAInN,SAAS,GAAGkN,SAAS,CAAC,IAAD,EAAOnG,MAAP,EAAeyE,GAAf,EAAoB2B,cAApB,CAAzB;;AACA,SAAK,IAAIlI,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGjF,SAAS,CAACqG,MAA9B,EAAsCpB,CAAC,EAAvC,EAA2C;AACvCjF,MAAAA,SAAS,CAACiF,CAAD,CAAT,CAAa4B,qBAAb,GAAqCa,SAArC;AACH;AACJ,GALD;;AAMA9H,EAAAA,OAAO,CAACQ,SAAR,CAAkBgC,eAAlB,GAAoC,YAAY;AAC5C,WAAO,IAAP;AACH,GAFD;;AAGAxC,EAAAA,OAAO,CAACQ,SAAR,CAAkBiN,YAAlB,GAAiC,YAAY;AACzC,WAAO,IAAP;AACH,GAFD;;AAGAzN,EAAAA,OAAO,CAACgJ,WAAR,GAAsB,CAAtB;;AACAhJ,EAAAA,OAAO,CAAC0N,gBAAR,GAA4B,YAAY;AACpC,QAAIC,OAAO,GAAG3N,OAAO,CAACQ,SAAtB;AACAmN,IAAAA,OAAO,CAACC,IAAR,GAAe,SAAf;AACAD,IAAAA,OAAO,CAAClG,IAAR,GAAe,EAAf;AACAkG,IAAAA,OAAO,CAAC9N,MAAR,GAAiB,KAAjB;AACA8N,IAAAA,OAAO,CAACE,MAAR,GAAiB,KAAjB;AACAF,IAAAA,OAAO,CAACG,OAAR,GAAkB,KAAlB;AACAH,IAAAA,OAAO,CAAC7M,SAAR,GAAoB,KAApB;AACA6M,IAAAA,OAAO,CAACI,QAAR,GAAmB,KAAnB;AACAJ,IAAAA,OAAO,CAACK,UAAR,GAAqB,KAArB;AACAL,IAAAA,OAAO,CAAChF,SAAR,GAAoB,KAApB;AACAgF,IAAAA,OAAO,CAACpM,OAAR,GAAkBvB,OAAO,CAACgJ,WAA1B;AACA,QAAIiF,IAAI,GAAG,EAAX;;AACA,aAASC,kBAAT,CAA4BvI,GAA5B,EAAiCwI,IAAjC,EAAuCC,IAAvC,EAA6C;AACzC,UAAI,CAACH,IAAI,CAACtI,GAAG,GAAGwI,IAAN,GAAaC,IAAd,CAAT,EAA8B;AAC1BC,QAAAA,OAAO,CAACC,IAAR,CAAa,kBAAkB3I,GAAlB,GAAwB,8BAAxB,GAAyDwI,IAAzD,GAAgE,MAAhE,GAAyEC,IAAzE,GAAgF,WAA7F;AACAH,QAAAA,IAAI,CAACtI,GAAG,GAAGwI,IAAN,GAAaC,IAAd,CAAJ,GAA0B,IAA1B;AACH;AACJ;;AACD,aAASG,oBAAT,CAA8B5I,GAA9B,EAAmC6I,UAAnC,EAA+CL,IAA/C,EAAqDC,IAArD,EAA2D;AACvDK,MAAAA,MAAM,CAACC,cAAP,CAAsBf,OAAtB,EAA+BhI,GAA/B,EAAoC;AAChCgJ,QAAAA,GAAG,EAAE,YAAY;AACbT,UAAAA,kBAAkB,CAACvI,GAAD,EAAMwI,IAAN,EAAYC,IAAZ,CAAlB;;AACA,cAAI,CAAC,KAAKI,UAAL,CAAL,EAAuB;AACnB,gBAAII,GAAG,GAAG,KAAKJ,UAAL,IAAmB,EAA7B;AACAK,YAAAA,YAAY,CAAC,IAAD,EAAOD,GAAP,CAAZ;AACH;;AACD,iBAAO,KAAKJ,UAAL,CAAP;AACH,SAR+B;AAShCM,QAAAA,GAAG,EAAE,UAAUF,GAAV,EAAe;AAChBV,UAAAA,kBAAkB,CAACvI,GAAD,EAAMwI,IAAN,EAAYC,IAAZ,CAAlB;AACA,eAAKD,IAAL,IAAaS,GAAG,CAAC,CAAD,CAAhB;AACA,eAAKR,IAAL,IAAaQ,GAAG,CAAC,CAAD,CAAhB;AACA,eAAKJ,UAAL,IAAmBI,GAAnB;AACAC,UAAAA,YAAY,CAAC,IAAD,EAAOD,GAAP,CAAZ;AACH;AAf+B,OAApC;;AAiBA,eAASC,YAAT,CAAsBE,IAAtB,EAA4BH,GAA5B,EAAiC;AAC7BH,QAAAA,MAAM,CAACC,cAAP,CAAsBE,GAAtB,EAA2B,CAA3B,EAA8B;AAC1BD,UAAAA,GAAG,EAAE,YAAY;AACb,mBAAOI,IAAI,CAACZ,IAAD,CAAX;AACH,WAHyB;AAI1BW,UAAAA,GAAG,EAAE,UAAUE,GAAV,EAAe;AAChBD,YAAAA,IAAI,CAACZ,IAAD,CAAJ,GAAaa,GAAb;AACH;AANyB,SAA9B;AAQAP,QAAAA,MAAM,CAACC,cAAP,CAAsBE,GAAtB,EAA2B,CAA3B,EAA8B;AAC1BD,UAAAA,GAAG,EAAE,YAAY;AACb,mBAAOI,IAAI,CAACX,IAAD,CAAX;AACH,WAHyB;AAI1BU,UAAAA,GAAG,EAAE,UAAUE,GAAV,EAAe;AAChBD,YAAAA,IAAI,CAACX,IAAD,CAAJ,GAAaY,GAAb;AACH;AANyB,SAA9B;AAQH;AACJ;;AACD,QAAIP,MAAM,CAACC,cAAP,KAA0B,CAACxP,KAAK,CAAC,SAAD,CAAL,CAAiB+P,OAAjB,CAAyBC,EAA1B,IAAgChQ,KAAK,CAAC,SAAD,CAAL,CAAiB+P,OAAjB,CAAyBE,OAAzB,GAAmC,CAA7F,CAAJ,EAAqG;AACjGZ,MAAAA,oBAAoB,CAAC,UAAD,EAAa,YAAb,EAA2B,GAA3B,EAAgC,GAAhC,CAApB;AACAA,MAAAA,oBAAoB,CAAC,OAAD,EAAU,cAAV,EAA0B,QAA1B,EAAoC,QAApC,CAApB;AACAA,MAAAA,oBAAoB,CAAC,QAAD,EAAW,eAAX,EAA4B,SAA5B,EAAuC,SAAvC,CAApB;AACH;AACJ,GA7D0B,EAA3B;;AA8DA,SAAOvO,OAAP;AACH,CAtxBc,EAAf;;AAuxBAjB,MAAM,CAACqQ,KAAP,CAAapP,OAAb,EAAsBnB,UAAU,CAAC,SAAD,CAAhC;AACAE,MAAM,CAACqQ,KAAP,CAAapP,OAAb,EAAsBvB,eAAe,CAAC,SAAD,CAArC;;AACA,SAAS6O,SAAT,CAAmB+B,UAAnB,EAA+BlI,MAA/B,EAAuCyE,GAAvC,EAA4C2B,cAA5C,EAA4D+B,OAA5D,EAAqE;AACjE1D,EAAAA,GAAG,GAAGA,GAAG,IAAI,EAAb;AACA,MAAIxL,SAAS,GAAG,EAAhB;AACAmP,EAAAA,gBAAgB,CAACF,UAAD,EAAa,EAAb,EAAiBA,UAAjB,EAA6BlI,MAA7B,EAAqCyE,GAArC,EAA0C2B,cAA1C,EAA0DnN,SAA1D,EAAqEkP,OAArE,CAAhB;AACA,MAAIE,WAAW,GAAGpP,SAAS,CAACqG,MAA5B;AACA,MAAIgJ,YAAY,GAAG,KAAnB;AACA,MAAIC,OAAO,GAAG9D,GAAG,CAACmB,IAAlB;AACA,MAAI4C,UAAU,GAAG/D,GAAG,CAACgE,OAArB;;AACA,MAAIC,MAAM,GAAG,YAAY;AACrBJ,IAAAA,YAAY,GAAG,IAAf;AACAD,IAAAA,WAAW;;AACX,QAAIA,WAAW,IAAI,CAAnB,EAAsB;AAClBC,MAAAA,YAAY,GACLC,OAAO,IAAIA,OAAO,EADb,GAELC,UAAU,IAAIA,UAAU,EAF/B;AAGH;AACJ,GARD;;AASA,MAAIG,SAAS,GAAG,YAAY;AACxBN,IAAAA,WAAW;;AACX,QAAIA,WAAW,IAAI,CAAnB,EAAsB;AAClBC,MAAAA,YAAY,GACLC,OAAO,IAAIA,OAAO,EADb,GAELC,UAAU,IAAIA,UAAU,EAF/B;AAGH;AACJ,GAPD;;AAQA,MAAI,CAACH,WAAL,EAAkB;AACdE,IAAAA,OAAO,IAAIA,OAAO,EAAlB;AACH;;AACD,MAAItP,SAAS,CAACqG,MAAV,GAAmB,CAAnB,IAAwBmF,GAAG,CAACiB,MAAhC,EAAwC;AACpCzM,IAAAA,SAAS,CAAC,CAAD,CAAT,CAAayM,MAAb,CAAoB,UAAU1F,MAAV,EAAkB4I,OAAlB,EAA2B;AAC3CnE,MAAAA,GAAG,CAACiB,MAAJ,CAAWkD,OAAX;AACH,KAFD;AAGH;;AACD,OAAK,IAAI1K,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGjF,SAAS,CAACqG,MAA9B,EAAsCpB,CAAC,EAAvC,EAA2C;AACvC,QAAI0B,QAAQ,GAAG3G,SAAS,CAACiF,CAAD,CAAxB;;AACA,QAAIwK,MAAJ,EAAY;AACR9I,MAAAA,QAAQ,CAACgG,IAAT,CAAc8C,MAAd;AACH;;AACD,QAAIC,SAAJ,EAAe;AACX/I,MAAAA,QAAQ,CAAC6I,OAAT,CAAiBE,SAAjB;AACH;;AACD/I,IAAAA,QAAQ,CAACiJ,KAAT,CAAepE,GAAG,CAACqE,MAAnB,EAA2BrE,GAAG,CAACsE,KAA/B;AACH;;AACD,SAAO9P,SAAP;AACH;;AACD,SAAS+P,cAAT,CAAwBC,MAAxB,EAAgCjJ,MAAhC,EAAwCgC,GAAxC,EAA6C;AACzC,OAAK,IAAI9D,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG8D,GAApB,EAAyB9D,CAAC,EAA1B,EAA8B;AAC1B+K,IAAAA,MAAM,CAAC/K,CAAD,CAAN,GAAY8B,MAAM,CAAC9B,CAAD,CAAlB;AACH;AACJ;;AACD,SAASgL,SAAT,CAAmBzK,KAAnB,EAA0B;AACtB,SAAO7G,MAAM,CAACuR,WAAP,CAAmB1K,KAAK,CAAC,CAAD,CAAxB,CAAP;AACH;;AACD,SAAS2K,SAAT,CAAmBpJ,MAAnB,EAA2BiJ,MAA3B,EAAmCzK,GAAnC,EAAwC;AACpC,MAAI5G,MAAM,CAACuR,WAAP,CAAmBF,MAAM,CAACzK,GAAD,CAAzB,CAAJ,EAAqC;AACjC,QAAI,CAAC5G,MAAM,CAACuR,WAAP,CAAmBnJ,MAAM,CAACxB,GAAD,CAAzB,CAAL,EAAsC;AAClCwB,MAAAA,MAAM,CAACxB,GAAD,CAAN,GAAc,EAAd;AACH;;AACD,QAAI5G,MAAM,CAACyR,YAAP,CAAoBJ,MAAM,CAACzK,GAAD,CAA1B,CAAJ,EAAsC;AAClC,UAAIwD,GAAG,GAAGiH,MAAM,CAACzK,GAAD,CAAN,CAAYc,MAAtB;;AACA,UAAIU,MAAM,CAACxB,GAAD,CAAN,CAAYc,MAAZ,KAAuB0C,GAA3B,EAAgC;AAC5BhC,QAAAA,MAAM,CAACxB,GAAD,CAAN,GAAc,IAAKyK,MAAM,CAACzK,GAAD,CAAN,CAAY8K,WAAjB,CAA8BtH,GAA9B,CAAd;AACAgH,QAAAA,cAAc,CAAChJ,MAAM,CAACxB,GAAD,CAAP,EAAcyK,MAAM,CAACzK,GAAD,CAApB,EAA2BwD,GAA3B,CAAd;AACH;AACJ,KAND,MAOK;AACD,UAAIuH,SAAS,GAAGN,MAAM,CAACzK,GAAD,CAAtB;AACA,UAAIgL,SAAS,GAAGxJ,MAAM,CAACxB,GAAD,CAAtB;AACA,UAAIiL,IAAI,GAAGF,SAAS,CAACjK,MAArB;;AACA,UAAI4J,SAAS,CAACK,SAAD,CAAb,EAA0B;AACtB,YAAIG,IAAI,GAAGH,SAAS,CAAC,CAAD,CAAT,CAAajK,MAAxB;;AACA,aAAK,IAAIpB,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGuL,IAApB,EAA0BvL,CAAC,EAA3B,EAA+B;AAC3B,cAAI,CAACsL,SAAS,CAACtL,CAAD,CAAd,EAAmB;AACfsL,YAAAA,SAAS,CAACtL,CAAD,CAAT,GAAeyL,KAAK,CAACtQ,SAAN,CAAgBiJ,KAAhB,CAAsBsH,IAAtB,CAA2BL,SAAS,CAACrL,CAAD,CAApC,CAAf;AACH,WAFD,MAGK;AACD8K,YAAAA,cAAc,CAACQ,SAAS,CAACtL,CAAD,CAAV,EAAeqL,SAAS,CAACrL,CAAD,CAAxB,EAA6BwL,IAA7B,CAAd;AACH;AACJ;AACJ,OAVD,MAWK;AACDV,QAAAA,cAAc,CAACQ,SAAD,EAAYD,SAAZ,EAAuBE,IAAvB,CAAd;AACH;;AACDD,MAAAA,SAAS,CAAClK,MAAV,GAAmBiK,SAAS,CAACjK,MAA7B;AACH;AACJ,GA/BD,MAgCK;AACDU,IAAAA,MAAM,CAACxB,GAAD,CAAN,GAAcyK,MAAM,CAACzK,GAAD,CAApB;AACH;AACJ;;AACD,SAAS4J,gBAAT,CAA0BF,UAA1B,EAAsC2B,MAAtC,EAA8CZ,MAA9C,EAAsDjJ,MAAtD,EAA8DyE,GAA9D,EAAmE2B,cAAnE,EAAmFnN,SAAnF,EAA8FkP,OAA9F,EAAuG;AACnG,MAAI2B,cAAc,GAAG,EAArB;AACA,MAAIC,WAAW,GAAG,EAAlB;AACA,MAAIC,UAAU,GAAGpS,MAAM,CAACyH,IAAP,CAAYW,MAAZ,CAAjB;AACA,MAAIyB,QAAQ,GAAGgD,GAAG,CAAChD,QAAnB;AACA,MAAIwI,KAAK,GAAGxF,GAAG,CAACwF,KAAhB;AACA,MAAIC,QAAQ,GAAGzF,GAAG,CAACyF,QAAnB;AACA,MAAIC,UAAU,GAAG1F,GAAG,CAAC0F,UAArB;AACA,MAAIC,UAAU,GAAG,CAACxS,MAAM,CAACsH,QAAP,CAAgBkH,cAAhB,CAAlB;;AACA,OAAK,IAAIiE,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGL,UAAU,CAAC1K,MAA/B,EAAuC+K,CAAC,EAAxC,EAA4C;AACxC,QAAIC,QAAQ,GAAGN,UAAU,CAACK,CAAD,CAAzB;;AACA,QAAIpB,MAAM,CAACqB,QAAD,CAAN,IAAoB,IAApB,IACGtK,MAAM,CAACsK,QAAD,CAAN,IAAoB,IADvB,KAEIF,UAAU,IAAIhE,cAAc,CAACkE,QAAD,CAFhC,CAAJ,EAEiD;AAC7C,UAAI1S,MAAM,CAACsH,QAAP,CAAgBc,MAAM,CAACsK,QAAD,CAAtB,KAAqC,CAAC1S,MAAM,CAACuR,WAAP,CAAmBnJ,MAAM,CAACsK,QAAD,CAAzB,CAA1C,EAAgF;AAC5E,YAAIT,MAAJ,EAAY;AACR,cAAI,CAAC1B,OAAL,EAAc;AACVc,YAAAA,MAAM,CAACqB,QAAD,CAAN,GAAmBtK,MAAM,CAACsK,QAAD,CAAzB;AACApC,YAAAA,UAAU,CAACvC,qBAAX,CAAiCkE,MAAjC;AACH;;AACD;AACH;;AACDzB,QAAAA,gBAAgB,CAACF,UAAD,EAAaoC,QAAb,EAAuBrB,MAAM,CAACqB,QAAD,CAA7B,EAAyCtK,MAAM,CAACsK,QAAD,CAA/C,EAA2D7F,GAA3D,EAAgE2B,cAAc,IAAIA,cAAc,CAACkE,QAAD,CAAhG,EAA4GrR,SAA5G,EAAuHkP,OAAvH,CAAhB;AACH,OATD,MAUK;AACD2B,QAAAA,cAAc,CAACnI,IAAf,CAAoB2I,QAApB;AACAP,QAAAA,WAAW,CAACpI,IAAZ,CAAiB2I,QAAjB;AACH;AACJ,KAjBD,MAkBK,IAAI,CAACnC,OAAL,EAAc;AACfc,MAAAA,MAAM,CAACqB,QAAD,CAAN,GAAmBtK,MAAM,CAACsK,QAAD,CAAzB;AACApC,MAAAA,UAAU,CAACvC,qBAAX,CAAiCkE,MAAjC;AACAE,MAAAA,WAAW,CAACpI,IAAZ,CAAiB2I,QAAjB;AACH;AACJ;;AACD,MAAIC,MAAM,GAAGT,cAAc,CAACxK,MAA5B;;AACA,MAAIiL,MAAM,GAAG,CAAT,IACI9F,GAAG,CAACsE,KAAJ,IAAa,CAAC9P,SAAS,CAACqG,MADhC,EACyC;AACrC,QAAIkL,eAAe,GAAGtC,UAAU,CAACjP,SAAjC;AACA,QAAIwR,2BAA2B,GAAG,EAAlC;;AACA,SAAK,IAAIvM,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGsM,eAAe,CAAClL,MAApC,EAA4CpB,CAAC,EAA7C,EAAiD;AAC7C,UAAIsM,eAAe,CAACtM,CAAD,CAAf,CAAmB6B,UAAnB,KAAkC8J,MAAtC,EAA8C;AAC1CY,QAAAA,2BAA2B,CAAC9I,IAA5B,CAAiC6I,eAAe,CAACtM,CAAD,CAAhD;AACH;AACJ;;AACD,QAAI,CAACgM,QAAD,IAAaO,2BAA2B,CAACnL,MAA7C,EAAqD;AACjD,WAAK,IAAIpB,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGuM,2BAA2B,CAACnL,MAAhD,EAAwDpB,CAAC,EAAzD,EAA6D;AACzD,YAAIwM,UAAU,GAAGD,2BAA2B,CAACvM,CAAD,CAA3B,CAA+ByM,UAA/B,CAA0CZ,WAA1C,CAAjB;;AACA,YAAIW,UAAJ,EAAgB;AACZ,cAAIjI,GAAG,GAAG7K,MAAM,CAACyE,OAAP,CAAemO,eAAf,EAAgCC,2BAA2B,CAACvM,CAAD,CAA3D,CAAV;AACAsM,UAAAA,eAAe,CAAC9H,MAAhB,CAAuBD,GAAvB,EAA4B,CAA5B;AACH;AACJ;AACJ;;AACD,QAAImI,cAAc,GAAG,KAAK,CAA1B;AACA,QAAIC,cAAc,GAAG,KAAK,CAA1B;AACA,QAAIC,WAAW,GAAG,KAAK,CAAvB;;AACA,QAAI3C,OAAJ,EAAa;AACT0C,MAAAA,cAAc,GAAG,EAAjB;;AACA,UAAIV,UAAJ,EAAgB;AACZS,QAAAA,cAAc,GAAG,EAAjB;AACH;;AACD,WAAK,IAAI1M,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGqM,MAApB,EAA4BrM,CAAC,EAA7B,EAAiC;AAC7B,YAAIoM,QAAQ,GAAGR,cAAc,CAAC5L,CAAD,CAA7B;AACA2M,QAAAA,cAAc,CAACP,QAAD,CAAd,GAA2BrB,MAAM,CAACqB,QAAD,CAAjC;;AACA,YAAIH,UAAJ,EAAgB;AACZS,UAAAA,cAAc,CAACN,QAAD,CAAd,GAA2BtK,MAAM,CAACsK,QAAD,CAAjC;AACH,SAFD,MAGK;AACDrB,UAAAA,MAAM,CAACqB,QAAD,CAAN,GAAmBtK,MAAM,CAACsK,QAAD,CAAzB;AACH;AACJ;AACJ,KAfD,MAgBK,IAAIH,UAAJ,EAAgB;AACjBW,MAAAA,WAAW,GAAG,EAAd;;AACA,WAAK,IAAI5M,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGqM,MAApB,EAA4BrM,CAAC,EAA7B,EAAiC;AAC7B,YAAIoM,QAAQ,GAAGR,cAAc,CAAC5L,CAAD,CAA7B;AACA4M,QAAAA,WAAW,CAACR,QAAD,CAAX,GAAwB9S,UAAU,CAACuT,UAAX,CAAsB9B,MAAM,CAACqB,QAAD,CAA5B,CAAxB;AACAlB,QAAAA,SAAS,CAACH,MAAD,EAASjJ,MAAT,EAAiBsK,QAAjB,CAAT;AACH;AACJ;;AACD,QAAI1K,QAAQ,GAAG,IAAIpI,UAAU,CAAC,SAAD,CAAd,CAA0ByR,MAA1B,EAAkC,KAAlC,EAAyCiB,QAAQ,GAAGO,2BAAH,GAAiC,IAAlF,CAAf;AACA7K,IAAAA,QAAQ,CAACG,UAAT,GAAsB8J,MAAtB;;AACA,QAAIpF,GAAG,CAACsB,KAAR,EAAe;AACXnG,MAAAA,QAAQ,CAACmG,KAAT,GAAiBtB,GAAG,CAACsB,KAArB;AACH;;AACD,QAAIoE,UAAU,IAAIS,cAAlB,EAAkC;AAC9BhL,MAAAA,QAAQ,CAACoL,YAAT,CAAsB,CAAtB,EAAyBJ,cAAzB,EAAyCd,cAAzC;AACH;;AACD,QAAIgB,WAAJ,EAAiB;AACblL,MAAAA,QAAQ,CAACoL,YAAT,CAAsB,CAAtB,EAAyBF,WAAzB,EAAsChB,cAAtC;AACH;;AACDlK,IAAAA,QAAQ,CAACoL,YAAT,CAAsBvJ,QAAQ,IAAI,IAAZ,GAAmB,GAAnB,GAAyBA,QAA/C,EAAyD0G,OAAO,GAAG0C,cAAH,GAAoB7K,MAApF,EAA4F8J,cAA5F,EAA4GG,KAA5G,CAAkHA,KAAK,IAAI,CAA3H;AACA/B,IAAAA,UAAU,CAAC7C,WAAX,CAAuBzF,QAAvB,EAAiCiK,MAAjC;AACA5Q,IAAAA,SAAS,CAAC0I,IAAV,CAAe/B,QAAf;AACH;AACJ;;AACDxI,OAAO,CAAC,SAAD,CAAP,GAAqByB,OAArB","sourcesContent":["\"use strict\";\nexports.__esModule = true;\nvar Transformable_1 = require(\"./core/Transformable\");\nvar Animator_1 = require(\"./animation/Animator\");\nvar BoundingRect_1 = require(\"./core/BoundingRect\");\nvar Eventful_1 = require(\"./core/Eventful\");\nvar text_1 = require(\"./contain/text\");\nvar util_1 = require(\"./core/util\");\nvar config_1 = require(\"./config\");\nvar color_1 = require(\"./tool/color\");\nvar env_1 = require(\"./core/env\");\nexports.PRESERVED_NORMAL_STATE = '__zr_normal__';\nvar PRIMARY_STATES_KEYS = ['x', 'y', 'scaleX', 'scaleY', 'originX', 'originY', 'rotation', 'ignore'];\nvar DEFAULT_ANIMATABLE_MAP = {\n    x: true,\n    y: true,\n    scaleX: true,\n    scaleY: true,\n    originX: true,\n    originY: true,\n    rotation: true,\n    ignore: false\n};\nvar tmpTextPosCalcRes = {};\nvar tmpBoundingRect = new BoundingRect_1[\"default\"](0, 0, 0, 0);\nvar Element = (function () {\n    function Element(props) {\n        this.id = util_1.guid();\n        this.animators = [];\n        this.currentStates = [];\n        this.states = {};\n        this._init(props);\n    }\n    Element.prototype._init = function (props) {\n        this.attr(props);\n    };\n    Element.prototype.drift = function (dx, dy, e) {\n        switch (this.draggable) {\n            case 'horizontal':\n                dy = 0;\n                break;\n            case 'vertical':\n                dx = 0;\n                break;\n        }\n        var m = this.transform;\n        if (!m) {\n            m = this.transform = [1, 0, 0, 1, 0, 0];\n        }\n        m[4] += dx;\n        m[5] += dy;\n        this.decomposeTransform();\n        this.markRedraw();\n    };\n    Element.prototype.beforeUpdate = function () { };\n    Element.prototype.afterUpdate = function () { };\n    Element.prototype.update = function () {\n        this.updateTransform();\n        if (this.__dirty) {\n            this.updateInnerText();\n        }\n    };\n    Element.prototype.updateInnerText = function (forceUpdate) {\n        var textEl = this._textContent;\n        if (textEl && (!textEl.ignore || forceUpdate)) {\n            if (!this.textConfig) {\n                this.textConfig = {};\n            }\n            var textConfig = this.textConfig;\n            var isLocal = textConfig.local;\n            var attachedTransform = textEl.attachedTransform;\n            var textAlign = void 0;\n            var textVerticalAlign = void 0;\n            var textStyleChanged = false;\n            if (isLocal) {\n                attachedTransform.parent = this;\n            }\n            else {\n                attachedTransform.parent = null;\n            }\n            var innerOrigin = false;\n            attachedTransform.x = textEl.x;\n            attachedTransform.y = textEl.y;\n            attachedTransform.originX = textEl.originX;\n            attachedTransform.originY = textEl.originY;\n            attachedTransform.rotation = textEl.rotation;\n            attachedTransform.scaleX = textEl.scaleX;\n            attachedTransform.scaleY = textEl.scaleY;\n            if (textConfig.position != null) {\n                var layoutRect = tmpBoundingRect;\n                if (textConfig.layoutRect) {\n                    layoutRect.copy(textConfig.layoutRect);\n                }\n                else {\n                    layoutRect.copy(this.getBoundingRect());\n                }\n                if (!isLocal) {\n                    layoutRect.applyTransform(this.transform);\n                }\n                if (this.calculateTextPosition) {\n                    this.calculateTextPosition(tmpTextPosCalcRes, textConfig, layoutRect);\n                }\n                else {\n                    text_1.calculateTextPosition(tmpTextPosCalcRes, textConfig, layoutRect);\n                }\n                attachedTransform.x = tmpTextPosCalcRes.x;\n                attachedTransform.y = tmpTextPosCalcRes.y;\n                textAlign = tmpTextPosCalcRes.align;\n                textVerticalAlign = tmpTextPosCalcRes.verticalAlign;\n                var textOrigin = textConfig.origin;\n                if (textOrigin && textConfig.rotation != null) {\n                    var relOriginX = void 0;\n                    var relOriginY = void 0;\n                    if (textOrigin === 'center') {\n                        relOriginX = layoutRect.width * 0.5;\n                        relOriginY = layoutRect.height * 0.5;\n                    }\n                    else {\n                        relOriginX = text_1.parsePercent(textOrigin[0], layoutRect.width);\n                        relOriginY = text_1.parsePercent(textOrigin[1], layoutRect.height);\n                    }\n                    innerOrigin = true;\n                    attachedTransform.originX = -attachedTransform.x + relOriginX + (isLocal ? 0 : layoutRect.x);\n                    attachedTransform.originY = -attachedTransform.y + relOriginY + (isLocal ? 0 : layoutRect.y);\n                }\n            }\n            if (textConfig.rotation != null) {\n                attachedTransform.rotation = textConfig.rotation;\n            }\n            var textOffset = textConfig.offset;\n            if (textOffset) {\n                attachedTransform.x += textOffset[0];\n                attachedTransform.y += textOffset[1];\n                if (!innerOrigin) {\n                    attachedTransform.originX = -textOffset[0];\n                    attachedTransform.originY = -textOffset[1];\n                }\n            }\n            var isInside = textConfig.inside == null\n                ? (typeof textConfig.position === 'string' && textConfig.position.indexOf('inside') >= 0)\n                : textConfig.inside;\n            var innerTextDefaultStyle = this._innerTextDefaultStyle || (this._innerTextDefaultStyle = {});\n            var textFill = void 0;\n            var textStroke = void 0;\n            var autoStroke = void 0;\n            if (isInside && this.canBeInsideText()) {\n                textFill = textConfig.insideFill;\n                textStroke = textConfig.insideStroke;\n                if (textFill == null || textFill === 'auto') {\n                    textFill = this.getInsideTextFill();\n                }\n                if (textStroke == null || textStroke === 'auto') {\n                    textStroke = this.getInsideTextStroke(textFill);\n                    autoStroke = true;\n                }\n            }\n            else {\n                textFill = textConfig.outsideFill;\n                textStroke = textConfig.outsideStroke;\n                if (textFill == null || textFill === 'auto') {\n                    textFill = this.getOutsideFill();\n                }\n                if (textStroke == null || textStroke === 'auto') {\n                    textStroke = this.getOutsideStroke(textFill);\n                    autoStroke = true;\n                }\n            }\n            textFill = textFill || '#000';\n            if (textFill !== innerTextDefaultStyle.fill\n                || textStroke !== innerTextDefaultStyle.stroke\n                || autoStroke !== innerTextDefaultStyle.autoStroke\n                || textAlign !== innerTextDefaultStyle.align\n                || textVerticalAlign !== innerTextDefaultStyle.verticalAlign) {\n                textStyleChanged = true;\n                innerTextDefaultStyle.fill = textFill;\n                innerTextDefaultStyle.stroke = textStroke;\n                innerTextDefaultStyle.autoStroke = autoStroke;\n                innerTextDefaultStyle.align = textAlign;\n                innerTextDefaultStyle.verticalAlign = textVerticalAlign;\n                textEl.setDefaultTextStyle(innerTextDefaultStyle);\n            }\n            if (textStyleChanged) {\n                textEl.dirtyStyle();\n            }\n            textEl.markRedraw();\n        }\n    };\n    Element.prototype.canBeInsideText = function () {\n        return true;\n    };\n    Element.prototype.getInsideTextFill = function () {\n        return '#fff';\n    };\n    Element.prototype.getInsideTextStroke = function (textFill) {\n        return '#000';\n    };\n    Element.prototype.getOutsideFill = function () {\n        return this.__zr && this.__zr.isDarkMode() ? config_1.LIGHT_LABEL_COLOR : config_1.DARK_LABEL_COLOR;\n    };\n    Element.prototype.getOutsideStroke = function (textFill) {\n        var backgroundColor = this.__zr && this.__zr.getBackgroundColor();\n        var colorArr = typeof backgroundColor === 'string' && color_1.parse(backgroundColor);\n        if (!colorArr) {\n            colorArr = [255, 255, 255, 1];\n        }\n        var alpha = colorArr[3];\n        var isDark = this.__zr.isDarkMode();\n        for (var i = 0; i < 3; i++) {\n            colorArr[i] = colorArr[i] * alpha + (isDark ? 0 : 255) * (1 - alpha);\n        }\n        colorArr[3] = 1;\n        return color_1.stringify(colorArr, 'rgba');\n    };\n    Element.prototype.traverse = function (cb, context) { };\n    Element.prototype.attrKV = function (key, value) {\n        if (key === 'textConfig') {\n            this.setTextConfig(value);\n        }\n        else if (key === 'textContent') {\n            this.setTextContent(value);\n        }\n        else if (key === 'clipPath') {\n            this.setClipPath(value);\n        }\n        else if (key === 'extra') {\n            this.extra = this.extra || {};\n            util_1.extend(this.extra, value);\n        }\n        else {\n            this[key] = value;\n        }\n    };\n    Element.prototype.hide = function () {\n        this.ignore = true;\n        this.markRedraw();\n    };\n    Element.prototype.show = function () {\n        this.ignore = false;\n        this.markRedraw();\n    };\n    Element.prototype.attr = function (keyOrObj, value) {\n        if (typeof keyOrObj === 'string') {\n            this.attrKV(keyOrObj, value);\n        }\n        else if (util_1.isObject(keyOrObj)) {\n            var obj = keyOrObj;\n            var keysArr = util_1.keys(obj);\n            for (var i = 0; i < keysArr.length; i++) {\n                var key = keysArr[i];\n                this.attrKV(key, keyOrObj[key]);\n            }\n        }\n        this.markRedraw();\n        return this;\n    };\n    Element.prototype.saveCurrentToNormalState = function (toState) {\n        this._innerSaveToNormal(toState);\n        var normalState = this._normalState;\n        for (var i = 0; i < this.animators.length; i++) {\n            var animator = this.animators[i];\n            var fromStateTransition = animator.__fromStateTransition;\n            if (fromStateTransition && fromStateTransition !== exports.PRESERVED_NORMAL_STATE) {\n                continue;\n            }\n            var targetName = animator.targetName;\n            var target = targetName\n                ? normalState[targetName] : normalState;\n            animator.saveFinalToTarget(target);\n        }\n    };\n    Element.prototype._innerSaveToNormal = function (toState) {\n        var normalState = this._normalState;\n        if (!normalState) {\n            normalState = this._normalState = {};\n        }\n        if (toState.textConfig && !normalState.textConfig) {\n            normalState.textConfig = this.textConfig;\n        }\n        this._savePrimaryToNormal(toState, normalState, PRIMARY_STATES_KEYS);\n    };\n    Element.prototype._savePrimaryToNormal = function (toState, normalState, primaryKeys) {\n        for (var i = 0; i < primaryKeys.length; i++) {\n            var key = primaryKeys[i];\n            if (toState[key] != null && !(key in normalState)) {\n                normalState[key] = this[key];\n            }\n        }\n    };\n    Element.prototype.hasState = function () {\n        return this.currentStates.length > 0;\n    };\n    Element.prototype.getState = function (name) {\n        return this.states[name];\n    };\n    Element.prototype.ensureState = function (name) {\n        var states = this.states;\n        if (!states[name]) {\n            states[name] = {};\n        }\n        return states[name];\n    };\n    Element.prototype.clearStates = function (noAnimation) {\n        this.useState(exports.PRESERVED_NORMAL_STATE, false, noAnimation);\n    };\n    Element.prototype.useState = function (stateName, keepCurrentStates, noAnimation) {\n        var toNormalState = stateName === exports.PRESERVED_NORMAL_STATE;\n        var hasStates = this.hasState();\n        if (!hasStates && toNormalState) {\n            return;\n        }\n        var currentStates = this.currentStates;\n        var animationCfg = this.stateTransition;\n        if (util_1.indexOf(currentStates, stateName) >= 0 && (keepCurrentStates || currentStates.length === 1)) {\n            return;\n        }\n        var state;\n        if (this.stateProxy && !toNormalState) {\n            state = this.stateProxy(stateName);\n        }\n        if (!state) {\n            state = (this.states && this.states[stateName]);\n        }\n        if (!state && !toNormalState) {\n            util_1.logError(\"State \" + stateName + \" not exists.\");\n            return;\n        }\n        if (!toNormalState) {\n            this.saveCurrentToNormalState(state);\n        }\n        var useHoverLayer = !!(state && state.hoverLayer);\n        if (useHoverLayer) {\n            this._toggleHoverLayerFlag(true);\n        }\n        this._applyStateObj(stateName, state, this._normalState, keepCurrentStates, !noAnimation && !this.__inHover && animationCfg && animationCfg.duration > 0, animationCfg);\n        if (this._textContent) {\n            this._textContent.useState(stateName, keepCurrentStates);\n        }\n        if (this._textGuide) {\n            this._textGuide.useState(stateName, keepCurrentStates);\n        }\n        if (toNormalState) {\n            this.currentStates = [];\n            this._normalState = {};\n        }\n        else {\n            if (!keepCurrentStates) {\n                this.currentStates = [stateName];\n            }\n            else {\n                this.currentStates.push(stateName);\n            }\n        }\n        this._updateAnimationTargets();\n        this.markRedraw();\n        if (!useHoverLayer && this.__inHover) {\n            this._toggleHoverLayerFlag(false);\n            this.__dirty &= ~Element.REDARAW_BIT;\n        }\n        return state;\n    };\n    Element.prototype.useStates = function (states, noAnimation) {\n        if (!states.length) {\n            this.clearStates();\n        }\n        else {\n            var stateObjects = [];\n            var currentStates = this.currentStates;\n            var len = states.length;\n            var notChange = len === currentStates.length;\n            if (notChange) {\n                for (var i = 0; i < len; i++) {\n                    if (states[i] !== currentStates[i]) {\n                        notChange = false;\n                        break;\n                    }\n                }\n            }\n            if (notChange) {\n                return;\n            }\n            for (var i = 0; i < len; i++) {\n                var stateName = states[i];\n                var stateObj = void 0;\n                if (this.stateProxy) {\n                    stateObj = this.stateProxy(stateName, states);\n                }\n                if (!stateObj) {\n                    stateObj = this.states[stateName];\n                }\n                if (stateObj) {\n                    stateObjects.push(stateObj);\n                }\n            }\n            var useHoverLayer = !!(stateObjects[len - 1] && stateObjects[len - 1].hoverLayer);\n            if (useHoverLayer) {\n                this._toggleHoverLayerFlag(true);\n            }\n            var mergedState = this._mergeStates(stateObjects);\n            var animationCfg = this.stateTransition;\n            this.saveCurrentToNormalState(mergedState);\n            this._applyStateObj(states.join(','), mergedState, this._normalState, false, !noAnimation && !this.__inHover && animationCfg && animationCfg.duration > 0, animationCfg);\n            if (this._textContent) {\n                this._textContent.useStates(states);\n            }\n            if (this._textGuide) {\n                this._textGuide.useStates(states);\n            }\n            this._updateAnimationTargets();\n            this.currentStates = states.slice();\n            this.markRedraw();\n            if (!useHoverLayer && this.__inHover) {\n                this._toggleHoverLayerFlag(false);\n                this.__dirty &= ~Element.REDARAW_BIT;\n            }\n        }\n    };\n    Element.prototype._updateAnimationTargets = function () {\n        for (var i = 0; i < this.animators.length; i++) {\n            var animator = this.animators[i];\n            if (animator.targetName) {\n                animator.changeTarget(this[animator.targetName]);\n            }\n        }\n    };\n    Element.prototype.removeState = function (state) {\n        var idx = util_1.indexOf(this.currentStates, state);\n        if (idx >= 0) {\n            var currentStates = this.currentStates.slice();\n            currentStates.splice(idx, 1);\n            this.useStates(currentStates);\n        }\n    };\n    Element.prototype.replaceState = function (oldState, newState, forceAdd) {\n        var currentStates = this.currentStates.slice();\n        var idx = util_1.indexOf(currentStates, oldState);\n        var newStateExists = util_1.indexOf(currentStates, newState) >= 0;\n        if (idx >= 0) {\n            if (!newStateExists) {\n                currentStates[idx] = newState;\n            }\n            else {\n                currentStates.splice(idx, 1);\n            }\n        }\n        else if (forceAdd && !newStateExists) {\n            currentStates.push(newState);\n        }\n        this.useStates(currentStates);\n    };\n    Element.prototype.toggleState = function (state, enable) {\n        if (enable) {\n            this.useState(state, true);\n        }\n        else {\n            this.removeState(state);\n        }\n    };\n    Element.prototype._mergeStates = function (states) {\n        var mergedState = {};\n        var mergedTextConfig;\n        for (var i = 0; i < states.length; i++) {\n            var state = states[i];\n            util_1.extend(mergedState, state);\n            if (state.textConfig) {\n                mergedTextConfig = mergedTextConfig || {};\n                util_1.extend(mergedTextConfig, state.textConfig);\n            }\n        }\n        if (mergedTextConfig) {\n            mergedState.textConfig = mergedTextConfig;\n        }\n        return mergedState;\n    };\n    Element.prototype._applyStateObj = function (stateName, state, normalState, keepCurrentStates, transition, animationCfg) {\n        var needsRestoreToNormal = !(state && keepCurrentStates);\n        if (state && state.textConfig) {\n            this.textConfig = util_1.extend({}, keepCurrentStates ? this.textConfig : normalState.textConfig);\n            util_1.extend(this.textConfig, state.textConfig);\n        }\n        else if (needsRestoreToNormal) {\n            if (normalState.textConfig) {\n                this.textConfig = normalState.textConfig;\n            }\n        }\n        var transitionTarget = {};\n        var hasTransition = false;\n        for (var i = 0; i < PRIMARY_STATES_KEYS.length; i++) {\n            var key = PRIMARY_STATES_KEYS[i];\n            var propNeedsTransition = transition && DEFAULT_ANIMATABLE_MAP[key];\n            if (state && state[key] != null) {\n                if (propNeedsTransition) {\n                    hasTransition = true;\n                    transitionTarget[key] = state[key];\n                }\n                else {\n                    this[key] = state[key];\n                }\n            }\n            else if (needsRestoreToNormal) {\n                if (normalState[key] != null) {\n                    if (propNeedsTransition) {\n                        hasTransition = true;\n                        transitionTarget[key] = normalState[key];\n                    }\n                    else {\n                        this[key] = normalState[key];\n                    }\n                }\n            }\n        }\n        if (!transition) {\n            for (var i = 0; i < this.animators.length; i++) {\n                var animator = this.animators[i];\n                var targetName = animator.targetName;\n                animator.__changeFinalValue(targetName\n                    ? (state || normalState)[targetName]\n                    : (state || normalState));\n            }\n        }\n        if (hasTransition) {\n            this._transitionState(stateName, transitionTarget, animationCfg);\n        }\n    };\n    Element.prototype._attachComponent = function (componentEl) {\n        if (componentEl.__zr && !componentEl.__hostTarget) {\n            throw new Error('Text element has been added to zrender.');\n        }\n        if (componentEl === this) {\n            throw new Error('Recursive component attachment.');\n        }\n        var zr = this.__zr;\n        if (zr) {\n            componentEl.addSelfToZr(zr);\n        }\n        componentEl.__zr = zr;\n        componentEl.__hostTarget = this;\n    };\n    Element.prototype._detachComponent = function (componentEl) {\n        if (componentEl.__zr) {\n            componentEl.removeSelfFromZr(componentEl.__zr);\n        }\n        componentEl.__zr = null;\n        componentEl.__hostTarget = null;\n    };\n    Element.prototype.getClipPath = function () {\n        return this._clipPath;\n    };\n    Element.prototype.setClipPath = function (clipPath) {\n        if (this._clipPath && this._clipPath !== clipPath) {\n            this.removeClipPath();\n        }\n        this._attachComponent(clipPath);\n        this._clipPath = clipPath;\n        this.markRedraw();\n    };\n    Element.prototype.removeClipPath = function () {\n        var clipPath = this._clipPath;\n        if (clipPath) {\n            this._detachComponent(clipPath);\n            this._clipPath = null;\n            this.markRedraw();\n        }\n    };\n    Element.prototype.getTextContent = function () {\n        return this._textContent;\n    };\n    Element.prototype.setTextContent = function (textEl) {\n        var previousTextContent = this._textContent;\n        if (previousTextContent === textEl) {\n            return;\n        }\n        if (previousTextContent && previousTextContent !== textEl) {\n            this.removeTextContent();\n        }\n        if (textEl.__zr && !textEl.__hostTarget) {\n            throw new Error('Text element has been added to zrender.');\n        }\n        textEl.attachedTransform = new Transformable_1[\"default\"]();\n        this._attachComponent(textEl);\n        this._textContent = textEl;\n        this.markRedraw();\n    };\n    Element.prototype.setTextConfig = function (cfg) {\n        if (!this.textConfig) {\n            this.textConfig = {};\n        }\n        util_1.extend(this.textConfig, cfg);\n        this.markRedraw();\n    };\n    Element.prototype.removeTextContent = function () {\n        var textEl = this._textContent;\n        if (textEl) {\n            textEl.attachedTransform = null;\n            this._detachComponent(textEl);\n            this._textContent = null;\n            this._innerTextDefaultStyle = null;\n            this.markRedraw();\n        }\n    };\n    Element.prototype.getTextGuideLine = function () {\n        return this._textGuide;\n    };\n    Element.prototype.setTextGuideLine = function (guideLine) {\n        if (this._textGuide && this._textGuide !== guideLine) {\n            this.removeTextGuideLine();\n        }\n        this._attachComponent(guideLine);\n        this._textGuide = guideLine;\n        this.markRedraw();\n    };\n    Element.prototype.removeTextGuideLine = function () {\n        var textGuide = this._textGuide;\n        if (textGuide) {\n            this._detachComponent(textGuide);\n            this._textGuide = null;\n            this.markRedraw();\n        }\n    };\n    Element.prototype.markRedraw = function () {\n        this.__dirty |= Element.REDARAW_BIT;\n        var zr = this.__zr;\n        if (zr) {\n            if (this.__inHover) {\n                zr.refreshHover();\n            }\n            else {\n                zr.refresh();\n            }\n        }\n        if (this.__hostTarget) {\n            this.__hostTarget.markRedraw();\n        }\n    };\n    Element.prototype.dirty = function () {\n        this.markRedraw();\n    };\n    Element.prototype._toggleHoverLayerFlag = function (inHover) {\n        this.__inHover = inHover;\n        var textContent = this._textContent;\n        var textGuide = this._textGuide;\n        if (textContent) {\n            textContent.__inHover = inHover;\n        }\n        if (textGuide) {\n            textGuide.__inHover = inHover;\n        }\n    };\n    Element.prototype.addSelfToZr = function (zr) {\n        this.__zr = zr;\n        var animators = this.animators;\n        if (animators) {\n            for (var i = 0; i < animators.length; i++) {\n                zr.animation.addAnimator(animators[i]);\n            }\n        }\n        if (this._clipPath) {\n            this._clipPath.addSelfToZr(zr);\n        }\n        if (this._textContent) {\n            this._textContent.addSelfToZr(zr);\n        }\n        if (this._textGuide) {\n            this._textGuide.addSelfToZr(zr);\n        }\n    };\n    Element.prototype.removeSelfFromZr = function (zr) {\n        this.__zr = null;\n        var animators = this.animators;\n        if (animators) {\n            for (var i = 0; i < animators.length; i++) {\n                zr.animation.removeAnimator(animators[i]);\n            }\n        }\n        if (this._clipPath) {\n            this._clipPath.removeSelfFromZr(zr);\n        }\n        if (this._textContent) {\n            this._textContent.removeSelfFromZr(zr);\n        }\n        if (this._textGuide) {\n            this._textGuide.removeSelfFromZr(zr);\n        }\n    };\n    Element.prototype.animate = function (key, loop) {\n        var target = key ? this[key] : this;\n        if (!target) {\n            util_1.logError('Property \"'\n                + key\n                + '\" is not existed in element '\n                + this.id);\n            return;\n        }\n        var animator = new Animator_1[\"default\"](target, loop);\n        this.addAnimator(animator, key);\n        return animator;\n    };\n    Element.prototype.addAnimator = function (animator, key) {\n        var zr = this.__zr;\n        var el = this;\n        animator.during(function () {\n            el.updateDuringAnimation(key);\n        }).done(function () {\n            var animators = el.animators;\n            var idx = util_1.indexOf(animators, animator);\n            if (idx >= 0) {\n                animators.splice(idx, 1);\n            }\n        });\n        this.animators.push(animator);\n        if (zr) {\n            zr.animation.addAnimator(animator);\n        }\n        zr && zr.wakeUp();\n    };\n    Element.prototype.updateDuringAnimation = function (key) {\n        this.markRedraw();\n    };\n    Element.prototype.stopAnimation = function (scope, forwardToLast) {\n        var animators = this.animators;\n        var len = animators.length;\n        var leftAnimators = [];\n        for (var i = 0; i < len; i++) {\n            var animator = animators[i];\n            if (!scope || scope === animator.scope) {\n                animator.stop(forwardToLast);\n            }\n            else {\n                leftAnimators.push(animator);\n            }\n        }\n        this.animators = leftAnimators;\n        return this;\n    };\n    Element.prototype.animateTo = function (target, cfg, animationProps) {\n        animateTo(this, target, cfg, animationProps);\n    };\n    Element.prototype.animateFrom = function (target, cfg, animationProps) {\n        animateTo(this, target, cfg, animationProps, true);\n    };\n    Element.prototype._transitionState = function (stateName, target, cfg, animationProps) {\n        var animators = animateTo(this, target, cfg, animationProps);\n        for (var i = 0; i < animators.length; i++) {\n            animators[i].__fromStateTransition = stateName;\n        }\n    };\n    Element.prototype.getBoundingRect = function () {\n        return null;\n    };\n    Element.prototype.getPaintRect = function () {\n        return null;\n    };\n    Element.REDARAW_BIT = 1;\n    Element.initDefaultProps = (function () {\n        var elProto = Element.prototype;\n        elProto.type = 'element';\n        elProto.name = '';\n        elProto.ignore = false;\n        elProto.silent = false;\n        elProto.isGroup = false;\n        elProto.draggable = false;\n        elProto.dragging = false;\n        elProto.ignoreClip = false;\n        elProto.__inHover = false;\n        elProto.__dirty = Element.REDARAW_BIT;\n        var logs = {};\n        function logDeprecatedError(key, xKey, yKey) {\n            if (!logs[key + xKey + yKey]) {\n                console.warn(\"DEPRECATED: '\" + key + \"' has been deprecated. use '\" + xKey + \"', '\" + yKey + \"' instead\");\n                logs[key + xKey + yKey] = true;\n            }\n        }\n        function createLegacyProperty(key, privateKey, xKey, yKey) {\n            Object.defineProperty(elProto, key, {\n                get: function () {\n                    logDeprecatedError(key, xKey, yKey);\n                    if (!this[privateKey]) {\n                        var pos = this[privateKey] = [];\n                        enhanceArray(this, pos);\n                    }\n                    return this[privateKey];\n                },\n                set: function (pos) {\n                    logDeprecatedError(key, xKey, yKey);\n                    this[xKey] = pos[0];\n                    this[yKey] = pos[1];\n                    this[privateKey] = pos;\n                    enhanceArray(this, pos);\n                }\n            });\n            function enhanceArray(self, pos) {\n                Object.defineProperty(pos, 0, {\n                    get: function () {\n                        return self[xKey];\n                    },\n                    set: function (val) {\n                        self[xKey] = val;\n                    }\n                });\n                Object.defineProperty(pos, 1, {\n                    get: function () {\n                        return self[yKey];\n                    },\n                    set: function (val) {\n                        self[yKey] = val;\n                    }\n                });\n            }\n        }\n        if (Object.defineProperty && (!env_1[\"default\"].browser.ie || env_1[\"default\"].browser.version > 8)) {\n            createLegacyProperty('position', '_legacyPos', 'x', 'y');\n            createLegacyProperty('scale', '_legacyScale', 'scaleX', 'scaleY');\n            createLegacyProperty('origin', '_legacyOrigin', 'originX', 'originY');\n        }\n    })();\n    return Element;\n}());\nutil_1.mixin(Element, Eventful_1[\"default\"]);\nutil_1.mixin(Element, Transformable_1[\"default\"]);\nfunction animateTo(animatable, target, cfg, animationProps, reverse) {\n    cfg = cfg || {};\n    var animators = [];\n    animateToShallow(animatable, '', animatable, target, cfg, animationProps, animators, reverse);\n    var finishCount = animators.length;\n    var doneHappened = false;\n    var cfgDone = cfg.done;\n    var cfgAborted = cfg.aborted;\n    var doneCb = function () {\n        doneHappened = true;\n        finishCount--;\n        if (finishCount <= 0) {\n            doneHappened\n                ? (cfgDone && cfgDone())\n                : (cfgAborted && cfgAborted());\n        }\n    };\n    var abortedCb = function () {\n        finishCount--;\n        if (finishCount <= 0) {\n            doneHappened\n                ? (cfgDone && cfgDone())\n                : (cfgAborted && cfgAborted());\n        }\n    };\n    if (!finishCount) {\n        cfgDone && cfgDone();\n    }\n    if (animators.length > 0 && cfg.during) {\n        animators[0].during(function (target, percent) {\n            cfg.during(percent);\n        });\n    }\n    for (var i = 0; i < animators.length; i++) {\n        var animator = animators[i];\n        if (doneCb) {\n            animator.done(doneCb);\n        }\n        if (abortedCb) {\n            animator.aborted(abortedCb);\n        }\n        animator.start(cfg.easing, cfg.force);\n    }\n    return animators;\n}\nfunction copyArrShallow(source, target, len) {\n    for (var i = 0; i < len; i++) {\n        source[i] = target[i];\n    }\n}\nfunction is2DArray(value) {\n    return util_1.isArrayLike(value[0]);\n}\nfunction copyValue(target, source, key) {\n    if (util_1.isArrayLike(source[key])) {\n        if (!util_1.isArrayLike(target[key])) {\n            target[key] = [];\n        }\n        if (util_1.isTypedArray(source[key])) {\n            var len = source[key].length;\n            if (target[key].length !== len) {\n                target[key] = new (source[key].constructor)(len);\n                copyArrShallow(target[key], source[key], len);\n            }\n        }\n        else {\n            var sourceArr = source[key];\n            var targetArr = target[key];\n            var len0 = sourceArr.length;\n            if (is2DArray(sourceArr)) {\n                var len1 = sourceArr[0].length;\n                for (var i = 0; i < len0; i++) {\n                    if (!targetArr[i]) {\n                        targetArr[i] = Array.prototype.slice.call(sourceArr[i]);\n                    }\n                    else {\n                        copyArrShallow(targetArr[i], sourceArr[i], len1);\n                    }\n                }\n            }\n            else {\n                copyArrShallow(targetArr, sourceArr, len0);\n            }\n            targetArr.length = sourceArr.length;\n        }\n    }\n    else {\n        target[key] = source[key];\n    }\n}\nfunction animateToShallow(animatable, topKey, source, target, cfg, animationProps, animators, reverse) {\n    var animatableKeys = [];\n    var changedKeys = [];\n    var targetKeys = util_1.keys(target);\n    var duration = cfg.duration;\n    var delay = cfg.delay;\n    var additive = cfg.additive;\n    var setToFinal = cfg.setToFinal;\n    var animateAll = !util_1.isObject(animationProps);\n    for (var k = 0; k < targetKeys.length; k++) {\n        var innerKey = targetKeys[k];\n        if (source[innerKey] != null\n            && target[innerKey] != null\n            && (animateAll || animationProps[innerKey])) {\n            if (util_1.isObject(target[innerKey]) && !util_1.isArrayLike(target[innerKey])) {\n                if (topKey) {\n                    if (!reverse) {\n                        source[innerKey] = target[innerKey];\n                        animatable.updateDuringAnimation(topKey);\n                    }\n                    continue;\n                }\n                animateToShallow(animatable, innerKey, source[innerKey], target[innerKey], cfg, animationProps && animationProps[innerKey], animators, reverse);\n            }\n            else {\n                animatableKeys.push(innerKey);\n                changedKeys.push(innerKey);\n            }\n        }\n        else if (!reverse) {\n            source[innerKey] = target[innerKey];\n            animatable.updateDuringAnimation(topKey);\n            changedKeys.push(innerKey);\n        }\n    }\n    var keyLen = animatableKeys.length;\n    if (keyLen > 0\n        || (cfg.force && !animators.length)) {\n        var existsAnimators = animatable.animators;\n        var existsAnimatorsOnSameTarget = [];\n        for (var i = 0; i < existsAnimators.length; i++) {\n            if (existsAnimators[i].targetName === topKey) {\n                existsAnimatorsOnSameTarget.push(existsAnimators[i]);\n            }\n        }\n        if (!additive && existsAnimatorsOnSameTarget.length) {\n            for (var i = 0; i < existsAnimatorsOnSameTarget.length; i++) {\n                var allAborted = existsAnimatorsOnSameTarget[i].stopTracks(changedKeys);\n                if (allAborted) {\n                    var idx = util_1.indexOf(existsAnimators, existsAnimatorsOnSameTarget[i]);\n                    existsAnimators.splice(idx, 1);\n                }\n            }\n        }\n        var revertedSource = void 0;\n        var reversedTarget = void 0;\n        var sourceClone = void 0;\n        if (reverse) {\n            reversedTarget = {};\n            if (setToFinal) {\n                revertedSource = {};\n            }\n            for (var i = 0; i < keyLen; i++) {\n                var innerKey = animatableKeys[i];\n                reversedTarget[innerKey] = source[innerKey];\n                if (setToFinal) {\n                    revertedSource[innerKey] = target[innerKey];\n                }\n                else {\n                    source[innerKey] = target[innerKey];\n                }\n            }\n        }\n        else if (setToFinal) {\n            sourceClone = {};\n            for (var i = 0; i < keyLen; i++) {\n                var innerKey = animatableKeys[i];\n                sourceClone[innerKey] = Animator_1.cloneValue(source[innerKey]);\n                copyValue(source, target, innerKey);\n            }\n        }\n        var animator = new Animator_1[\"default\"](source, false, additive ? existsAnimatorsOnSameTarget : null);\n        animator.targetName = topKey;\n        if (cfg.scope) {\n            animator.scope = cfg.scope;\n        }\n        if (setToFinal && revertedSource) {\n            animator.whenWithKeys(0, revertedSource, animatableKeys);\n        }\n        if (sourceClone) {\n            animator.whenWithKeys(0, sourceClone, animatableKeys);\n        }\n        animator.whenWithKeys(duration == null ? 500 : duration, reverse ? reversedTarget : target, animatableKeys).delay(delay || 0);\n        animatable.addAnimator(animator, topKey);\n        animators.push(animator);\n    }\n}\nexports[\"default\"] = Element;\n"]},"metadata":{},"sourceType":"script"}