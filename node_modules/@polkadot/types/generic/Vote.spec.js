"use strict";

var _create = require("../create");

var _ = require(".");

// Copyright 2017-2020 @polkadot/types authors & contributors
// SPDX-License-Identifier: Apache-2.0
describe('GenericVote', () => {
  const registry = new _create.TypeRegistry();
  describe('construction', () => {
    it('constructs via boolean true', () => {
      expect(new _.GenericVote(registry, true).toU8a()).toEqual(new Uint8Array([128]));
      expect(new _.GenericVote(registry, true).isAye).toBe(true);
      expect(new _.GenericVote(registry, true).isNay).toBe(false);
    });
    it('constructs via boolean false', () => {
      expect(new _.GenericVote(registry, false).toU8a()).toEqual(new Uint8Array([0]));
      expect(new _.GenericVote(registry, false).isNay).toBe(true);
      expect(new _.GenericVote(registry, false).isAye).toBe(false);
    });
    it('constructs via undefined', () => {
      expect(new _.GenericVote(registry).isNay).toBe(true);
    });
    it('has isYay for positive', () => {
      // eslint-disable-next-line no-new-wrappers
      expect(new _.GenericVote(registry, true).isAye).toBe(true);
    });
    it('has isNay for negative', () => {
      // eslint-disable-next-line no-new-wrappers
      expect(new _.GenericVote(registry, false).isNay).toBe(true);
    });
    it('is Aye for negative numbers', () => {
      expect(new _.GenericVote(registry, -128).isAye).toBe(true);
    });
    it('is Nay for positive numbers', () => {
      expect(new _.GenericVote(registry, 127).isNay).toBe(true);
    });
    it('is Nay for 0', () => {
      expect(new _.GenericVote(registry, 0).isNay).toBe(true);
    });
    it('constructs via empty', () => {
      expect(new _.GenericVote(registry).isNay).toBe(true);
    });
    it('constructs via Uint8Array (empty)', () => {
      expect(new _.GenericVote(registry, new Uint8Array()).isNay).toBe(true);
    });
    it('constructs via Uint8Array (nay)', () => {
      expect(new _.GenericVote(registry, new Uint8Array([1])).isNay).toBe(true);
    });
    it('constructs via Uint8Array (aye)', () => {
      const test = new _.GenericVote(registry, new Uint8Array([0b10000010]));
      expect(test.isNay).toBe(false);
      expect(test.conviction.toString()).toEqual('Locked2x');
    });
  });
  describe('Vote with conviction', () => {
    it('constructs Vote with raw boolean', () => {
      expect(new _.GenericVote(registry, {
        aye: true,
        conviction: 'Locked1x'
      }).toU8a()).toEqual(new Uint8Array([0b10000001]));
    });
    it('constructs with Vote aye is false, conviction is None', () => {
      expect(new _.GenericVote(registry, {
        aye: false,
        conviction: 'None'
      }).toU8a()).toEqual(new Uint8Array([0b00000000]));
    });
    it('constructs with Vote aye is true, conviction is Locked4x', () => {
      expect(new _.GenericVote(registry, {
        aye: true,
        conviction: 'Locked4x'
      }).toU8a()).toEqual(new Uint8Array([0b10000100]));
    });
  });
  describe('getters', () => {
    it('Conviction getter works', () => {
      expect(new _.GenericVote(registry, {
        aye: true,
        conviction: 'Locked2x'
      }).conviction.toString()).toEqual('Locked2x');
    });
    it('Conviction getter works with raw boolean and string conviction', () => {
      expect(new _.GenericVote(registry, {
        aye: true,
        conviction: 'Locked2x'
      }).conviction.toString()).toEqual('Locked2x');
    });
    it('Conviction getter works with raw boolean and conviction index', () => {
      expect(new _.GenericVote(registry, {
        aye: true,
        conviction: 2
      }).conviction.toString()).toEqual('Locked2x');
    });
    it('Conviction getter works with raw boolean and no conviction', () => {
      const test = new _.GenericVote(registry, {
        aye: true
      });
      expect(test.isAye).toEqual(true);
      expect(test.conviction.toString()).toEqual('None');
    });
    it('isAye getter works', () => {
      expect(new _.GenericVote(registry, {
        aye: true,
        conviction: 'None'
      }).isAye).toEqual(true);
    });
    it('isNay getter works', () => {
      expect(new _.GenericVote(registry, {
        aye: true,
        conviction: 'None'
      }).isNay).toEqual(false);
    });
  });
  describe('utils', () => {
    it('has a sane toRawType', () => {
      expect(new _.GenericVote(registry).toRawType()).toEqual('Vote');
    });
  });
});